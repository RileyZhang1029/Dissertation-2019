BIOINFORMATICS

Vol. 29 ISMB/ECCB 2013, pages i300â€“i307
doi:10.1093/bioinformatics/btt226

The RNA Newton polytope and learnability of energy parameters
Elmirasadat Forouzmand and Hamidreza Chitsaz*
Department of Computer Science, Wayne State University, Detroit, MI 48202, USA

ABSTRACT
Motivation: Computational RNA structure prediction is a mature im-
portant problem that has received a new wave of attention with the
discovery of regulatory non-coding RNAs and the advent of high-
throughput
transcriptome sequencing. Despite nearly two score
years of research on RNA secondary structure and RNAâ€“RNA inter-
action prediction, the accuracy of the state-of-the-art algorithms are
still far from satisfactory. So far, researchers have proposed increas-
ingly complex energy models and improved parameter estimation
methods, experimental and/or computational,
in anticipation of
endowing their methods with enough power to solve the problem.
The output has disappointingly been only modest improvements, not
matching the expectations. Even recent massively featured machine
learning approaches were not able to break the barrier. Why is that?
Approach: The first step toward high-accuracy structure prediction is
to pick an energy model that is inherently capable of predicting each
and every one of known structures to date. In this article, we introduce
the notion of learnability of the parameters of an energy model as a
measure of such an inherent capability. We say that the parameters of
an energy model are learnable iff there exists at least one set of such
parameters that renders every known RNA structure to date the min-
imum free energy structure. We derive a necessary condition for the
learnability and give a dynamic programming algorithm to assess it.
Our algorithm computes the convex hull of the feature vectors of all
feasible structures in the ensemble of a given input sequence.
Interestingly, that convex hull coincides with the Newton polytope of
the partition function as a polynomial in energy parameters. To the
best of our knowledge, this is the first approach toward computing the
RNA Newton polytope and a systematic assessment of the inherent
capabilities of an energy model. The worst case complexity of our
algorithm is exponential in the number of features. However, dimen-
sionality reduction techniques can provide approximate solutions to
avoid the curse of dimensionality.
Results: We demonstrated the application of our theory to a simple
energy model consisting of a weighted count of A-U, C-G and G-U
base pairs. Our results show that this simple energy model satisfies
the necessary condition for more than half of the input unpseudo-
knotted sequenceâ€“structure pairs (55%) chosen from the RNA
STRAND v2.0 database and severely violates the condition for
13%, which provide a set of hard cases that require further investi-
gation. From 1350 RNA strands, the observed 3D feature vector for
749 strands is on the surface of the computed polytope. For 289 RNA
strands, the observed feature vector is not on the boundary of the
polytope but its distance from the boundary is not more than one.
A distance of one essentially means one base pair difference between
the observed structure and the closest point on the boundary of the
polytope, which need not be the feature vector of a structure. For

*To whom correspondence should be addressed.

171 sequences, this distance is larger than two, and for only 11
sequences, this distance is larger than five.
Availability: The source code is available on http://compbio.cs.wayne.
edu/software/rna-newton-polytope.
Contact: chitsaz@wayne.edu

1 INTRODUCTION

Computational RNA structure and RNAâ€“RNA interaction
prediction have always been important problems, particularly
now that RNA has been shown to have key regulatory roles in
the cell (Bartel, 2004; Brantl, 2002; Gottesman, 2005; Hannon,
2002; Storz, 2002; Wagner and Flardh, 2002; Zamore and Haley,
2005). Furthermore, with the advent of synthetic biology at the
whole organism level (Gibson et al., 2010), high-throughput
accurate RNA engineering algorithms are required for both
in vivo and in vitro applications (Seeman, 2005; Seeman and
Lukeman, 2005; Simmel and Dittmer, 2005; Venkataraman
et al., 2007; Yin et al., 2008). Since the dawn of RNA secondary
structure prediction nearly two score years ago (Tinoco et al.,
1973),
the research community has proposed increasingly
complex models and algorithms, hoping that refined features
together with better methods to estimate their parameters
would solve the problem. Early approaches considered mere
base pair counting, followed by the Turner thermodynamics
model, which was a significant leap forward. Recently, massively
feature-rich models empowered by parameter estimation algo-
rithms have been proposed, but they provide only modest
improvements.

Despite significant progress in the last three decades, made
possible by the work of Mathews et al. (1999) on measuring
RNA thermodynamic energy parameters and the work of several
groups on novel algorithms (Bernhart et al., 2006; Chitsaz et al.,
2009a, b; Dirks and Pierce, 2003; McCaskill, 1990; Nussinov
et al., 1978; Rivas and Eddy, 1999; Waterman and Smith,
1978; Zuker and Stiegler, 1981) and machine
learning
approaches (Andronescu et al., 2010; Do et al., 2006; Zakov
et al., 2011), the RNA structure prediction accuracy has not
reached a satisfactory level yet (Rivas et al., 2012). Why is it
so? Up to now, human intuition and computational convenience
have led the way. We believe that human intuition has to be
equipped with systematic methods to assess the suitability of a
given energy model. Surprisingly, there is not a single method to
assess whether the parameters of an energy model are learnable.
We say that the parameters of an energy model are learnable iff
there exists at least one set of such parameters that renders every
known RNA structure to date, determined through radiograph
or NMR, the minimum free energy structure. Equivalently, we
say that the parameters of an energy model are learnable iff
100% structure prediction accuracy can be achieved when
the training and test sets are identical. The first step toward
high-accuracy structure prediction is to make sure that the

ÃŸ The Author 2013. Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial
re-use, please contact journals.permissions@oup.com

energy model is inherently capable, i.e. its parameters are learn-
able. In this work, we provide a necessary condition for the
learnability and an algorithm to verify it. The problem of learn-
ability was previously studied for sequence alignment using simi-
lar methods (Dewey et al., 2006). To the best of our knowledge,
this is the first approach toward a systematic assessment of the
suitability of an energy model for RNA structure prediction.
Note that a successful RNA folding algorithm needs to have
the generalization power to predict unseen structures as well.
However, if an energy model is inherently incapable of predicting
known structures correctly, then it does not matter if it has the
generalization power. We leave analysis of the generalization
power for future work.

2 BACKGROUND

2.1 RNA secondary structure models

An RNA secondary structure model is often a context-free gram-
mar together with a scoring function for either the rules, in the
case of stochastic context-free grammars (SCFGs) (Eddy and
Durbin, 1994), or the alphabet, in the case of thermodynamics
models (Mathews et al., 1999). Such scoring functions induce
scoring on the entire generated language. The word with optimal
score then yields a predicted structure for the given sequence.
For the sake of brevity, we focus on thermodynamics models
in this article, but it is obvious that our methods apply to
other models including SCFG as well. In our context, the scoring
function is the thermodynamics free energy. A secondary struc-
ture y of a nucleic acid is decomposed into loops, a free energy
is associated with every loop in y and the total free energy G for y
is the sum of loop free energies (Mathews et al., 1999). The same
loop decomposition principle applies to interacting nucleic acids
such that the total free energy G is still the sum of the free
energies of loops and interaction components (Chitsaz et al.,
2009b).

2.2 Estimation of energy parameters

Generally, RNA structure prediction algorithms are divided into
probabilistic and non-probabilistic categories. Besides machine
learning approaches for the probabilistic methods, e.g. SCFGs,
which are evaluated in (Rivas et al., 2012), existing machine
learning algorithms for parameter estimation in the non-prob-
abilistic RNA structure prediction can be grouped into two
categories:

 Likelihood-based methods, where the maximum likelihood
or maximum conditional
likelihood principle is used to
estimate the parameters of the model (e.g. Do et al., 2006);
and

 Large-margin methods, where the model parameters are
estimated to maximize the margin between the score of the
true structure and the second best structure. This has been
done using an online passive-aggressive training algorithm
(Zakov et al., 2011) and Iterative Constraint Generation
(Andronescu et al., 2007).

The likelihood-based techniques estimate the best Gibbs distri-
bution, which not only assists in predicting the best secondary

RNA Newton polytope

structure but also is used in determining the thermodynamic
parameters. Besides some probabilistic methods (Rivas et al.,
2012), one of the most successful methods for learning the
thermodynamics of RNA has been the MCL method, as in
CONTRAfold (Do et al., 2006), which maximizes the probability
of RNA structures y given RNA sequences x for the training set
D. That is, the conditional log likelihood of the training data
(using the Boltzmann distribution) is maximized to estimate the
best model parameters h 2 Rk:

X


h

:Â¼ arg max

LÃ°D; hÃž Â¼ max

logpÃ°yjx, hÃž

h

h

Ã°x, yÃž2D
pÃ°yjx, hÃž :Â¼ e GÃ°x, y, hÃž=RT
QÃ°x, hÃž

Ã°1Ãž

Ã°2Ãž

where k denotes the number of different motifs defined in the
energy model, R is the gas constant, T is the absolute tempera-
ture, GÃ°x, y, hÃž is the free energy and

X

QÃ°x, hÃž :Â¼

e GÃ°x, s, hÃž=RT

s2EÃ°xÃž

Ã°3Ãž

is the partition function (Chitsaz et al., 2009b; Dirks and Pierce,
2003; McCaskill, 1990) with EÃ°xÃž being the ensemble of possible
structures of x. The free energy

Ã°4Ãž
is a linear function of the parameters h where cÃ°x, sÃž 2 Zk is the
features vector.


GÃ°x, s, hÃž :Â¼ cÃ°x, sÃž, h




The best performing method for RNA STRAND v2.0 is
Contextfold (Zakov et al., 2011). However, Contextfold per-
forms worse than other methods in other datasets that are struc-
turally different from RNA STRAND v2.0 (Rivas et al., 2012).
Essentially, it seems that Contextfold suffers from overfitting
because it uses a myriad of features in its model. A systematic
evaluation of the learnability using our algorithm in this article
may help design a more concise set of features that is powerful
enough to achieve high accuracy but not too powerful to suffer
from overfitting.

The question that we ask before parameter estimation is â€˜does

3 LEARNABILITY
there ever exist parameters hy such that for every Ã°x, yÃž 2 D,
y Â¼ arg mins GÃ°x, s, hyÃž?â€™ If the answer to this question is no,

then there is no hope that one can ever achieve 100% accuracy
using the given model. The answer reveals inherent limitations
of the model, which can be used to design improved models.

We provide a necessary condition for the existence of hy and

a dynamic programming algorithm to verify it through comput-
ing the Newton polytope for every x in D. We will define the
RNA Newton polytope below. Not only our algorithm provides
a binary answer, it also quantifies the distance from the bound-
ary. For our 3D model, this distance roughly captures the dif-
ference between the number of base pairs in the observed
structure and the number of base pairs in the closest point on
the boundary of the polytope. Note that the closest point on the
boundary of the polytope need not be the feature vector of a
structure.

i301

E.Forouzmand and H.Chitsaz

4 METHODS

4.1 Necessary condition for learnability
Let Ã°x, yÃž 2 D and hy 2 Rk. Assume y minimizes GÃ°x, s, hyÃž as a function

of s. In that case

E
Replacing equation (4) above,

GÃ°x, y, hyÃž  GÃ°x, s, hyÃž, 8 s 2 EÃ°xÃž:
D
E
D
 cÃ°x, sÃž, hy
cÃ°x, yÃž, hy
, 8 s 2 EÃ°xÃž
E
0  cÃ°x, sÃž   cÃ°x, yÃž, hy
, 8 s 2 EÃ°xÃž:

D

Define the feature ensemble of sequence x by
FÃ°xÃž :Â¼ cÃ°x, sÃž j s 2 EÃ°xÃž



	

In that case, equation (7) implies that

D

0  FÃ°xÃž   cÃ°x, yÃž, hy

 Zk:
E
:

We call the convex hull of FÃ°xÃž the Newton polytope of x,

	
NÃ°xÃž :Â¼ conv FÃ°xÃž



 Rk:

Ã°5Ãž

Ã°6Ãž
Ã°7Ãž

Ã°8Ãž

Ã°9Ãž

Ã°10Ãž

We remind the reader that the convex hull of a set, denoted by â€˜convâ€™
hereby, is the minimal convex set that fully contains the set. The reason
for naming this polytope the Newton polytope will be made clear below.
Inequality equation (9) implies that cÃ°x, yÃž 2 @NÃ°xÃž is on the boundary of
the convex hull of the feature ensemble of x with a support hyperplane
normal to hy. Therefore, we have the following theorem.

THEOREM 1. Let

Ã°x, yÃž 2 D and 0 6Â¼ hy 2 Rk. Assume y minim-
izes GÃ°x, s, hyÃž as a function of s. In that case, cÃ°x, yÃž 2 @NÃ°xÃž, i.e. the fea-
ture vector of Ã°x, yÃž is on the boundary of the Newton polytope of x.

PROOF. To the contrary, suppose cÃ°x, yÃž is in the interior of NÃ°xÃž.
Therefore, there is an open ball of radius 40 centered at cÃ°x, yÃž com-
pletely contained in NÃ°xÃž, i.e.

BÃ°cÃ°x, yÃžÃž  NÃ°xÃž:

Ã°11Ãž

Let

p Â¼ cÃ°x, yÃž   Ã°=2Ãž hy
jjhyjj :

is clear that p 2 BÃ°cÃ°x, yÃžÃž  NÃ°xÃž since jjp   cÃ°x, yÃžjj Â¼ =25.
It
Therefore, p can be written as a convex linear combination of the feature
vectors in FÃ°xÃž Â¼ fv1, . . . , vNg, i.e.

9 1, . . . N  0 : 1v1 Ã¾  Ã¾ NvN Â¼ p

1 Ã¾  Ã¾ N Â¼ 1:

Note that

D
p   cÃ°x, yÃž, hy

E

Â¼  Ã°=2Ãžjjhyjj50:
E
D
Therefore, there is 1  i  N, such that vi   cÃ°x, yÃž, hy
50 for otherwise,
E
D
i vi   cÃ°x, yÃž, hy

Ã°14Ãž

Ã°15Ãž

 0

X

Â¼

E

N

D
p   cÃ°x, yÃž, hy
D

iÂ¼1

E

to note that vi 2 FÃ°xÃž and vi   cÃ°x, yÃž, hy

which would be a contradiction with equation (14). It is now sufficient
50, which is a contradiction
Å“

with equation (9).

COROLLARY 1. (Necessary Condition for

the Learnability). For
Ã°x, yÃž 2 D, a necessary but not sufficient condition for the existence of
hy such that y minimizes GÃ°x, s, hyÃž as a function of s is that cÃ°x, yÃž lies on
the boundary of NÃ°xÃž the Newton polytope of x.

i302

Ã°12Ãž
Ã°13Ãž

Ã°16Ãž

Ã°17Ãž

Ã°18Ãž

Ã°19Ãž

the

4.2 Relation to the Newton polytope
In addition to D, the set of experimentally determined structures, we
often have a repository of thermodynamic measurements, e.g. melting
curves, which can help better estimate
energy parameters.
Currently, optical melting measurements are analyzed using a two-state
model (Siegfried and Bevilacqua, 2009). However, a more accurate ana-
lysis of such melting experiments can be done through relating the meas-
urements to the energy parameters through equations involving the
partition function and its derivatives with respect
to temperature
(Chitsaz et al., 2009b). We show that with a change of variables, the
partition function becomes a polynomial. Therefore, such equations
become a system of polynomial equations the solving of which algebra-
ically requires computation of the Newton polytope of each polynomial
(Emiris, 1994; Emiris and Canny, 1995). Recall the partition function
defined in equation (3) and energy in equation (4), and conclude

X

QÃ°x, hÃž Â¼

e

s2EÃ°xÃž

h
  cÃ°x, sÃž, h

i=RT:

Let cÃ°x, sÃž Â¼ Ã°c1Ã°x, sÃž, . . . , ckÃ°x, sÃžÃž and h Â¼ Ã°h1, . . . , hkÃž. Define new
variables

Zi :Â¼ e hi=RT, 1  i  k

and replace them in equation (16). We obtain the partition function

X

QÃ°x, ZÃž Â¼

ZcÃ°x, sÃž

s2EÃ°xÃž

in the form of a polynomial in RÂ½ZÂŠ where

ZcÃ°x, sÃž

:Â¼

ZciÃ°x, sÃž

i

Y

k

iÂ¼1

is a monomial as 0  ciÃ°x, sÃž 2 Z. The Newton polytope of Q is defined
to be the convex hull of the monomials power vectors, i.e.

	
Newton QÃ°x, ZÃž

	
:Â¼ conv cÃ°x, sÃž j s 2 EÃ°xÃž
That is why we call NÃ°xÃž the Newton polytope of x.

Â¼ NÃ°xÃž:

Ã°20Ãž





 



4.3 RNA Newton polytope algorithm
We give a dynamic programming algorithm to compute the Newton
polytope for a given nucleic acid sequence x. Denote the length of x by
L and the ith nucleotide in x by ni. Denote the subsequence of x from the
ith to the jth nucleotide, inclusive of ends, by ni  nj. The following lemma
allows us to formulate a divide-and-conquer strategy for computing the
Newton polytope, which will in turn lead to our dynamic programming
algorithm.

LEMMA 1. Let f and g be two polynomials in RÂ½ZÂŠ. The Newton
polytope of the product of f and g is the Minkowski sum of individual
Newton polytopes, and the Newton polytope of the sum of f and g is the
convex hull of the union of individual Newton polytopes, i.e.

Ã°

	



Ãž [ Newton gÃ° Ãž

Newton fgÃ°
Newton f Ã¾ g

Ãž Â¼ Newton fÃ° Ãž  Newton gÃ° Ãž
Ãž Â¼ conv Newton fÃ°

Ã°21Ãž
Ã°22Ãž
in which  represents the Minkowski sum of two polytopes (Emiris, 1994).
This lemma allows us to use the same divide-and-conquer strategy that
was used for calculating the partition function (Chitsaz et al., 2009b;
Dirks and Pierce, 2003; McCaskill, 1990). We can use the same recursions
(grammar) as in the partition function algorithm but with the Minkowski
sum  instead of multiplication, convex hull of union instead of summa-
tion and the corresponding feature vector c instead of e hc, hi=RT.
Furthermore, because union is invariant with respect to repetition of
points, the dynamic programming is allowed to be redundant, or equiva-
lently the grammar is allowed to be ambiguous. Hence, any complete

RNA structure or RNAâ€“RNA interaction prediction dynamic program-
ming algorithm can be transformed into a Newton polytope algorithm by
replacing the energy with the corresponding feature vector, summation
with the Minkowski sum  and minimization with the convex hull of
union.

As explained above, we transform any complete partition function or
structure prediction dynamic programming algorithm, for single RNA,
RNAâ€“RNA interaction or multiple interacting RNAs, into a Newton
polytope algorithm. For the sake of illustration, we explicitly spell
below only the case of single RNA with separate A-U, C-G and G-U
base pair counting energy model. All the other cases are trivially obtained
following the transformations above.

In this case, the feature vector

cÃ°x, sÃž Â¼ Ã°c1Ã°x, sÃž, c2Ã°x, sÃž, c3Ã°x, sÃžÃž

is 3D: c1Ã°x, sÃž is the number of A-U, c2Ã°x, sÃž the number of C-G and
c3Ã°x, sÃž the number of G-U base pairs in s. Our dynamic programming
algorithm starts by computing the Newton polytope for all unit length
subsequences, followed by all length two subsequences , . . . , up to the
Newton polytope for the entire sequence x. We denote the Newton poly-
tope of the subsequence ni  nj by NÃ°i, jÃž, i.e.
NÃ°i, jÃž :Â¼ NÃ°ni  njÃž

Ã°23Ãž

The following dynamic programming will yield the result

NÃ°i, jÃž Â¼

2
6664

8>>><
>>>:

conv [


	
NÃ°i, â€˜Ãž  NÃ°â€˜ Ã¾ 1, jÃž, i  â€˜  j   1

	
Ã°1, 0, 0Ãž
	

Ã°0, 1, 0Ãž
Ã°0, 0, 1Ãž

 NÃ°i Ã¾ 1, j   1Ãž
 NÃ°i Ã¾ 1, j   1Ãž
 NÃ°i Ã¾ 1, j   1Ãž

if ninj Â¼ AUjUA
if ninj Â¼ CGjGC
if ninj Â¼ GUjUG



	

3
7775

Ã°24Ãž

with the base case NÃ°i, iÃž Â¼ Ã°0, 0, 0Ãž
. To compare with only (AU, CG)
base pair counting, we also compute the 2D Newton polygon by just
projecting the 3D polytope onto the first two coordinates.

There are two different approaches for polytope representation: (i)
vertex representation, which is a set of points, and (ii) half plane repre-
sentation, which is a set of linear inequalities. The former is often called
V-representation and the latter H-representation. Although they are
equivalent, and there are algorithms to transform one into the other,
computing Minkowski sum is more convenient with the V-representation,
and convex hull of union works more efficiently with the H-representa-
tion. The choice of representation and algorithms will affect the running
time. In this article, we use the V-representation. Owing to the complexity
of the convex hull problem, the worst case complexity of our algorithm is
exponential in the number of features.

4.4 Verification of the necessary condition
On computation of NÃ°xÃž and cÃ°x, yÃž, the feature vector of the experimen-
tally determined structure, it remains to verify whether cÃ°x, yÃž 2 @NÃ°xÃž.
Often, NÃ°xÃž is represented by its vertices (V-representation) or its
confining half planes (H-representation), two equivalent representations
that can be transformed into one another. In an H-representation, cÃ°x, yÃž
is on the boundary of NÃ°xÃž iff there is at least one confining plane on
which cÃ°x, yÃž lies. This is true because cÃ°x, yÃž 2 NÃ°xÃž anyways. Therefore,
the necessary condition can be easily checked by checking membership
of cÃ°x, yÃž in every confining plane. Because the vertices of NÃ°xÃž are on the
integer lattice, all calculations are rational and hence can be performed
exactly.

4.5 Dataset
We used 1350 unpseudoknotted RNA sequenceâ€“structure pairs from
RNA STRAND v2.0 database as our dataset D. RNA STRAND v2.0

RNA Newton polytope

contains known RNA secondary structures of any type and organism,
particularly with and without pseudoknots. RNA STRAND v2.0
(Andronescu et al., 2008) is a convenient source of RNA sequences and
structures selected from various Rfam families (Burge et al., 2013). There
are 2334 pseudoknot-free RNAs in the RNA STRAND database. We
sorted them based on their length and selected the first 1350 ones, whose
lengths vary between 4 and 121 nt. We excluded pseudoknotted structures
because our current implementation is incapable of considering pseudo-
knots. Some sequences in the dataset allow only A-U base pairs (not

The point is NOT on the surface

s
r
i
a
p
U
G

 

40

30

20

10

0
40

20

CG pairs

0

0

10

30

20

AU pairs

50

40

AG

U

A
A

UAUGCU

G C A G C A

U

AU
A
A
G U
G
C
C
G
AGAGU
A
UU U A
A
UC
U
G
U

A

gCCAGGAUG

C
ACUGGU

A C U G G U g C C A G G A
C

U C A UUUA
A
A G A GU
G
C
C
G
GU
A
A
A U

U

A
A
C
A U
G
GCA
G
C
U
A
U
A

A G

Final Polygon for a Ribosomal RNA (2D)

s
r
i
a
P
 
e
s
a
B
G
C

 

 
f
o
 
r
e
b
m
u
N

40

30

20

10

0
0

10

20

30

Number of AU Base Pairs

40

50

Fig. 1. (Top) The 3D Newton polytope of a ribosomal RNA. The
observed feature vector is not on the surface, rÃ°xÃž Â¼ 2. (Middle) The
observed secondary structure of the ribosomal RNA. (Bottom) The 2D
Newton polygon of the ribosomal RNA, rÃ°xÃž Â¼ 10. The blue point rep-
resents the observed 2D feature vector

i303

E.Forouzmand and H.Chitsaz

The point is on the surface

The point is NOT on the surface

s
r
i
a
p
U
G

 

10

8

6

4

2

0
15

s
r
i
a
p
U
G

 

40

30

20

10

0
60

10

5

CG pairs

0

0

4

2

AU pairs

6

40

20

CG pairs

0

0

10

20

AU pairs

40

30

G
G
U

C
C
G

C
U
G
G
G
C
G
C
A
C

G
A
C
A
GU
G
C
GA
U
G
U
G
U C

 

s
r
i
a
P
e
s
a
B
G
C

 

 
f

o

 
r
e
b
m
u
N

14

12

10

8

6

4

2

0
0

Final Polygon for HIVâˆ’1 RREâˆ’IIB RNA (2D)

1

2
5
Number of AU Base Pairs

3

4

6

7

Fig. 2. (Top) The 3D Newton polytope of HIV-1 RRE-IIB 32
NUCLEOTIDE RNA. The observed feature vector is on the surface,
rÃ°xÃž Â¼ 0. (Middle) The observed secondary structure of HIV-1 RRE-
IIB 32 NUCLEOTIDE RNA. (Bottom) The 2D Newton polygon
of HIV-1 RRE-IIB 32 NUCLEOTIDE RNA, rÃ°xÃž Â¼ 2. The blue point
represents the observed 2D feature vector. Note that even though the
necessary condition is not satisfied in 2D, it is in 3D

a single C-G or G-U pair), in which case the Newton polytope degener-
ates into a line.

N
N

C
G
G
A
C
C
G
U

U
U
U
G
G
U
G

GCGAUAG

GAGUAGGACGU
C C G A U G G

C G

AA

U A

AGCCCCUGC
G U U G G G G U

U
G U

C
G
CAG
U

A
U

A
C

G
U

A
GGUC
C
A
G
C
U A A
U

A
C
C
GAAG
C
G
G
U
C
A
C
A

UCC

C
A
U
A

C C G A

Final Polygon for 5S Ribosomal RNA (2D)

 

s
r
i
a
P
e
s
a
B
G
C

 

 
f
o
 
r
e
b
m
u
N

50

40

30

20

10

0
0

5

10

15

20

25

30

35

40

Number of AU Base Pairs

Fig. 3. (Top) The 3D Newton polytope of E.coli 5S rRNA. The observed
feature vector is not on the surface, rÃ°xÃž Â¼ 7. (Middle) The observed
secondary structure of E.coli 5S rRNA. (Bottom) The 2D Newton poly-
gon of E.coli 5S rRNA, rÃ°xÃž Â¼ 7. The blue point represents the observed
2D feature vector

Implementation

4.6
We implemented the dynamic programming in equation (24) using
MATLAB convex hull function, which is based on the quickhull
algorithm (Barber et al., 1996). As mentioned above, we used the

V-representation and computed the Minkowski sum by direct pairwise
summation of vertices. More precisely,
for two convex polytopes
P with vertices p1, . . . , pa and Q with vertices q1, . . . , qb, the vertices
of P  Q are pi Ã¾ qj
for 1  i  a and 1  j  b. To verify the

i304

RNA Newton polytope

necessary condition, i.e. whether the experimentally determined feature
vector lies on the boundary of the Newton polytope, we calculated the
distance of the feature vector from the boundary of the polytope using
the â€˜p_poly_distâ€™ MATLAB function (Yoshpe, 2006). A zero distance
corresponds to the case where the feature vector lies on the boundary,
i.e. the condition is satisfied, and a positive distance to the case where
the feature vector is in the interior of the Newton polytope. We nor-
malized the distance by third root of the volume of the polytope
(square root of the area in the case of a polygon). The normalized
distance quantifies how far the feature vector is from the boundary.
We parallelized our MATLAB code using MATLAB â€˜parforâ€™. The
length of input RNA sequences varied between 4 and 120 nt. For
the smallest ones, our program took a fraction of a second and for
the longest ones it took510 min to run on a 2.5 GHz 12-Core AMD
Opteron CPU.

5 RESULTS
For each strand of RNA, the distance between cÃ°x, yÃž, the real
feature vector of the secondary structure and the computed
convex hull, NÃ°xÃž,
is calculated using (Yoshpe, 2006). We
denote this distance by r(x) here. The necessary condition for
the learnability is satisfied if rÃ°xÃž Â¼ 0 for all x in the dataset,
which shows that the observed feature vector lies on the bound-
ary of NÃ°xÃž.

Figure 1 illustrates the secondary structure of a ribosomal
RNA and its 2D and 3D Newton polytopes. This RNA is
116 nt long, and the distance between the polytope and the
observed feature vector for this RNA is 2. In the 2D (AU,
CG) model, this distance is 10. The observed feature vector
has moved closer to the boundary, going from 2D to 3D, as
GU pairs are accounted for in the 3D model. Figure 2 shows
a shorter HIV-1 RNA with the length of 32 nt. The distance
between the 3D polytope and the observed feature vector for
this RNA is 0, while there is a distance of 2 in the 2D model.
In this case also, the observed feature vector has moved closer to
the boundary, going from 2D to 3D. Because there is no GU
pair in this observed structure, the observed feature vector lies on
the c3Ã°x, yÃž Â¼ 0 face, which is on the boundary of the polytope.
Figure 3 illustrates Escherichia coli 5S ribosomal RNA, which is
121 nt long, and the distance between the feature vector and the
polytope is 7 in this case. The distance has not changed in the 3D
model.

Figure 4 demonstrates the histogram of r(x) for the input
dataset. Out of 1350 strands of RNA, the observed feature
vector is on the surface of the 3D Newton polytope for 749
(55%) sequences. The distance r is not zero, but not more than
one, for 289 (21%) sequences. For 141 (10%) strands, this

Distance Histogram

Distance

800

700

600

500

400

300

200

100

s
e
c
n
e
u
q
e
S

 
f
o
 
r
e
b
m
u
N

0
0

1

2

3

4

Distance

5

6

7

8

Normalized Distance

0.15
0.3
Distance/3rd Root(Volume)

0.25

0.2

1200

1000

800

600

400

200

s
e
c
n
e
u
q
e
S

 
f

o
 
r
e
b
m
u
N

0
0

0.05

0.1

p
ï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒ
VolÃ°NÃ°xÃžÃž

350

300

250

200

150

100

50

0
0

250

200

150

100

50

s
e
c
n
e
u
q
e
S

 
f

o

 
r
e
b
m
u
N

s
e
c
n
e
u
q
e
S

 
f
o
 
r
e
b
m
u
N

2

4

6

Distance

8

10

12

14

Normalized Distance

Fig. 4. (Top) Histogram of r(x) in the 3D model. (Bottom) Histogram of
rÃ°xÃž=

3

Fig. 5. (Top) Histogram of r(x) in the 2D (AU, CG) model. (Bottom)
Histogram of rÃ°xÃž=

p

ï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒï¬ƒ
AreaÃ°NÃ°xÃžÃž

0.35

0.4

0.45

0
0

0.1

0.2

0.3

0.4

0.5

0.6

Distance/Sqrt(Area)

i305

E.Forouzmand and H.Chitsaz

Number of Faces Histogram

Number of Polyhedron Vertices vs. Strand Length

350

300

250

200

150

100

50

s
e
c
n
e
u
q
e
S

 
f

o

 
r
e
b
m
u
N

0
0

20

40

60

700

600

500

400

300

200

100

s
e
c
n
e
u
q
e
S

 
f

o
 
r
e
b
m
u
N

0
0

20

40

60

180

160

140

120

100

80

60

40

20

s
e
c
i
t
r
e
V

 
f

o

 
r
e
b
m
u
N

120

140

160

180

0
0

20

40

60
80
Strand Length

100

120

140

80

100

Number of Faces

Vertices Histogram

Number of Polygon Vertices vs. Strand Length

s
e
c
i
t
r
e
V

 
f

o
 
r
e
b
m
u
N

16

14

12

10

8

6

4

2
0

120

140

160

180

20

40

60
80
Strand Length

100

120

140

80

100

Number of Vertices

Fig. 6. (Top) Histogram of the number of faces of the 3D polytope.
(Bottom) Histogram of the number of vetices of the 3D polytope

Fig. 7. (Top) Scatter plot of the number of vertices versus strand length
in the 3D model. (Bottom) Scatter plot of the number of vertices versus
strand length in the 2D model

distance is between 1 and 2, and for 171 (13%) strands, it is more
than 2, and just for 11 (1%) sequences, this distance is above 5.
As it is clear from Figure 4, the largest r is 8 bp in the 3D model.
The second plot in Figure 4 shows the normalized distance histo-
gram. The third root of the polytopeâ€™s volume is used as the
normalization factor. For the same set of strands, the observed
feature vector of only 176 strands lies on the boundary of the 2D
Newton polygon. For 327 sequence, this distance is larger than 5.
As you can see in Figure 5, the maximum distance between an
observed feature vector and the polygon is 14 in the 2D model.
The second plot in Figure 5 shows the normalized distance histo-
gram. The square root of the polygonâ€™s area is used as the nor-
malization factor.

Figure 6 shows the histogram of the number of faces of the 3D
Newton polytope; 79 strands have a polytope with less than 10
faces. The minimum number of faces is five, and 118 strands
yield a polytope with more than 100 faces. For 211 strands,
the polytope has more than 10 but no more than 20 faces.
Only 47 strands have more than 150 faces. The second plot in
Figure 6 depicts the histogram of the number of vertices of the
Newton polytope. Figure 7 shows the relation between the length
and number of vertices for the 2D and 3D models. The number
of vertices in 2D is not more than 15, but that number increases
to about 180 in 3D.

6 CONCLUSION AND FUTURE WORK

We introduced the notion of learnability of the parameters of an
energy model as a measure of its inherent capability. We derived
a necessary condition for the learnability and gave a dynamic
programming algorithm to assess it. Our algorithm computes the
convex hull of the feature vectors of all feasible structures in the
ensemble of a given input sequence. Also, that convex hull coin-
cides with the Newton polytope of the partition function as a
polynomial in transformed energy parameters.

Our theory applied to a simple energy model that counts A-U,
C-G and G-U base pairs separately revealed that about half of
chosen known structures could potentially be predicted using this
simple energy model. For another one-fifth, the necessary con-
dition is barely violated, which suggests that augmenting this en-
ergy model with more features is expected to satisfy the necessary
condition for them. The condition is severely violated for 13% of
sequences, which will be the subject of future investigation. The
twilight zone (10%) is also interesting and requires deeper
examination.

The Newton polytope lies in the core of computer algebra for
solving polynomial equations. Therefore, we envision applica-
tions of our RNA Newton polytope in symbolic estimation of

i306

RNA Newton polytope

energy parameters. Our algorithm has a worst case exponential
complexity due to the computation of the convex hull. However,
we envision efficient approximation of the Newton ploytope
through topology-preserving dimensionality reduction methods.
Applying our method to increasingly complex models as well
as design of energy models using our analysis method will be
pursued in the future. Sufficient conditions for the learnability,
and also assessing the generalization power of an energy model,
remain for future work.

Gibson,D.G. et al. (2010) Creation of a bacterial cell controlled by a chemically

synthesized genome. Science, 329, 52â€“56.

Gottesman,S. (2005) Micros for microbes: non-coding regulatory RNAs in bacteria.

Trends Genet., 21, 399â€“404.

Hannon,G.J. (2002) RNA interference. Nature, 418, 244â€“251.
Mathews,D. et al. (1999) Expanded sequence dependence of thermodynamic
parameters improves prediction of RNA secondary structure. J. Mol. Biol.,
288, 911â€“940.

McCaskill,J. (1990) The equilibrium partition function and base pair binding

probabilities for RNA secondary structure. Biopolymers, 29, 1105â€“1119.

Nussinov,R. et al. (1978) Algorithms for loop matchings. SIAM J. Appl. Math., 35,

Conflict of Interest: none declared.

REFERENCES

Andronescu,M. et al. (2007) Efficient parameter estimation for RNA secondary

68â€“82.

Rivas,E. and Eddy,S. (1999) A dynamic programming algorithm for RNA structure

prediction including pseudoknots. J. Mol. Biol., 285, 2053â€“2068.

Rivas,E. et al. (2012) A range of complex probabilistic models for RNA secondary
structure prediction that includes the nearest-neighbor model and more. RNA,
18, 193â€“212.

Seeman,N. (2005) From genes to machines: DNA nanomechanical devices. Trends

structure prediction. Bioinformatics, 23, 19â€“28.

Biochem. Sci., 30, 119â€“125.

Andronescu,M. et al. (2008) RNA STRAND: the RNA secondary structure and

Seeman,N.C. and Lukeman,P.S. (2005) Nucleic acid nanostructures: bottom-up

statistical analysis database. BMC Bioinformatics, 9, 340.

Andronescu,M. et al. (2010) Computational approaches for RNA energy parameter

estimation. RNA, 16, 2304â€“2318.

Barber,C.B. et al. (1996) The quickhull algorithm for convex hulls. ACM Trans.

Math. Softw., 22, 469â€“483.

Bartel,D.P. (2004) MicroRNAs: genomics, biogenesis, mechanism, and function.

control of geometry on the nanoscale. Rep. Prog. Phys., 68, 237â€“270.

Siegfried,N.A. and Bevilacqua,P.C. (2009) Thinking inside the box: designing,
implementing, and interpreting thermodynamic cycles to dissect cooperativity
in RNA and DNA folding. Methods Enzymol., 455, 365â€“393.

Simmel,F. and Dittmer,W. (2005) DNA nanodevices. Small, 1, 284â€“299.
Storz,G.

(2002) An expanding universe of noncoding RNAs. Science, 296,

Cell, 116, 281â€“297.

1260â€“1263.

Bernhart,S. et al. (2006) Partition function and base pairing probabilities of RNA

Tinoco,I. et al. (1973) Improved estimation of secondary structure in ribonucleic

heterodimers. Algorithms Mol. Biol., 1, 3.

acids. Nat. New Biol., 246, 40â€“41.

Brantl,S.

(2002) Antisense-RNA regulation and RNA interference. Biochim.

Venkataraman,S. et al. (2007) An autonomous polymerization motor powered by

Biophys. Acta, 1575, 15â€“25.

DNA hybridization. Nat. Nanotechnol., 2, 490â€“494.

Burge,S.W. et al. (2013) Rfam 11.0: 10 years of RNA families. Nucleic Acids Res.,

Wagner,E. and Flardh,K. (2002) Antisense RNAs everywhere? Trends Genet., 18,

41, D226â€“D232.

223â€“226.

Chitsaz,H. et al. (2009a) biRNA: fast RNA-RNA binding sites prediction. In:
Workshop on Algorithms in Bioinformatics (WABI). Vol. 5724, LNBI,
Springer-Verlag, Berlin, Heidelberg.

Chitsaz,H. et al. (2009b) A partition function algorithm for interacting nucleic acid

strands. Bioinformatics, 25, i365â€“i373.

Dewey,C.N.

et al.

(2006) Parametric alignment of Drosophila genomes.

PLoS Comput. Biol., 2, e73.

Dirks,R.M. and Pierce,N.A. (2003) A partition function algorithm for nucleic acid
secondary structure including pseudoknots. J. Comput. Chem., 24, 1664â€“1677.
Do,C.B. et al. (2006) CONTRAfold: RNA secondary structure prediction without

physics-based models. Bioinformatics, 22, 90â€“98.

Waterman,M.S. and Smith,T.F. (1978) RNA secondary structure: a complete

mathematical analysis. Math. Biosci., 42, 257â€“266.

Yin,P. et al. (2008) Programming DNA tube circumferences. Science, 321, 824â€“826.
Yoshpe,M. (2006) Distance from a point to a 2D polygon. http://www.mathworks.
com/matlabcentral/fileexchange/12744-distance-from-a-point-to-polygon (14 May
2013, date last accessed).

Zakov,S. et al. (2011) Rich parameterization improves RNA structure prediction.
In: Bafna,V. and Sahinalp,S. (eds.) Proceedings of the 15th Annual International
Conference on Research in Computational Molecular Biology, Vol. 6577, Lecture
Notes in Computer Science. Springer, Berlin-Heidelberg, pp. 546â€“562.

Zamore,P.D. and Haley,B. (2005) Ribo-gnome: the big world of small RNAs.

Eddy,S.R. and Durbin,R. (1994) RNA sequence analysis using covariance models.

Science, 309, 1519â€“1524.

Nucleic Acids Res., 22, 2079â€“2088.

Emiris,I. (1994) Sparse elimination and applications in kinematics. Ph.D. Thesis,

UC Berkeley, Berkeley, CA.

Emiris,I.Z. and Canny,J.F. (1995) Efficient incremental algorithms for the sparse

resultant and the mixed volume. J. Symbolic Comput., 20, 14â€“19.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA sequences
using thermodynamics and auxiliary information. Nucleic Acids Res., 9,
133â€“148.

i307

