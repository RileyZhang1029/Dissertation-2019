BIOINFORMATICS

Vol. 25 ISMB 2009, pages i30–i38
doi:10.1093/bioinformatics/btp205

Model-based clustering of array CGH data
Sohrab P. Shah1,2∗, K-John Cheung Jr2, Nathalie A. Johnson2, Guillaume Alain1,
Randy D. Gascoyne2, Douglas E. Horsman2, Raymond T. Ng1 and Kevin P. Murphy1
1Department of Computer Science, University of British Columbia, 201-2366 Main Mall Vancouver, BC V6T 1Z4
Canada and 2British Columbia Cancer Agency, 600 W 10th Ave Vancouver, BC V5Z 4E6 Canada

ABSTRACT
Motivation: Analysis of array comparative genomic hybridization
(aCGH) data for recurrent DNA copy number alterations from a cohort
of patients can yield distinct sets of molecular signatures or proﬁles.
This can be due to the presence of heterogeneous cancer subtypes
within a supposedly homogeneous population.
Results: We propose a novel statistical method for automatically
detecting such subtypes or clusters. Our approach is model based:
each cluster is deﬁned in terms of a sparse proﬁle, which contains the
locations of unusually frequent alterations. The proﬁle is represented
as a hidden Markov model. Samples are assigned to clusters
based on their similarity to the cluster’s proﬁle. We simultaneously
infer the cluster assignments and the cluster proﬁles using an
expectation maximization-like algorithm. We show, using a realistic
simulation study, that our method is signiﬁcantly more accurate
than standard clustering techniques. We then apply our method to
two clinical datasets. In particular, we examine previously reported
aCGH data from a cohort of 106 follicular lymphoma patients, and
discover clusters that are known to correspond to clinically relevant
subgroups. In addition, we examine a cohort of 92 diffuse large B-cell
lymphoma patients, and discover previously unreported clusters of
biological interest which have inspired followup clinical research on
an independent cohort.
Availability: Software and synthetic datasets are available at
http://www.cs.ubc.ca/~sshah/acgh as part of
the CNA-HMMer
package.
Contact: sshah@bccrc.ca
Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION
Copy number alterations (CNA) are structural variations expressed
in the form of DNA copy number differences at a particular region
in the genome. The search for ‘driver’ CNAs in genetic material
derived from cancerous tissues is a major goal in diagnostic and
cytogenetic cancer research (Aguirre et al., 2004; Chin and Gray,
2008; Michels et al., 2007; Tonon et al., 2005). Putative driver
CNAs are genomic ampliﬁcations or deletions ranging in size from
a few kilobases to whole chromosome arms that are recurrent in a
larger than expected proportion of patients. Their detection provides
candidate genetic markers that may play a role in tumorigenesis
and/or have clinicopathologic signiﬁcance. In contrast, ‘passenger’
CNAs arise during the evolution of the tumor and may be present
due to genomic instability or other mechanisms. In the context
of deﬁning the driver CNAs, passenger CNAs represent (often
∗

To whom correspondence should be addressed.

ubiquitous) ‘biological’ noise that might obscure driver signals.
Using high-resolution array comparative genomic hybridization
(aCGH) (Pinkel and Albertson, 2005), data consisting of tens to
hundreds of thousands of probes, putative driver CNAs can be
detected by identifying the subset of probes they span using a number
of algorithmic and statistical tools (Diskin et al., 2006; Klijn et al.,
2008; Rouveirol et al., 2006; Shah et al., 2007). These analyses
lead to a molecular proﬁle of recurrent CNAs that help deﬁne the
molecular characteristics of the disease.

A challenging phenomenon is that, frequently, patient cohorts
exhibit heterogeneity in their molecular proﬁles. This has been
demonstrated in breast (Perou et al., 2000), ovarian (Khalique et al.,
2007) and prostate cancers, as well as lymphomas (Cheung et al.,
2008; Höglund et al., 2004), suggesting that the patients should
be stratiﬁed into molecular subtypes, where the patients within a
group share a common group-speciﬁc driver CNA proﬁles. This
concept has been successfully applied many times over using gene
expression data (Perou et al., 2000; Wright et al., 2003), however it
has been relatively under-studied in aCGH data.

Considering a cohort of patients as a composite of a ﬁxed set
of molecular subtypes has distinct advantages when determining
recurrent CNAs. By grouping or clustering the patients, recurrent
CNAs that might otherwise go undetected can be revealed. This
approach has the potential of determining CNAs that co-occur within
a subtype and CNAs that are mutually exclusive between subtypes.
Moreover, groups of patients can be assessed for distinct clinical
outcomes. Molecular subtypes often correlate with clinical outcomes
and in fact can, once identiﬁed, be considered as distinct disease
entities (Sorlie, 2004) with different prognoses and/or response to
therapy.

Recent discovery of clinically relevant molecular subtypes by
aCGH (Chin et al., 2007; Idbaih et al., 2008) suggest
that
the inventory of CNA-derived molecular subtypes in cancer is
not complete. Large-scale projects such as the Cancer Genome
Atlas Project (Collins and Barker, 2007) and the International
Cancer Genome Consortium (ICGC: http://www.icgc.org) are now
generating genomic array datasets from tumors from hundreds
of patients for speciﬁc cancer types, thereby providing excellent
potential for the discovery of new CNA-derived subtypes. In order to
take full advantage of these data, robust and accurate computational
algorithms for discovering molecular subgroups must be developed
to keep pace with the data generation.

In this article, we propose an approach to this problem based on
a mixture of HMMs (hidden Markov models); we call our approach
HMM-Mix. This extends our previous work (Shah et al., 2006, 2007)
by deﬁning multiple HMMs, one per cluster and automatically
assigning samples to clusters while simultaneously inferring the
proﬁle of each cluster. Although the proﬁles are deﬁned in terms of

 2009 The Author(s)
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i30

i30–i38

‘called’data (i.e. each location is classiﬁed as a loss, a gain or neutral/
no change), the model works directly with the raw aCGH data, and
can recall ambiguous data in the context of the cluster to which it is
assigned. This increases the statistical power of our method to detect
shared, but subtle, CNAs that may be lost by methods that require
discretization of the data as a preprocessing step, as shown in our
previous work (Shah et al., 2007) and by Klijn et al. (2008).

In a simulation study, with realistic data, we show how our
method is more accurate than other clustering methods, including
hierarchical clustering (van Wieringen and van de Wiel, 2008) and
K-medoids (KM) (an approach not previously applied to data of this
kind). More importantly, we show how HMM-Mix reveals clinically
relevant subgroups in data derived from a cohort of 106 follicular
lymphoma (FL) patients, originally reported in Cheung et al. (2008),
and reveals previously unreported patterns of alteration in a cohort
of 92 diffuse large B-cell lymphoma (DLBCL) patients (Johnson
et al., 2008).

2 METHODS
We ﬁrst describe our probabilistic model, and then how we perform inference
in this model. We also describe three other approaches against which we
compare our method: a simple K-medoids method (WKM) a weighted
K-medoids method, and a previously described hierarchical clustering
algorithm designed for aCGH (van Wieringen and van de Wiel, 2008).

→ Z1:P

1:T where Zp

The HMM-Mix model is a probabilistic generative model of Y 1:P

2.1 The HMM-Mix model
t ∈IR for each probe t∈(1,...,T) in
We represent the aCGH logratios as Y p
the array and for each patient p∈(1,...,P). Each probe maps to unique
genomic coordinates and is positionally ordered along the chromosomes.
Y 1:P
1:T represents the full data matrix. For each datapoint, we assume there is
t ∈ k and k is a discrete copy
a discrete mapping from Y 1:P
1:T
number state ∈{L,N ,G} representing loss, neutral and gain.
1:T . We
illustrate our conditional independence assumptions using a graphical model
in Figure 1, and we deﬁne all the conditional distributions in Figure 2. See
also Table 1 for a summary of the notation.
The model generates the data as follows. First we sample a group or
cluster label for each patient, denoted Gp∈{1,...,G}, from a Multinomial
with parameter π g. Here, G is the number of clusters (see below for
how we choose this), and π g is the vector of mixing weights. Next,
each group G generates a proﬁle which is represented as a sequence
t ∈{L,B,G}, t=1: T, representing loss, background or gain
of states, Mg
at probe t in the array. Probes which are labeled loss are expected to
contain mostly losses; probes which are labeled gain are expected to contain
mostly gains; probes which are labeled background are expected to contain
whatever the background distribution of loss, gains and neutrals is. Thus,
the non-background probes are the interesting ones.1 Since CNAs occur
in runs (span contiguous sets of probes), we model correlation between
consecutive locations using a ﬁrst-order Markov chain on the Mg
t variables.
The transition matrix, Ag is a 3×3 matrix whereby Ag(i,j) represents
= i). We expect this matrix to have large elements on the
p(Mg
diagonal encouraging self-transitions [which we model with a Dirichlet
prior with parameters δA (see Fig. 1 and Table 1)], and thus runs of
repeated states. Of course the quantities of Ag are unknown at run time

t = j|Mg
t−1

Model-based clustering of array CGH data

t ∈ IR is the observed aCGH
t ∈{L,N ,G} is the discrete state, representing

Fig. 1. Proposed HMM-Mix model for clustering aCGH data, represented
as a directed graphical model (Gilks et al., 1996). Shaded nodes are
observed/ﬁxed, unshaded nodes are hidden (unknown). The two boxes
represent repetition over patients and groups. Y p
logratio at probe t in patient p. Zp
whether probe t is a loss, neutral or gain. Given Zp
is assumed to
be sampled from a class conditional Student-t distribution with parameters
µp
k
is sampled from a Multinomial with parameter πG. θ g
t
parameter over Zp
t ∈{1,...,C} represents the state of the sparse proﬁle for probe t
where Mg
in group g. Ag is the transition matrix for the proﬁle model. Conditional
probability distributions are shown in Figure 2. Description of variables is
given in Table 1.

k and νk. Gp∈{1,...,G} is the group that patient p belongs to, which
,λp

t , which is sampled from a Dirichlet with parameter α

is the Multinomial
,
Mg
t

t = k, Y p

t

p(M g

p(q g
p(Z p

t |A (i, :), 1)
1 |πM , 1)

t |M g

t − 1 = i, A ) = Mult (M g
1 |pM ) = Mult (M g
p(M g
t |αc )
t = c, α1:3 ) = Dir (q g
t |q g

) = Mult (Z p

t |M g
t |G p = g, q 1: G

t

k ) =

t = k, µ p
k |lp

t , 1)
p(G p |pG ) = Mult (G p |pG , 1)
k , l p
k , nk )
ηk
lp
k

k , l p
St (Y p
k , f ) = N (µ p
k |f) = Gam (λp

k |S k , g k )
p(A (i, . )|dA ) = Dir (A (i, . )|dA )

k |m k ,

t |µ p

p(lp

p(µ p

)

p(Y p

t |Z p

p(pG |dp ) = Dir (pG |dG )

Fig. 2. List of conditional probability distributions of HMM-Mix.

1Indeed, one of the primary goals of inference is to ﬁnd the probes for which
t (cid:4)= B|D) is high; these probes represent a sparse proﬁle deﬁning the
p(Mg
signature for group g. Thus, our model is somewhat similar to approaches
that perform simultaneous feature selection and clustering (Law et al., 2004;
Raftery and Dean, 2006).

and are estimated by ﬁtting the model to the data (see Section 2.2).
Therefore, the off-diagonal elements of the matrix, including for example
the transitions{B→ L,B→ G,L→ B,...}, are fully represented and estimated
accordingly.

i31

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i31

i30–i38

S.P.Shah et al.

Table 1. Summary of variables

Symbol

Meaning

Sk
T
G
P
t∈{1,...,T}
g∈{1,...,G}
p∈{1,...,P}
c∈{L,B,G}
k∈{L,N ,G}
t ∈{L,B,G}
Mg
t ∈ S3
θ g
t ∈{L,N ,G}
Zp
t ∈IR
Y p
Gp∈{1,...,G}
π G∈ SG
Ag∈ S3×3
∈IR
µp
∈IR
+
k
λp
νk ∈IR
+
k
πM
αc,δG,δA
φ=(mk ,ηk ,Sk ,γk)3
k=1

DOF = degrees of freedom.

Set of probability vectors of length k
Number of probes (measurements)
Number of groups (clusters)
Number of patients (samples)
Probe location
Group index
Patient index
State index
Call index
State of proﬁle
Distribution over calls
Called aberation
Raw data (log ratios)
Group assignment
Prior over groups
Transition matrix
Mean of observations
Precision of observations
DOF for observations (ﬁxed)
Multinomial parameters (ﬁxed)
Dirichlet hyper-parameters (ﬁxed)
Normal-Gamma hyper-parameters (ﬁxed)

t

t = L, then θ g

Once we have generated a discrete proﬁle for each group, we convert
it into a distribution over calls. Speciﬁcally, state Mg
t of the Markov chain
‘emits’ a probability vector θ g
t , representing a probability distribution over
the ‘letters’ {L,N ,G}, representing ‘called’ aCGH states. In other words, θ g
t
represents the relative frequencies of calls we would expect at location t in
t is sampled from a Dirichlet with parameters αL =
group g. If Mg
(aL,1,1), which is biased toward the letter L (by setting aL (cid:5)1). Similarly, if
is sampled from a Dirichlet with parameters αG=(1,1,aG),
t = G, then θ g
Mg
t = B, then
which is biased toward the letter G (by setting aG(cid:5)1). If Mg
θ g
is set equal to θ g
0 , representing the overall background, which is shared
0 is itself sampled from a Dirichlet with parameters αB=
t
across locations; θ g
(1,aB,1), which is biased toward the letter N (by setting aN (cid:5)1). Once
we have generated the continuous proﬁle for each group, θ g
t , we are able
t ∈{L,N ,G} from a
to generate data for each patient. We sample a call Zp
Multinomial with parameter θ g
t . Here, it would be appropriate to model
Zp
1:T as a Markov chain to capture the spatial correlation in the data at the
level of each patient. However, as shown in our previous work (Shah et al.,
2007), this makes inference expensive since all the Z chains become coupled.
Instead, we initialize each Zp
1:T using Markov chains (see below) to capture
the patient level spatial correlation and ﬁnd that this is sufﬁcient for our task
of capturing the group-speciﬁc recurrent CNAs which are explicitly modeled
as a Markov chain Mg

Finally, we convert the discrete call into a continuous observation, Y p

1:T .

t ∈IR,

t = k, we use mean µp

by sampling from a Student-t distribution; this is more robust to outliers than
a Gaussian. Speciﬁcally, if Zp
k and ﬁxed
degrees of freedom ν=3. (We ﬁx the degrees of freedom to simplify the
inference procedure; we have found that our results are reasonably robust
to the value of ν.) Note that the parameters of the observation density are
patient speciﬁc, but are shared across locations. The observation parameters
µp
k and λp
k are sampled from a standard conjugate prior. Details on how we
set the hyper-parameters are outlined in Shah et al. (2007).

k, precision λp

t . This is valid since θ g
t

integrate out θ g
is just a nuisance parameter, i.e. it
is not a variable we are interested in estimating. (Several other variables
are also nuisance parameters, but eliminating them would make inference
harder, not easier.) The modiﬁed conditional distribution is

(cid:1)

p(Zp

t |M1:G

t

,α1:3,Gp= g)=

p(Zp

t |θ g
t )p(θ g
= 1(cid:2)

t

t |αc)dθ g
K(cid:3)
k=1

αk
c

k

(I(Zp

t = k)+αk
c )
(αk
c )

(1)

t has been removed from the model in this way.

t is the state of the Markov chain, and () is the Gamma function
t = k) is an indicator function

where c= Mg
(see Brown et al., 1993, for details) and I(Zp
stating that the copy number call for patient p at probe t is k. Henceforth, we
assume θ g
Our primary objective is to infer a clustering, p(Gp|D), and a proﬁle for
|D). One approach would be to use Markov chain Monte
each cluster, p(Mg
1:T
Carlo (MCMC) to draw samples from the full posterior, but this is too slow
for our application, which has about P∼100 patients, and about T ∼ 27 000
probes (over all the chromosomes) per patient.

k,λp

t , Zg

An alternative would be to use the expectation maximization (EM)
algorithm (Dempster et al., 1977). A natural approach would be to treat all the
unknown discrete variables (i.e. Mg
t and Gp) as ‘hidden variables’, and
treat the rest (i.e. Ag,π g,µp
k) as ‘parameters’. Unfortunately, this makes the
E step computationally intractable, since all the HMMs Mg
1:T become coupled
in the posterior. However, conditional on a known clustering (i.e. setting of
Gp), the HMMs become independent. Hence we can estimate the posterior
proﬁle for group g using the data that belongs to group g using the forwards–
backwards algorithm. (This requires marginalizing out Zg
t as well, in order
to derive the observation model p(Y p
t ), but this is straightforward.) Note
that this requires that we treat Gp as a ‘parameter’ in the sense that we
estimate it in the M step rather than the E step. This requires that we perform
a hard clustering of the patients, rather than a soft clustering.

t |Mg

It turns out that even EM is too slow for our application, because of the
need to marginalize out Zg
t , and because of EM’s relatively slow convergence.
We therefore decided to use the iterative conditional modes (ICM) algorithm
(Besag, 1986). This is a simple coordinate ascent algorithm, in which we
set each variable to its most probable value given its neighbors in the
graph. This can be thought of as a deterministic version of Gibbs sampling.
Alternatively, it can be thought of as a version of Viterbi EM, in which we
compute the most probable value of Mg
1:T using the Viterbi algorithm instead
of computing posterior marginals using forwards–backwards. More details
on the algorithm can be found below. Its complexity is O(TGP) per iteration,
where T is the number of probes, G is the number of groups and P is the
number of patients. In practice, it takes about 320 s to ﬁt the model to our
DLBCL data (92 patients, 5 groups and 30 000 probes) on a MacBook Pro
with 2.6 GHz Intel Core Duo 2 using a Matlab implementation.

We now give a full description of the algorithm.

2.2.1 HMM-mix algorithm—main loop The basic procedure iterates over
each node, and either samples from, or maximizes, each full conditional
distribution (details in Section 2.2.3).

|A,πM ,Z1:P
,G1:P)
(1) Estimate proﬁle: p(Mg
1:T
1:T
(2) Assign to cluster: p(Gp|πG,Zp
,Mg
1:T
1:T )
t ,µp
(3) Call data: p(Zp
t ,Gp,Mg
,λp
1:3
1:3)
|Y p
,λp
(4) Fit observation model: p(µp
1:T
k
k
(5) Fit transition model: p(Ag|Mg
1:T
,δA)
(6) Fit group prior: p(πG|G1:P,δG)

t |Y p

,Zp
1:T

,φ)

Inference

2.2
Although the model was described in terms of Mg
turn generates the Zp

t , which in
t calls, it turns out to simplify inference if we analytically

t generating θ g

2.2.2 HMM-mix algorithm—initialization

1. Set the hyper-parameters φ in a data-driven way, as explained in Shah

et al. (2007).

i32

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i32

i30–i38

2. Estimate Zp
3. Estimate Gp using WKM (see Section 2.4) on Z1:P
1:T .
4. Estimate Mg

1:T for each patient separately using Shah et al. (2006).
t as follows. Given Z1:P

1:T for the patients in group g,
compute the entropy of each column. If the entropy is low and most
t = L; if the entropy is low and most calls are
calls are losses, set Mg
gains, set Mg

t = G; otherwise set Mg

t = B.

2.2.3 HMM-mix algorithm details We now explain each step in more
detail.

(1) The most expensive step is the ﬁrst one, which takes O(TGP) time
using the Viterbi algorithm. To compute this, we need the observation
likelihoods for each location, which are given by

Bg(t,c) = P(cid:3)
t = c) is the likelihood obtained by integrating out θ g
where p(Zp
using Dirichlet hyper-parameter αc (Equation 1). We then compute

I(Gp= g)p(Zp

t = c)

t |Mg

t |Mg

p=1

t

=Viterbi(Bg(:,:),Ag,πm)

Mg
1:T

(2) Posterior over cluster assignments:
p(Gp= g|·)∝ π g

T(cid:3)
t=1

G

t |Mg

p(Zp

t ,α1:3)

(3) Posterior over calls

p(Zp

t = k|·)∝ p(Zp

t = k|M1:G

t

,α1:3,Gp= g)p(Y p

t |µp

k

,λp
k)

(4) Update observation model parameters (as speciﬁed in Archambeau,
2005), but for the 1D case for each patient p. Use a Normal Gamma
prior for p(µp
k) (Fig. 2), with hyper-parameters (mk ,ηk ,Sk ,γk).
k
Compute the following quantities:

,λp

t (k)=
¯up

1+νk
k)2λp
t = k|·)

k

t −µp
(Y p
t (k)= p(Zp
ρp

+νk)

t (k) is computed in step 3. The maximum a posteriori update

where ρp
equations then become:
=

µp
k

(cid:2)
(cid:2)
t (k)¯up
ρp
t (k)Y p
T
t=1
t (k)¯up
ρp
T
t=1

t +ηkmk
t (k)+ηk

(cid:4)(cid:2)

=

λp
k

(cid:2)
T
t=1

t −µp
t (k)¯up
t (k)(Y p
ρp
k)2
t (k)+γk−1
ρp
T
t=1

(cid:5)−1

(cid:2)
−mk)2+Sk
+ ηk(µp
k
t (k)+γk−1
ρp
T
t=1

(5) Posterior over transition matrix. Deﬁne the sufﬁcient statistics as

Then

t=2

I(Mg
t−1

t = j)

= i,Mg

Nij = T(cid:6)
p(Ag|·)= 3(cid:3)
Dir(Ag(i,:)|Ni,:+δM )
Ng= P(cid:6)

I(Gp= g)

i=1

p=1

(6) Posterior over group prior. Deﬁne the sufﬁcient statistics as

Model-based clustering of array CGH data

Then

p(πG|·)= Dir(πG|N1+δG,1,...,NG+δG,G)

t rather than Y p

2.3 K-medoids
To compare HMM-Mix to a simpler method, we decided to use the KM
algorithm applied to precalled data, i.e. the input is Zp
t . [We
used our own HMM method (Shah et al., 2006) to discretize each sample
separately, but other methods could be used.] As such, KM (as well as WKM
and WECCA, both described below) are two-step or sequential methods
where in the ﬁrst step, the raw data are called as discrete copy number states
and in the second step, the patients are clustered based on the called data.
KM is just like K-means, except each cluster is represented using one of the
original samples (a discrete sequence of calls), rather than as an arithmetic
average of the samples, which does not make sense for categorical data. KM
requires a distance metric between a sample and a cluster center (prototype).
t ). Since KM is prone
to getting stuck in local minima, we used 100 restarts, and returned the
clustering with the lowest overall distortion. To choose K (the number of
clusters), we used the Silhouette coefﬁcient (van der Laan et al., 2003) (see
Section 2.6).

We used Hamming distance: d(i,j)=(cid:2)

T
t=1 I(Zi
t

= Zj

= Zj

2.4 Weighted KM
The KM algorithm described above treats all probes (features) equivalently
when computing the distance function. However, we assume that only a
(cid:2)
small subset of features are important in determining the distance between
two patients. We therefore also tried a weighted distance function, d(i,j)=
T
t=1 wtI(Zi
t
the entropy of this distribution, Et =−(cid:2)
The weights are chosen in the following heuristic way. We ﬁrst compute
the empirical distribution over calls at each location, ft. We then compute
k=L,N ,G ft(k) logft(k). Finally, we
assign high weights to locations which are highly entropic: wt = σ (Et /α),
where σ (η)= 1
1+e−η is the sigmoid function, and α is a constant that controls
the steepness of the sigmoid. (We found α=0.25 gave good results.) The
use of the sigmoid function ensures 0≤ wt ≤1.

t ). We call the resulting method WKM.

The reason that we assign high weights to the entropic locations is as
follows: locations which are useful for distinguishing the groups must differ
across patients, and hence are likely to have a multimodal distribution,
whereas locations which are not discriminative are likely to have all possible
values (be closer to uniform), and therefore have lower entropy.

In our experimental results below, we show that WKM is much better than
KM, although not as good as our model-based approach. However, because
of its simplicity and speed, we use it as a way to initialize our model-based
approach.

2.5 Hierarchical clustering
In recent work, van Wieringen and van de Wiel (2008) introduce a system
called ‘Weighted clustering of called array CGH data’ (WECCA). This
represents the ﬁrst clustering approach to be tailored speciﬁcally to the
aCGH data and is a specialized implementation of hierarchical agglomerative
clustering. The authors deﬁne a weighted form of similarity, similar in
spirit to the weighted Hamming distance described above, although the
weights are expected to be provided by the user, rather than automatically
calculated.

2.6 Choosing the number of groups
The KM and our HMM-Mix model both require that the user specify the
number of clusters G. (Hierarchical clustering does not need this information,
although one must specify some other mechanism for choosing where to cut
the dendogram.) Since KM is not a probabilistic model, one can only use
heuristics methods for picking G. We use the Silhouette coefﬁcient (Tan et al.,
2005), which computes a measure of quality that considers both cohesion
(how similar the points in a cluster are) and separation (how different the

i33

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i33

i30–i38

S.P.Shah et al.

clusters are). In particular, we compute S(G) for a range of values of G, and
pick the G with maximum score.

3 DATA
3.1 Simulated data
To test and compare performance of the various algorithms where
the true clustering was known, we generated data and embedded
group-speciﬁc patterns of recurrent CNAs. To avoid circularity
that can arise from generating data from the model directly, we
created datasets based on real aCGH data derived from mantle
cell lymphoma cell lines reported in de Leeuw et al. (2004) and
used similarly in Shah et al. (2007). We ﬁrst extracted the data
from chromosome 21 (chosen because it was reported to have
relatively few alterations), resulting in a dataset of 8 samples each
with 672 probes. For each simulated dataset, we performed 100
random draws (simulating patients) from the eight cell lines. For
each of the 100 patients, we shufﬂed the 672 probes and randomly
assigned the patient to one of G groups. For each group, we
preset coordinates of one recurrent gain and one recurrent loss.
These group-speciﬁc coordinates deﬁned the proﬁle for the group.
The alterations were embedded into each patient’s data at their
group-speciﬁc coordinates, plus a random offset number of probes
(sampled from a Gamma distribution with a mean of 10 probes).
This offset was meant to simulate the fact that recurrent CNAs often
have different patient-speciﬁc start and end coordinates, but have
segments that intersect across patients. Losses were generated by
shifting 1 SD down from the neutral state, and gains were shifts of
1 SD up. Finally, for each patient, we randomly embedded alterations
of length L at locations different than the group-speciﬁc alterations
in order to simulate patient-speciﬁc ‘passenger’ alterations expected
to be unrelated to the group proﬁle. We created 10 replications with
G=3,5,10 and L=50,75 yielding 60 datasets. These data and the
ground truth cluster assignments are included in the Supplemental
Material.

With these ground truth datasets in hand, we evaluated clustering
accuracy using the Jaccard coefﬁcient as described by Tan et al.
(2005). (This is a number between 0 and 1, where 1 is the best
possible score, corresponding to perfect correspondence to the true
clustering.)

3.2 Clinical data
We use two clinical datasets: FL (Fig. 4) and DLBCL (Fig. 5).

The FL data were derived from 106 samples taken at time
of diagnosis from patients with FL. These data were previously
reported in Cheung et al. (2008) and were expected to fall into at least
four genetic subtypes (Höglund et al., 2004). A characteristic of FL is
that in a subset of patients, the tumor undergoes a transformation to
a more aggressive subtype that consistently correlates with inferior
survival outcome. Developing a prognostic CNA proﬁle predictive
of transformation is therefore of great clinical interest.

The DLBCL data (Johnson et al., 2008), contains aCGH data for
92 patients with de novo DLBCL, all treated uniformly with multi-
agent chemotherapy (CHOP) and anti-CD20 monoclonal antibody
rituximab.

All clinical data were produced using the SMRT array platform
(Ishkanian et al., 2004) and contain approximately 27 000 probes
per sample.

i34

4 RESULTS
4.1 Simulated data
Figure 3 shows the distribution of the Jaccard coefﬁcient resulting
from using WECCA, KM, WKM and HMM-Mix on the 10 replicates
for each setting of G, the number of groups and L, the length
of the distracting patient-speciﬁc passenger alterations. Table 2
contains the mean and standard error for each of the six datasets for
the four methods. HMM-Mix showed the highest accuracy for all
six settings. When G= 3,L = 50 (Fig. 3A), HMM-Mix and WKM
were more accurate than WECCA at recovering the ground truth
classes, and statistically more accurate than KM (one-way ANOVA,
P <0.01). For G= 3, L = 75 (Fig. 3D) and G= 5, L = 50 (Fig. 3B),
HMM-Mix was more accurate than WKM and statistically more
accurate than both KM and WECCA (P <0.01). For G= 5,L = 75
(Fig. 3E), G= 10,L = 50 (Fig. 3C) and G= 10,L = 75 (Fig. 3F),
HMM-Mix was statistically more accurate than all other methods
(P <0.01). However, for G= 10,L = 75 all methods performed
poorly, since this problem is much harder than the others: there
are only 10 samples per group, and each sample is ‘corrupted’
with a fairly long (L = 75) random CNAs. We repeated these
experiments using P = 500 patients, and all methods improved in
their accuracy, although the overall relative rankings are the same
(data not shown).

HMM-Mix was generally more robust to the size L of the
randomly placed passenger alterations than the other methods,
suggesting that the model is able to maintain its ability to detect
group-speciﬁc alterations in the presence of additional structured
noise.

We also tested the robustness of HMM-Mix to initialization. In
particular, we initialized with both KM and WKM, and found that
the ﬁnal results were nearly identical, despite the fact that WKM
was signiﬁcantly more accurate than KM.

This suggests that in these settings, HMM-Mix is able to overcome
a poor initialization, most likely due to its ability to re-estimate the
calls and adapt the feature selection during inference. We suspect
that these characteristics allow it to escape from local optima more
readily than WKM, which cannot re-estimate the calls and requires
the feature selection to be ﬁxed ahead of time. Thus, these results
suggest that the joint inference of group assignments and copy
number calls used by HMM-Mix is more robust than the sequential
methods of WECCA, KM and WKM, all of which perform a
two-step method of ﬁrst calling the data, then clustering.

4.2 FL data
We applied HMM-Mix to the FL cohort of 106 patients (Cheung
et al., 2008). We initialized the model using WKM with 100 multiple
restarts and we determined the number of groups to be 6 using the
maximum Silhouette coefﬁcient over G= (2,...,8). Figure 4 shows
the WKM initializations, and the ﬁnal results of HMM-Mix. In
particular, Figure 4A shows the initial Z1:P
1:T matrix where rows are
patients and columns are probes. The rows are ordered according to
their WKM cluster assignments. The green, red and black probes
are predicted losses, gains and neutrals, respectively. Figure 4B
shows the converged estimates of HMM-Mix where the rows have
been ordered according to the HMM-Mix cluster assignments, and
the data displayed are the re-estimated calls in the presence of the
proﬁles. Figure 4B (top) shows the proﬁles of each group and it

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i34

i30–i38

Model-based clustering of array CGH data

Fig. 3. Distribution of accuracy of WECCA, KM, WKM and HMM-Mix for synthetic data generated with six different parameter settings. HMM-Mix was
the most accurate for all six settings (see Table 2 for details). Each dataset was composed of P=100 patients with 672 probes each. From left to right there
were G=3,5,10 embedded groups in the data. The top row had randomly placed CNAs of L=50 and the bottom row with L=75. Distributions of Jaccard
coefﬁcient over 10 replicates of the G,L settings are shown as notched box plots where non-overlapping notches indicate statistical difference of the medians
(red horizontal lines) with 95% CI.

Table 2. Results for simulation study showing means and standard errors of the Jaccard coefﬁcient

Dataset

G = 3 L = 50
G = 5 L = 50
G = 10 L = 50
G = 3 L = 75
G = 5 L = 75
G = 10 L = 75

WECCA
0.959±0.018
0.692±0.048
0.296±0.022
0.611±0.030
0.460±0.019
0.131±0.010

KM
0.916±0.027
0.734±0.034
0.375±0.033
0.828±0.029
0.548±0.057
0.202±0.010

WKM
0.996±0.004
0.932±0.018
0.317±0.031
0.923±0.022
0.730±0.043
0.138±0.010

HMM-Mix
0.996±0.004
0.976±0.007
0.580±0.065
0.965±0.009
0.964±0.011
0.223±0.032

ANOVA P-value
4.2 × 10
5.7 × 10
6.7 × 10
4.3 × 10
6.2 × 10
1.3 × 10

−3
−8
−5
−12
−11
−3

is clear that the re-estimated calls are heavily inﬂuenced by their
corresponding proﬁles.

The resulting groups can be summarized as follows: (1) +7
(meaning gain of chromosome 7) (7 patients); (2): a ‘null’ group
with no recurrent alterations (67 patients); (3): a group with +18
(19 patients); (4): a group with +1q and a small loss at 1p36
(7 patients); (5): a singleton outlier (1 patient); and (6): +6p/6q-

(5 patients). Notably, +1p, +6p/6q−, +7, and +18 have previously
been established as cytogenetic pathways to the initiation and
development of FL using principal component analysis applied to
data generated by a difference laboratory technique called G-banded
karyotyping (Höglund et al., 2004).

The clusters produced by HMM-Mix set mirror those reported
in Cheung et al. (2008). In that paper, the WKM method was used

i35

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i35

i30–i38

S.P.Shah et al.

Fig. 4. Clustering of FL data showing the initial calls and WKM clusters (A), the converged estimates of the calls (B), clusters and proﬁles by HMM-Mix and
the associated time to transformation Kaplan-Meier plots for each group (C). (A) The calls and clusters depicted as a heat map for WKM with G = 6. The rows
of the data indicate the patients and the columns indicate the probes. Red indicates gain, green loss and black neutral. The rows are ordered according to their
t = neutral)) and green
assigned groups as predicted by WKM. (B) The posterior probability of the calls (where red represents p(Zp
t = loss), the clusters and the proﬁles (top) for the G = 6 groups. In comparison to (A) the clusters are readily apparent from the data, they appear
represents p(Zp
to be tighter and the re-estimated calls are clearly inﬂuenced by the proﬁles, resulting in far less noisy, and far more interpretable output. Importantly, 4 of the
6 groups (labeled on right) recapitulate the previously reported subtypes for FL. Group numbers that correspond to the time to transformation curves (C) are
annotated on the right of (B). Groups 1 and 6 both had statistically signiﬁcantly shorter time to transformation. (C) Time to transformation Kaplan-Meier curves
for each group of patients as predicted by HMM-Mix for the FL cohort. Groups 1 and 6 (black and yellow) had signiﬁcantly reduced time to transformation
by log-rank test with 5 degrees of freedom. [The green curve corresponds to the singleton group shown in (B)]. These correspond, respectively, to the groups
characterized by +7 and 6p-/6q+ and suggests that these recurrent CNAs confer inferior prognoses to the patients in these groups.

t = red), blue represents p(Zp

to perform the clustering, but the method used signiﬁcant human
expertise both in determining the initial called data, Z1:P
1:T , and in
deﬁning the weighting terms, w1:T . In addition, the number of
groups (5) was chosen using supporting evidence from the literature.
In contrast, HMM-Mix is fully automated, with no user-settable
parameters, yet it managed to recover essentially the same results
of this previous method.

As further validation of the biological signiﬁcance of the clusters
found by our method, we computed Kaplan-Meier curves for each
group of the time to transformation (TTT) (deﬁned as the time from
diagnosis to clinical or pathological endpoint: transformation to the
more aggressive subtype). We show the results in Figure 4C. We see
that groups 1 and 6 (black and yellow curves) display a signiﬁcantly
shortened TTT to the others (log-rank test, P <0.01), indicating the
proﬁles characterized by +7 and +6p/6q- are potential unfavorable

prognostic indicators for FL. Note that by WKM, group 1 (shown
as the top group in Fig. 4) which results in the HMM-Mix group
characterized by +7 only contains two patients which is inconsistent
with both Cheung et al. (2008) and Höglund et al. (2004) and might
therefore be considered less plausible than the HMM-Mix results.
The resulting clusters for the 106 patients predicted by WKM and
HMM-Mix are included in the Supplemental Material.

4.3 DLBCL data
Figure 5 shows the results of applying WKM and HMM-Mix to
the 92 patients in the DLBCL cohort. We see that HMM-Mix is
achieving the desired effect of focusing on putative driver or highly
recurrent within-group alterations, while ignoring non-recurrent
passenger alterations, thus clearly separating signal from noise.

i36

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i36

i30–i38

Model-based clustering of array CGH data

(2008) will be investigated for extension to the clustering setting
using the HMM-Mix framework introduced here. Compared to the
BAC arrays used in this study, genotyping array probes are much
less uniformly distributed across the chromosome. Thus, location-
speciﬁc transition matrices with distance-based priors as suggested
by Colella et al. (2007) will be a necessary feature of this work. (Note
that most likely owing to the fact that the platform used to generate
the data in this study has relatively uniformly distributed probes, we
found that non-stationary transition matrices made no difference to
our results.) In addition, we will be applying the model to a large
cohort of breast tumors for which we have generated Affymetrix
SNP 6.0 data with the goal of uncovering novel molecular subtypes.
Note that the CNAs in lymphoma entities we studied as part of this
article can be dominated by chromosome arm or whole chromosome
events. Application to breast cancer will allow us to assess how well
the model generalizes to cancers that have much more complex
genomes.

Finally, we are investigating the use of variational methods Bishop
(2006) for inference that will at once obviate the need to hard assign
each patient to a group and preserve the computational efﬁciency
of the inference algorithm. We expect this extension to provide
full posterior distributions over the quantities of interest thus better
modeling the uncertainty of these estimates. In addition, we are
investigating approaches to model selection to avoid having to
choose the number of groups at run time.

Funding: Michael Smith Foundation for Health Research (to S.P.S.).
KPM wishes to acknowledge support from an NSERC Discovery
Grant and from CIFAR. N.A.J. is a research fellow of the Terry Fox
Foundation through an award from the National Cancer Institute
of Canada (019005) and the Michael Smith Foundation for Health
Research (ST-PDF-01793). This project was funded by NCIC grants
#016003 and #019001 and Genome Canada.

Conﬂict of Interest: none declared.

REFERENCES
Aguirre,A.J. et al.

(2004) High-resolution characterization of

the pancreatic

adenocarcinoma genome. Proc. Natl Acad. Sci. USA, 101, 9067–9072.

Archambeau,C. (2005) Probabilistic models in noisy environments – and their
application to a visual prosthesis for the blind. PhD Thesis, Universit catholique
de Louvain.

Bea,S. et al. (2005) Diffuse large b-cell lymphoma subgroups have distinct genetic
proﬁles that inﬂuence tumor biology and improve gene-expression-based survival
prediction. Blood, 106, 3183–3190.

Besag,J. (1986) On the statistical analysis of dirty pictures. J. R. Stat. Soc. Ser. B, 48,

259–302.

Bishop,C.M. (2006) Pattern Recognition and Machine Learning. Springer, New York,

NY.

Brown,M.P. et al. (1993) Using Dirichlet mixture priors to derive Hidden Markov
models for protein families. Proceedings of the 1st International Conference on
Intelligent Systems for Molecular Biology, AAAI, pp. 47–55.

Cheung,K.J. et al. (2008) Genome-wide proﬁling of follicular lymphoma by array
comparative genomic hybridization reveals prognostically signiﬁcant DNA copy
number imbalances. Blood, 113, 137–148.

Chin,L. and Gray,J. (2008) Translating insights from the cancer genome into clinical

practice. Nature, 242, 553–563.

Chin,S.F. et al. (2007) High-resolution aCGH and expression proﬁling identiﬁes a novel

genomic subtype of ER negative breast cancer. Genome Biol., 8, R215.

Colella,S. et al. (2007) QuantiSNP: an objective Bayes Hidden-Markov Model to detect
and accurately map copy number variation using SNP genotyping data. Nucleic
Acids Res., 35, 2013–2025

i37

Fig. 5. Clustering of 92 DLBCL proﬁles into ﬁve groups. Comparison
between WKM initialization (A) and HMM-Mix (B) clearly shows HMM-
Mix ability to reduce noise and report only highly conserved within-group
patterns. The bottom cluster for HMM-Mix (B) shows a potentially novel
subtype with gain of chromosome +3/+18. The colors for both (A) and (B)
are as described in Figure 4.

The data fell into ﬁve distinct groups characterized by a ‘null’
group with no discernible pattern, and four groups characterized
by 1p-/+1q/+2p/+11q/15-, +7, 6q− and +3/+18. The last group is
a previously unreported pattern of alteration in DLBCL. Previous
work had identiﬁed that both changes show increased frequency
in the so-called activated B cell (ABC) subtype of DLBCL (Bea
et al., 2005), but had not recognized that these two alterations travel
together and may indeed deﬁne a unique molecular subgroup.

5 DISCUSSION AND FUTURE WORK
The HMM-Mix model presented in this article is effectively able
to discover subgroups and their deﬁning proﬁles given a set of
aCGH data derived from a patient cohort. We showed the model’s
capability of ﬁnding clinically relevant subtypes in an FL cohort
and a previously undescribed subtype in the DLBCL cohort.
We demonstrated how the joint inference procedure of inferring
copy number calls, cluster assignments and proﬁles, coupled with
adaptive feature selection, makes HMM-Mix signiﬁcantly more
accurate than partitioning and hierarchical clustering methods.
Future work will entail experimental validation and further
exploration of the +7 and 6p-/6q+ subgroups detected in the FL
cohort for prognostic signiﬁcance for TTT, and determining clinical
relevance of the DLBCL subgroups we reported.

Extension of HMM-Mix to high density SNP arrays (e.g.
Affymetrix 6.0) will be of interest, as patterns of both genotype
and copy number can be elucidated. HMM-based models for
SNP arrays introduced in Colella et al. (2007) and Scharpf et al.

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i37

i30–i38

S.P.Shah et al.

Collins,F.S. and Barker,A.D. (2007) Mapping the cancer genome. Pinpointing the genes
involved in cancer will help chart a new course across the complex landscape of
human malignancies. Sci. Am., 296, 50–57.

Michels,E. et al. (2007) ArrayCGH-based classiﬁcation of neuroblastoma into genomic

subgroups. Genes Chromosomes Cancer, 46, 1098–1108.

Perou,C.M. et al. (2000) Molecular portraits of human breast tumours. Nature, 406,

de Leeuw,R.J. et al. (2004) Comprehensive whole genome array CGH proﬁling of

747–752.

mantle cell lymphoma model genomes. Hum. Mol. Genet., 13, 1827–1837.

Pinkel,D. and Albertson,D. (2005) Array comparative genomic hybridization and its

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM

applications in cancer. Nat. Genet., 37(Suppl), 11–17.

algorithm. J. R. Stat. Soci. Ser. B, 34, 1–38.

Raftery,A.E. and Dean,N. (2006) Variable selection for model-based clustering. J. Am.

Diskin,S.J. et al. (2006) STAC: A method for testing the signiﬁcance of DNA copy
number aberrations across multiple array-CGH experiments. Genome Res., 16,
1149–1158.

Stat. Assoc., 101, 168–178.

Rouveirol,C. et al. (2006) Computation of recurrent minimal genomic alterations from

array-CGH data. Bioinformatics, 22, 849–856.

Gilks,W. et al. (1996) Markov Chain Monte Carlo in Practice. Chapman & Hall,

Scharpf,R.B. et al. (2008) Hidden Markov models for the assessment of chromosomal

London.

Höglund,M. et al. (2004) Identiﬁcation of cytogenetic subgroups and karyotypic
pathways of clonal evolution in follicular lymphomas. Genes Chromosomes Cancer,
39, 195–204.

Idbaih,A. et al. (2008) BAC array CGH distinguishes mutually exclusive alterations

alterations using high-throughput SNP arrays. Ann. Appl. Stat., 2, 687–713.

Shah,S.P. et al. (2006) Integrating copy number polymorphisms into array CGH analysis

using a robust HMM. Bioinformatics, 22, 431–439.

Shah,S.P. et al. (2007) Modeling recurrent DNA copy number alterations in array CGH

data. Bioinformatics, 23, 450–458.

that deﬁne clinicogenetic subtypes of gliomas. Int. J. Cancer, 122, 1778–1786.

Sorlie,T. (2004) Molecular portraits of breast cancer: tumour subtypes as distinct disease

Ishkanian,A. et al. (2004) A tiling resolution DNA microarray with complete coverage

entities. Eur. J. Cancer, 40, 2667–2675.

of the human genome. Nat. Genet., 36, 299–303.

Tan,P.-N. et al. (2005) Introduction to Data Mining. First edn. Addison-Wesley

Johnson,N.A. et al. (2008) Deletion in chromosome 17p12 and gains in chromosome
9q33.3 by array comparative hybridization are associated with R-CHOP treatment
failure in patients with diffuse large B cell lymphoma. Blood, 111, a477.

Khalique,L. et al. (2007) Genetic intra-tumour heterogeneity in epithelial ovarian
cancer and its implications for molecular diagnosis of tumours. J. Pathol., 211,
286–295.

Klijn,C. et al. (2008) Identiﬁcation of cancer genes using a statistical framework for
multiexperiment analysis of nondiscretized array CGH data. Nucleic Acids Res., 36,
e13.

Law,M.H.C. et al. (2004) Simultaneous Feature selection and clustering using mixture

models. IEEE Trans. Pattern Anal. Mach. Intell., 26, 1154–1166.

Longman Publishing Co., Inc., Boston, MA, USA.

Tonon,G. et al. (2005) High-resolution genomic proﬁles of human lung cancer. Proc.

Natl Acad. Sci. USA, 102, 9625–9630.

van der Laan,M.J. et al. (2003) A new partitioning around medoids algorithm. J. Stat.

Comput. Simul., 73, 575–584.

van Wieringen,W.N. and van de Wiel,M.A. (2008) Nonparametric testing for DNA copy

number induced differential mRNA gene expression. Biometrics, 9 484–500.

Wright,G. et al. (2003) A gene expression-based method to diagnose clinically distinct
subgroups of diffuse large b cell lymphoma. Proc. Natl Acad. Sci. USA, 100,
9991–9996.

i38

[18:40 27/5/2009 Bioinformatics-btp205.tex]

Page: i38

i30–i38

