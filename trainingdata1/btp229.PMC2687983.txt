BIOINFORMATICS

Vol. 25 ISMB 2009, pages i231–i239
doi:10.1093/bioinformatics/btp229

Joint estimation of gene conversion rates and mean conversion
tract lengths from population SNP data
Junming Yin1, Michael I. Jordan1,2 and Yun S. Song1,2,∗
1Computer Science Division and 2Department of Statistics, University of California, Berkeley, CA, USA

ABSTRACT
Motivation: Two known types of meiotic recombination are
crossovers and gene conversions. Although they leave behind
different footprints in the genome, it is a challenging task to tease
apart their relative contributions to the observed genetic variation. In
particular, for a given population SNP dataset, the joint estimation
of the crossover rate, the gene conversion rate and the mean
conversion tract length is widely viewed as a very difﬁcult problem.
Results: In this article, we devise a likelihood-based method using
an interleaved hidden Markov model (HMM) that can jointly estimate
the aforementioned three parameters fundamental to recombination.
Our method signiﬁcantly improves upon a recently proposed method
based on a factorial HMM. We show that modeling overlapping gene
conversions is crucial for improving the joint estimation of the gene
conversion rate and the mean conversion tract length. We test the
performance of our method on simulated data. We then apply our
method to analyze real biological data from the telomere of the X
chromosome of Drosophila melanogaster, and show that the ratio of
the gene conversion rate to the crossover rate for the region may not
be nearly as high as previously claimed.
Availability: A software implementation of the algorithms discussed
in this article is available at
http://www.cs.berkeley.edu/∼yss/software.html.
Contact: yss@eecs.berkeley.edu

1 INTRODUCTION
A major evolutionary mechanism responsible for generating genetic
variation in a population is meiotic recombination, which creates
a chimeric genome from the two homologous genomes of
an individual. Two known types of meiotic recombination are
crossovers and gene conversions, which are typically modeled
as follows. Both events involve taking two equal-length parental
sequences to produce a descendant sequence of the same length.
In a crossover event, the descendant sequence consists of some
preﬁx of one of the parental sequences, followed by a sufﬁx
of the other parental sequence. In a gene conversion event, the
descendant sequence is formed by copying a short segment (called
a ‘conversion tract’) starting at a particular position in one of
the parental sequences to the same position in the other parental
sequence. Hence, the typical pattern created by gene conversion is:
a preﬁx of sequence h followed by a short internal fragment of a
sequence h
, which is then followed by a sufﬁx of the ﬁrst sequence
h. It is believed that the conversion tract typically ranges between
50 bp and 2000 bp (Hilliker et al., 1994; Jeffreys and May, 2004).

(cid:4)

∗

To whom correspondence should be addressed.

Although crossovers and gene conversions have different effects
on the evolutionary history of chromosomes and therefore leave
behind different footprints in the genome, it is a challenging task
to tease apart their relative contributions to the observed genetic
variation. For example, the methods employed in recent studies
(Crawford et al., 2004; International HapMap Consortium, 2005;
Myers et al., 2005) of recombination rate variation in the human
genome actually capture combined effects of crossovers and gene
conversions.

Studying gene conversion is important for a number of reasons,
a few of which we mention below. First, in several organisms—e.g.
humans (Frisse et al., 2001; Pritchard and Przeworski, 2001) and
Drosophila melanogaster (Langley et al., 2000)—gene conversion
has been shown to be necessary to explain the observed pattern of
linkage disequilibrium (LD), i.e. the statistical non-independence of
alleles at different loci. Second, it has been argued that ignoring
gene conversion may cause problems in association studies (Wall,
2004a) and linkage analysis (Mancera et al., 2008). Third, methods
for detecting signatures of natural selection usually require estimates
of ﬁne-scale recombination rates (see, e.g. Voight et al. 2006), and
their success may hinge on having reliable estimates of crossover and
gene conversion rates, as well as the distribution of the conversion
tract length. Lastly, gene conversion also plays an important role
in molecular evolution. Biased gene conversion is believed to be a
signiﬁcant source of biases in substitution, and variation in biased
gene conversion effects appears to be partially responsible for
variation in substitution patterns across the mammalian phylogeny
(Hwang and Green, 2004).

Gene conversion rate variation in the human genome is currently
not well understood, though a recent sperm-typing study (Jeffreys
and May, 2004) of the major histocompatibility complex region
suggests that the rate of gene conversion can be about 5–15 times
higher than that of crossover. Gene conversion has been hard to study
in populations because of the lack of ﬁne-scale data. However, the
genomic resequencing data to be produced over the next several
years will allow us to quantify the fundamental parameters of gene
conversion. Therefore, algorithmic and statistical tools to study gene
conversion are becoming increasingly more important.

Song et al. (2007) recently developed algorithms to distinguish
the role of gene conversion from crossover in the derivation
of SNP sequences in a population. Their method can produce
an explicit evolutionary history of the input sequences using
mutations and recombinations (crossovers and gene conversions),
but it cannot produce estimates of recombination parameters. The
parameters fundamental to recombination are the crossover rate,
the gene conversion rate and the mean conversion tract length—
the conversion tract length is often assumed to follow a geometric
in which case the mean
distribution (Wiuf and Hein, 2000),

 2009 The Author(s)
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i231

i231–i239

J.Yin et al.

completely speciﬁes the distribution. Joint estimation of all three
parameters is widely viewed as a very difﬁcult problem. There
currently exist several statistical methods (reviewed in Section 2)
that can jointly estimate crossover and gene conversion rates, but all
existing methods, with the only exception being the recent work of
Gay et al. (2007), cannot estimate the mean conversion tract length
at the same time.

To obtain accurate parameter estimates, it is crucial to make full
use of data, and that is exactly what Gay et al. (2007) aimed to
achieve in their work. Speciﬁcally, they constructed a likelihood-
based method by incorporating gene conversion into a popular
framework called the ‘Product of Approximate Conditionals’ (PAC),
ﬁrst proposed by Li and Stephens (2003) to estimate crossover rates
only. The work of Gay et al. marks important progress towards
developing practical tools for studying gene conversion.

The goal of this article is to improve on the work of Gay et al.
(2007) by introducing modiﬁcations to the model which we show
are crucial to make the joint estimation of all three parameters
feasible. Brieﬂy, Gay et al. disallowed overlapping gene conversions
in their model, for computational simplicity. We show that this
simpliﬁcation frequently leads to gross errors in the estimation of
the gene conversion rate and the mean conversion tract length, when
all three parameters are being estimated. In their article, Gay et al.
did not try to estimate the mean conversion tract length, but always
ﬁxed it to some reasonable value (actually, the true value in the case
of simulation study). Therefore, they did not encounter this problem
when testing their method. In this article, we devise algorithms to
incorporate overlapping gene conversions into the PAC model and
show that this modiﬁcation dramatically improves the estimation of
the gene conversion rate and the mean conversion tract length.

To test the performance of our method, we carry out a simulation
study. We then apply our method to analyze real biological data
from the telomere of the X chromosome of D.melanogaster, and
show that the ratio of the gene conversion rate to the crossover rate
for the region may not be nearly as high as it was claimed to be by
Gay et al. (2007).

2 PREVIOUS METHODS
We brieﬂy review previous work on estimating recombination
parameters. Throughout this article, the population-scaled crossover
and gene conversion rates are denoted by ρ=4Nec and γ =4Neg,
respectively, where Ne is the effective population size, c is the per-
generation probability of crossover per unit distance (kilobase in this
article) and g is the per-generation probability of initiating a gene
conversion per unit distance. The conversion tract length is assumed
to follow a geometric distribution, and λ denotes the mean of that
distribution.

several

statistical methods

2.1 An overview of previous work
for estimating gene
There exist
conversion rates from population genetic data. Padhukasahasram
et al. (2006) suggested using multiple summary statistics from SNP
data to estimate crossover and gene conversion rates jointly. This
approach makes only partial use of the information in the data.

The methods proposed by (Frisse et al., 2001), (Ptak et al., 2004)
and (Wall, 2004b) generalize the composite-likelihood approach of
(Hudson, 2001). Brieﬂy, these methods break up the dataset into

i232

smaller subsets (pairs or triplets of segregating sites), compute
the likelihoods (as functions of ρ and γ , with λ ﬁxed) for the
subsets, and then multiply those likelihoods together to form a
composite likelihood. The point estimates of ρ and γ are obtained
by maximizing the composite likelihood over a suitably chosen
ﬁnite grid. These methods do not take into account the dependence
between the smaller subsets.

Assuming that each gene conversion tract contains a single
SNP, Hellenthal (2006) incorporated gene conversion into the PAC
framework, originally proposed by (Li and Stephens, 2003) to
estimate crossover rates only. Gay et al. (2007) later generalized this
approach to allow for an arbitrary conversion tract length, and their
method can be used to estimate ρ,γ and λ jointly from SNP data.
The main advantage of these likelihood-based approaches is that
they improve the statistical efﬁciency of the estimates by utilizing
as much of the information in the data as possible. The work of Gay
et al., further detailed below, is most relevant to our own work.

2.2 The PAC model with gene conversion
The PAC model is motivated by the coalescent (Kingman, 1982)
and its generalization to include recombination (Hudson, 1983). The
main idea of the model is to relate the observed pattern of LD directly
to the underlying recombination processes.

Given a set H ={h1,...,hn} of haplotypes sampled from a

population, the probability of observing H given ρ,γ and λ can
be decomposed as

P(h1,...,hn| ρ,γ ,λ) = P(h1| ρ,γ ,λ)× P(h2| h1,ρ,γ ,λ)

×···× P(hn| h1,...,hn−1,ρ,γ ,λ).

(1)

Unfortunately, the exact conditional probabilities on the right-hand
side are unknown. Therefore, Li and Stephens (2003) proposed
using efﬁciently computable approximations ˆπ to substitute for
the exact probability distribution P, thus obtaining the following
approximation for the joint probability:

P(h1,...,hn| ρ,γ ,λ) ≈ ˆπ(h1| ρ,γ ,λ)× ˆπ(h2| h1,ρ,γ ,λ)

×···× ˆπ(hn| h1,...,hn−1,ρ,γ ,λ).

(2)

We denote the right-hand side of (2) by LPAC(ρ,γ ,λ). The goal is
to estimate ρ,γ and λ under the framework of maximum likelihood
estimation (MLE), using LPAC as a surrogate function for the
original intractable likelihood function (1).

By exchangeability, the value of the right-hand side of (1) is
invariant under a permutation of the haplotype indices 1,...,n.
However, because the ˆπ in (2) are not exact, the PAC likelihood
LPAC does depend on the order of haplotypes being considered. To
account for this lack of exchangeability, Li and Stephens (2003)
suggested averaging the PAC likelihood over several (say, between
10 and 20) random permutations of the input haplotypes.
is
constructed by assuming that haplotype hk+1 is an imperfect
mosaic of the ﬁrst k haplotypes. That is, hk+1 is obtained by
copying segments from h1,...,hk; a crossover or a gene conversion
can change the haplotype from which copying is performed.
Furthermore, copying can be imperfect, corresponding to mutation.
See Figure 1 for an illustration. The copying process proceeds along
the sequence from one end to the other, and it is assumed to be

ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ)

approximate

conditional

The

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i232

i231–i239

Markovian. This process can easily be modeled as a hidden Markov
model (HMM) (Rabiner, 1989).

To compute ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ), Gay et al. (2007) set up

two hidden Markov chains along the sequence. This is illustrated
in Figure 2a, in which the ‘X chain’ is for crossovers and the ‘G
chain’ is for gene conversions. The two chains evolve along the
sequence independently of each other and, therefore, the model is
a factorial HMM (Ghahramani and Jordan, 1997), satisfying the
following identity:

P(Xj+1,Gj+1| Xj,Gj)= P(Xj+1| Xj)P(Gj+1| Gj),

(3)
where the index j denotes the position along the sequence, and Xj ∈
{1,...,k} and Gj ∈{∅,1,...,k} are hidden states. The states Xj and Gj
jointly determine the index cj of the haplotype from which hk+1,j
(allele at the j-th site of hk+1) is copied: if Gj =∅ (the null state which
indicates that the j-th site is not in a gene conversion tract), then
cj = Xj; otherwise, cj = Gj. To capture the imperfect nature of the
copying process resulting from mutation, the emission probability

h1
h2
h3

h4

a

b

c

Fig. 1. Illustration of the imperfect copying process with crossovers and gene
conversions [adapted from Fig. 2 of Li and Stephens (2003)]. Haplotype h4
is created as a mosaic of fragments copied from haplotypes h1,h2,h3. The
shading shows from which haplotype each fragment is copied. The copying
process is assumed to be Markovian along the sequence. Moving from left
to right, there is a crossover event between h1 and h2 with a breakpoint at
position ‘a’. Then, there is a gene conversion event between h2 and h3, with
a conversion tract between positions ‘b’ and ‘c’. Filled and unﬁlled circles
represent different alleles. The second and the last circles in h4 result from
imperfect copying.

(a)

Crossover

Xj

Gj

Xj+1

Gj+1

Crossovers and gene conversions

of the HMM is set up as follows:

P(hk+1,j | Xj,Gj)=

⎧⎪⎪⎪⎨
⎪⎪⎪⎩

θ

2(kL+θ)
2kL+θ
2(kL+θ)

, if hk+1,j (cid:8)= hcj,j,
, if hk+1,j = hcj,j,

(4)

where L is the number of polymorphic sites in the input data (i.e. the
length of each haplotype) and θ/L is the rate of mutation per site.
If θ is not speciﬁed, it is estimated by using Watterson’s unbiased
estimator (Watterson, 1975):

⎞
⎠−1

⎛
⎝ n−1(cid:8)
m=1

1
m

ˆθ = L

.

(5)

As in the original PAC model of Li and Stephens (2003), crossover
is modeled as a Poisson process with rate ρ across the sequence.
The transition probability of the X chain has only two distinct cases,
depending on whether the hidden states of adjacent sites are the
same or not:

(cid:11)

(cid:12)

⎧⎪⎪⎪⎨
⎪⎪⎪⎩

e

1−e
(cid:12)

− ρdj
(cid:11)

k + 1
k
− ρdj
1−e

k

− ρdj

k

, if Xj = Xj+1,

P(Xj+1| Xj)=

(6)

,

1
k

if Xj (cid:8)= Xj+1,
where dj is the physical distance between sites j−1 and j.
The transition probability of the G chain is more complicated.
By assuming that the conversion tract length follows a geometric
distribution, both initiation and termination of a conversion tract
are modeled as Poisson processes along the sequence, with rates
γ and 1/λ, respectively. Gay et al. used λ (not 1/λ) to denote the
termination rate and assumed that the termination process goes on all
the time, even when the copying process is not in a gene conversion
state. Further, they make an additional assumption that conversion
tracts from different gene conversion events cannot overlap. For
example, consider the following probability of moving from state

(b)

Crossover

Xj

Xj+1

Gene-conversion

Gene-conversion

Emission

Emission

hk+1, j

hk+1, j+1

dj

Gj

Gj+1

hk+1, j

hk+1, j+1

dj

Fig. 2. Two different versions of HMM for computing the conditional probability ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ). Unshaded circles represent hidden variables,
whereas shaded ones correspond to observed variables. The symbols dj denotes the physical distance between sites j and j+1. In addition to a coupling of
the two hidden chains, we allow pairwise overlaps of gene conversions. (a) A factorial HMM in which the two hidden chains are independent of each other.
(Gay et al., 2007) used this model. (b) An interleaved HMM with coupled hidden chains.

i233

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i233

i231–i239

J.Yin et al.

g∈{1,...,k} to state g
P(Gj+1= g

(cid:4)∈{1,...,k}, where g(cid:8)= g
(cid:4)
:
(1−e
(cid:4)| Gj = g)=

(cid:13)

dj

e

−x/λ
λ

0

−γ x/k)
k

dx.

(7)

(cid:4)

This formulation requires terminating the gene conversion tract from
. The integrand corresponds to
g before initiating a new one from g
the probability of there being at least one gene conversion event
after the last termination event at distance x to the left of site j+1.
In general, Gay et al.’s formulation implicitly allows for an inﬁnite
number of gene conversion initiation events to occur before the last
termination event.

Lastly, the initial probability of the G chain depends on how the
rate of starting a gene conversion tract compares to the rate of the
ending one, i.e.

P(G1= g)=

⎧⎪⎪⎨
⎪⎪⎩

1/λ

,

1/λ+γ /k
γ /k
k(1/λ+γ /k)

if g=∅,
, if g(cid:8)=∅.

In the above HMM formulation, it is straightforward to compute

the conditional probability ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ) by using the

standard forward–backward algorithm.

3 OUR MODEL
As described above, the work of Gay et al. (2007) assumes that
crossovers and gene conversions are independent, and that gene
conversion tracts cannot overlap. In this section, we construct a new
model that couples the crossover and gene conversion processes. We
then describe how overlapping gene conversions can be incorporated
into the model.

Interleaved HMM

3.1
By assuming independence of the two hidden chains, the factorial
HMM formulation of (Gay et al., 2007) cannot model the typical
alternating pattern of gene conversion; i.e. a preﬁx of haplotype

(cid:4)

h followed by an internal fragment of a haplotype h
, which is
then followed by a sufﬁx of the ﬁrst haplotype h. To remedy this,
we couple the two hidden chains by using an interleaved HMM,
illustrated in Figure 2b. Direct edges from the G chain to the X
chain constrain the X chain to stay in its previous state whenever
the G chain is ‘active’. More precisely,

P(Xj+1| Xj,Gj+1)=

⎧⎨
⎩ I(Xj+1= Xj), if Gj+1(cid:8)=∅,
P(Xj+1| Xj), if Gj+1=∅,

(8)

where P(Xj+1| Xj) in the second line is the same as in (6). If site
j+1 is in a conversion tract (i.e. Gj+1(cid:8)=∅), the G chain is ‘active’
chain (i.e. Xj+1= Xj). If Gj+1=∅, the X chain evolves according to
the usual transition probability P(Xj+1| Xj).

and the copying process keeps track of the previous state of the X

We point out that coupling the two hidden chains does not
increase the complexity of the forward–backward computation.
Even in the factorial HMM,
the two hidden chains become
dependent upon conditioning on the observed variables. Therefore,
the computational complexity is the same for both HMMs.

3.2 Modeling overlapping gene conversions
The key new feature of our model is that it allows for overlapping
gene conversion events in the copying process. This means that the
copying process does not need to terminate a gene conversion event
before initiating another gene conversion event.

Figure 3 shows two examples of genealogies that can generate
overlapping gene conversion tracts in the coalescent model with
gene conversion (Wiuf and Hein, 2000). In Figure 3a, two gene
conversion events have conversion tracts that overlap partially, while
in Figure 3b, one conversion tract is entirely nested inside the other
conversion tract.

Motivated by the common belief that the conversion tract length
is typically short, between 50 bp and 2000 bp (Hilliker et al., 1994;
Jeffreys and May, 2004), we restrict each overlap to involve only
a pair of gene conversion events, although a generalization to more

Fig. 3. Genealogical interpretations of overlapping gene conversions. Each genealogy contains two gene conversion events. Thin horizontal lines represent
genetic material non-ancestral to the present-day sample, whereas thick horizontal lines correspond to ancestral material. Short vertical lines mark the
boundaries of gene conversion tracts. (a) Two gene conversion tracts partially overlap. The left part of the blue conversion tract is non-ancestral because it
is overwritten by the red conversion tract from a more recent gene conversion event. The ‘active’ haplotype in the region of overlapping gene conversion is
g. (b) One conversion tract is completely nested inside the other conversion tract. The blue conversion tract overwrites the middle part of the red conversion
tract. The ‘active’ haplotype in the region of overlap is g

(cid:4)

.

i234

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i234

i231–i239

(cid:4)

(cid:4)

)| g,g

than two gene conversion events can easily be achieved at the
expense of more computation time. In terms of the underlying
HMM, we augment the state space of the G chain as follows.
When computing ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ), we include ordered
(cid:4)=1,...,k} in the state space of the G chain, in
pairs {(g,g
addition to the singlet states {g| g=∅,1,...,k} considered in Gay
et al.’s model. If Gj =(g,g
), then site j of haplotype hk+1 is
within a region of overlapping gene conversion events involving
two haplotypes hg and hg(cid:4). The second entry g
in a doublet state
(g,g
) is said to be ‘active’ and it indicates that the conversion tract
from hg(cid:4) overwrites the conversion tract from hg at marker j of
hk+1. In Figure 3a, g is active in the region of overlapping gene
conversions, while in Figure 3b g
is active in the region of overlap.
As in Gay et al.’s model, the hidden states Xj ∈{1,...,k} and Gj
jointly determine the index cj of the haplotype from which hk+1,j
is copied. In our model,

(cid:4)

(cid:4)

(cid:4)

⎧⎨
⎩ Xj,
g,
(cid:4),
g

cj =

if Gj =∅,
if Gj = g(cid:8)=∅,
(cid:4)
if Gj =(g,g
).

We use the same emission probability as that shown in (4).

(cid:4)

3.3 Transition probabilities for the augmented G chain
(cid:4)| Gj =
We now describe the transition probabilities P(Gj+1= s
ˆπ(hk+1|
s) for the augmented G chain in the computation of
h1,...,hk ,ρ,γ ,λ). Instead of using the formulation described in
(7), which implicitly allows for inﬁnitely many gene conversion
events between two adjacent sites, we explicitly enumerate all
possible ‘valid’ paths of events deﬁned to satisfy the following two
(cid:4)
properties: (i) each ‘valid’ path starts in state s and ends in state s
,
and (ii) contains at most a initiations and b terminations of gene
conversions. In our implementation, we use a= b=1 for simplicity,
but it is straightforward to consider larger values of a and b without
increasing the asymptotic complexity of the forward–backward
algorithm in our HMM.
For a= b=1, the path (g,g
) is valid, since it
contains exactly one initiation event and one termination event. In
contrast, the path g→∅→ g
) is not valid since it contains
two initiation events.

)→ g
(cid:4)→(g,g
(cid:4)
(cid:4)

For a given pair of states s,s
of the G chain (and for given values
of a and b), all valid paths starting in s and ending in s
can be
enumerated using dynamic programming. We use Ps,s(cid:4) to denote
the set of all such valid paths. To compute the probability P() for
a given path ∈Ps,s(cid:4), we make the following assumptions:
(cid:129) Instead of allowing the termination process to run all the time,
which Gay et al. (2007) assume, we assume that no termination
event can occur if the current state in  is the ∅ state.
(cid:129) If the current state in  is a singlet g, then an initiation event
) or
uniformly chooses g
(cid:4),g) with equal probability; the termination process has rate
(g
1/λ.

(cid:4)∈{1,...,k} and creates either (g,g

(cid:4)→(g

(cid:4),g

(cid:4)(cid:4)

(cid:4)

(cid:4)

(cid:129) If the current state in  is a doublet (g,g

), then no initiation
can occur, since we assume only pairwise overlaps of gene
conversions. The termination process has rate 2/λ, and when
(cid:4)
a termination event occurs, one makes a transition from (g,g
)
to either g or g

with equal probability.

(cid:4)

(cid:4)

Crossovers and gene conversions

With the above assumptions, P() can be computed by integrating
over all possible positions along the sequence where the events
in  can happen. In contrast, recall that Gay et al. only integrate
over the position of the last termination event. It turns out that the
main computation involves a symbolic convolution of exponential
functions, which can be easily evaluated. The transition probability
(cid:4)| Gj = s) can be obtained by adding up the probability of
P(Gj+1= s
all valid paths in Ps,s(cid:4) and then normalizing to make sure that the
outgoing probabilities sum to 1, that is,

P(Gj+1= s

(cid:4)| Gj = s)=

(cid:14)
(cid:14)
(cid:14)
∈Ps,s(cid:4) P()
∈Ps,s(cid:4) P()

s(cid:4)

.

(cid:4)

(cid:4)

As a concrete example, consider

(cid:4)∈{1,...,k} and g(cid:8)= g

the transition probability
(cid:4)| Gj = g), where g,g
. For a=
P(Gj+1= g
(cid:4)
b=1, Pg,g(cid:4) contains three valid paths, namely 1= g→∅→ g
,
(cid:4)
2= g→(g,g
. The probability of
1 is given by
P(1) =
×

and 3= g→(g
(cid:13)

)→ g
(cid:13)
(cid:15)

−(dj−x−y)/λ

(cid:4),g)→ g

dj−x

(cid:16)

(cid:16)

(cid:15)

dj

0

0

(cid:4)

dydx

e

−x/λ·e
1
λ
−γ y/k 1
·e
(cid:13)
k
(cid:11)

1
λ

dj

0

e

−γ x/k· γ
k
−γ dj/k−dj/λ

e

−γ dj/k−dj/λ

k2

k2

= λγ e

= λγ e

−γ (dj−x−y)/k
(cid:13)

dj−x

1
λ

ey/λdydx
(cid:12)

0

−1+edj/λ− dj

.

λ

The integrand corresponds to the probability of there being exactly
one termination event and exactly one initiation event, with the
termination (respectively, initiation) event occurring at distance x
(respectively, x+y) to the right of site j. Integrating over all possible
values of x and y yields the probability of 1. In a similar vein, one
can show that the probabilities P(2) and P(3) are given by
(cid:12)
−dj/λ+ dj

−γ dj/k−dj/λ

P(2)= P(3)= 1

−1+e

λγ e

(cid:11)

.

λ

2

k2

The transition probability P(Gj+1= g
P(1)+ P(2)+ P(3).
Table 1 lists the transition probabilities in the G chain of our
implementation with a= b=1. In the table, g,g
denote
distinct elements of {1,...,k}.

(cid:4)| Gj = g) is proportional to

and g

(cid:4)(cid:4)

(cid:4)

Initial probabilities of the G chain

3.4
We wish to use the stationary distribution of the transition matrix of
the G chain as the initial probability at the ﬁrst SNP site. However,
in the computation of ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ), the size of the
transition matrix is (1+k+k2)×(1+k+k2), since there are 1 null
state ∅, k singlet states (g), k degenerate doublet states (g,g) and
k2−k non-degenerate doublet states (g,g
. Finding
an eigenvector of that transition matrix could be computationally
expensive for moderate values of k. Therefore, we make the
following approximation: we collapse the transition matrix to a 4×4
matrix, whose rows and columns are indexed by ‘null’, ‘singlet’,
‘degenerate doublet’ and ‘non-degenerate doublet’. Each entry in
the collapsed matrix is obtained by summing over the corresponding

), where g(cid:8)= g

(cid:4)

(cid:4)

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i235

i231–i239

i235

J.Yin et al.

Table 1. Transition probabilities P(Gj+1= s
initiation and at most one termination of gene conversions between adjacent sites

(cid:4)| Gj = s) for the gene conversion chain in the computation of ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ), assuming at most one

State s at marker j

(cid:4)

at marker j+1

State s

∅

g

(g,g)

(cid:4)

)

(g,g

g

(cid:4)
g
∅

(g,g)

(cid:4)

)

(g,g

g

(g,g) or (g

(cid:4)

(cid:4),g

(cid:4),g)

) or (g

(cid:4)

)

(g,g

(cid:4)(cid:4)

(cid:4),g

)

(cid:4)(cid:4)

(g,g

g or g

) or (g
(cid:4)

∅

∅

g

g

g

g

g

(g,g)

(g,g)

(g,g)

(cid:4)

(cid:4)

(cid:4)

(cid:4)

)

)

)

)

(g,g

(g,g

(g,g

(g,g

Here, g,g

(cid:4)

(cid:4)(cid:4)

and g

v=(cid:21)

denote distinct elements of {1,...,k}.
(cid:22)

entries in the original transition matrix. We ﬁnd the left eigenvector
of the collapsed matrix with eigenvalue 1. Then,
, the initial probabilities of the G

v0,v1,v2,v3
(cid:4)∈{1,...,k}, where g(cid:8)= g

(cid:4)

for g,g
chain are speciﬁed as

P(G1=∅) = v0,
P(G1=(g,g)) = v2

k

,

P(G1= g) = v1
k
)) = v3
k2−k

(cid:4)

, P(G1=(g,g

.

3.5 Complexity of the algorithm
Since the augmented HMM has O(k3) states when computing
ˆπ(hk+1| h1,...,hk ,ρ,γ ,λ), a naive implementation of the forward–
backward algorithm takes O(k6L) time, where L is the number of
polymorphic sites in the input data (i.e. the length of each haplotype).
Hence, the computational complexity of the PAC likelihood LPAC
(for ﬁxed parameters ρ,γ ,λ) in our model is O(n7L), where n
is the total number of input haplotypes. However, by exploiting
the sparsity and regularity of transition probabilities, we can use
algorithmic shortcuts to reduce the complexity to O(n4L). As in
Gay et al.’s method, we use a standard derivative-free optimization
procedure to ﬁnd the maximum likelihood estimates of ρ,γ and λ
based on LPAC.

i236

(cid:19)

(cid:18)
−dj /λ+ dj
(cid:18)(cid:20)

(cid:17)
−1+e
(cid:17)
−1+edj /λ− dj

λ

λ

(k+1)
(cid:18)
+

λ

k2
−1+e

−dj /λ+ dj

(cid:17)

+

−1+edj /λ− dj

λ

(cid:18)(cid:20)

(cid:4)| Gj = s) up to normalization
(cid:18)
−dj /λ+ dj

P(Gj+1= s
−γ dj /k
−γ dj /k+ γ λe
k
−γ dj /k−dj /λ

(cid:17)

e

λ

−1+e
(−1+edj /λ)
(−1+edj /λ)
(−1+edj /λ)
−γ dj /k−dj /λ

γ λe

γ λe

γ λe

−γ dj /k−2dj /λ

−γ dj /k−2dj /λ

k2

k2

2k2

e

e

e

k2

−γ dj /k−dj /λ+ λγ e
(cid:19)(cid:17)

−γ dj /k−dj /λ

−dj /λ)

λγ e
−γ dj /k(1−e
−γ dj /k−2dj /λ+ 2γ λe
(cid:17)

−γ dj /k−2dj /λ

k2

γ λe
−γ dj /k−dj /λ(1−e
(cid:17)
−γ dj /k−2dj /λ

2e

γ λe

k2

e

−γ dj /k−2dj /λ+ γ λe
(cid:17)

−γ dj /k−2dj /λ

γ λe
−γ dj /k−dj /λ(1−e

2k2

e

−γ dj /k−2dj /λ

k2

(cid:18)

−1+edj /λ− dj

λ

(cid:17)
(cid:18)

λ

−1+edj /λ− dj
−dj /λ)
(cid:18)
−1+edj /λ− dj
(cid:17)
−γ dj /k−2dj /λ
−1+edj /λ− dj
(cid:18)

k2

λ

λ

(cid:18)

−1+edj /λ− dj
−dj /λ)

λ

4 RESULTS
In this section, we summarize the performance of our method
on simulated data and then consider a real biological application.
In both cases, we compare our method with GenCo, the method
developed by Gay et al. (2007).

4.1 Simulation study
To test the performance of our method, we used Hudson’s (2002)
coalescent simulation program MS to generate simulated datasets.
In general, it is possible that the evolutionary history of a particular
region R in a genome involves gene conversions with one end of the
conversion tract falling outside R and the other end falling within
R. To account for such events, we simulated a 30 kb region and then
discarded 5 kb from each end. In all simulations, we used θ =1.0/kb
for mutation rate and λ=0.5 kb for the mean conversion tract length,
both of which being relevant to humans [see Ptak et al. (2004) and
Frisse et al. (2001), respectively]. For each dataset, both GenCo and
our method were each run 10 times, taking 20 random permutations
of haplotype order in each iteration. The same permutations were
used in the two methods. In the ﬁrst iteration, both GenCo and our
method started the optimization procedure at the true values of ρ,γ

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i236

i231–i239

Crossovers and gene conversions

Table 2. Comparison of our method with GenCo on simulated data

ρ

γ

λ

Method

ˆρ

ˆγ

ˆλ

#( ˆρ;2)

#( ˆγ;2)

#(ˆλ;2)

#( ˆρ;10)

#( ˆγ;10)

#(ˆλ;10)

0.5

0.5

0.5

0.5

1.0

0.5

0.5

2.5

0.5

1.0

0.5

0.5

1.0

1.0

0.5

1.0

2.5

0.5

GenCo
Ours

GenCo
Ours

GenCo
Ours

GenCo
Ours

GenCo
Ours

GenCo
Ours

0.51 (0.43)
0.48 (0.27)

0.48 (0.47)
0.46 (0.23)

0.59 (0.62)
0.59 (0.27)

0.84 (0.43)
0.79 (0.26)

0.79 (0.40)
0.81 (0.35)

0.93 (1.30)
0.85 (0.35)

3700 (23000)
1.7 (1.6)

670 (4000)
2.0 (1.7)

66 (560)
2.3 (1.2)

380 (1200)
1.8 (2.6)

230 (820)
1.8 (1.5)

370 (2100)
2.6 (1.5)

1.4 (9.0)
0.50 (0.29)

0.56 (0.79)
0.49 (0.29)

1.1 (4.1)
0.45 (0.15)

1.1 (3.5)
0.51 (0.30)

0.91 (2.01)
0.51 (0.25)

1.3 (6.4)
0.44 (0.18)

66
75

76
78

81
83

78
84

77
86

71
80

29
37

47
59

78
83

17
31

55
71

71
86

26
83

45
80

75
93

27
82

49
85

60
85

98
99

98
99

98
100

98
99

99
100

98
100

64
96

79
98

96
100

61
96

79
99

88
100

62
100

78
100

94
100

57
98

76
100

85
100

The estimates of ρ and γ are per kilobase. For each triplet (ρ,γ ,λ), we generated 100 simulated datasets using MS (Hudson, 2002) for θ =1.0/kb and 20 haplotypes. Shown in the
columns labeled ˆρ, ˆγ and ˆλ are the mean and SD (shown in parentheses) of the corresponding parameter estimates. The symbol #( ˆρ;k) denotes the number of data sets with an
estimate ˆρ within a factor of k from the true ρ. The symbols #( ˆγ;k) and #(ˆλ;k) are similarly deﬁned for γ and λ, respectively.

and λ, while in the subsequent iterations, the maximum likelihood
estimates from the previous iteration were used as initial values.
For the crossover rate, we used ρ=0.5 or 1.0/kb, while for
the gene conversion rate, we used γ =0.5,1.0 or 2.5/kb. For each
parameter setting, we generated 100 simulated datasets each with
20 haplotypes. For each simulated dataset, we estimated all three
parameters ρ,γ and λ, while θ was set to Watterson’s estimate (5).
Shown in Table 2 is a summary of performance results. The columns
labeled ˆρ, ˆγ and ˆλ display the mean and SD (shown in parentheses)
of the corresponding estimates. The column labeled #( ˆρ;k) shows
the number of datasets with crossover estimates ˆρ within a factor
of k from the true ρ; and the columns labeled #( ˆγ;k) and #(ˆλ;k)

are similarly deﬁned for gene conversion rate γ and the mean tract
length λ, respectively.

4.1.1 Estimation of ρ Both our method and GenCo produced
reasonable estimates of ρ. The two estimates had similar means, but
our estimate generally had a smaller variance than that of GenCo.

4.1.2 Estimation of γ Our improvement over GenCo is clearly
illustrated in the estimation of γ . GenCo’s estimate of γ was
substantially biased upward, with means above the true γ by factors
of tens to thousands. In most cases, this signiﬁcant bias was not
a result of only a few outliers; as the column labeled #( ˆγ;10) in
Table 2 and the histogram in Figure 4a show, GenCo produced very
large estimates of γ for a signiﬁcant fraction of simulated datasets.
In contrast, as Table 2 and the histogram in Figure 4b indicate, our
estimate of γ was much more well behaved for all parameter settings,
though it was slightly biased upward for γ =0.5 and 1.0/kb.

4.1.3 Estimation of λ GenCo’s estimate of λ was slighted biased
upward. This upward bias occurred even though many estimates
were well below the true value λ=0.5 kb, as shown in the histogram
in Figure 4c. In GenCo, a very large ˆγ was usually accompanied
by a very small ˆλ. In comparison, as Table 2 and the histogram
in Figure 4d show, our estimate of λ is much more accurate, with a
smaller variance. However, as the cases with γ =2.5/kb suggest, our

(a)

y
c
n
e
u
q
e
r
F

(c)

y
c
n
e
u
q
e
r
F

0
7

0
5

0
3

0
1

0

0
8

0
6

0
4

0
2

0

GenCo

(b)

Our method

0
7

0
5

0
3

0
1

0

−4

−2

0

log10(γ^/γ)

2

4

−4

−2

0

log10(γ^/γ)

2

4

(d)

0
8

0
6

0
4

0
2

0

−4

0

−2
log10(λ^/λ)

2

4

−4

0

−2
log10(λ^/λ)

2

4

Fig. 4. Histogram of gene conversion rate estimates ˆγ and mean conversion
tract length estimates ˆλ relative to their true values. Based on 100 simulations
with n=20,ρ= γ =1.0/kb and λ=0.5 kb.

estimate of the mean tract length λ seems slightly biased downward
when γ is large.

4.2 A real biological application
Gay et al. (2007) used their method to study recombination patterns
in two genes—namely, su(s) and su(wa) surveyed by Langley

i237

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i237

i231–i239

J.Yin et al.

Table 3. Estimates of ρ and γ for
D.melanogaster, with λ held ﬁxed at 0.352 kb

the su(s) and su(wa)

loci

in

Gene

su(s)

su(wa)

Method

GenCo
Ours
GenCo
Ours

ˆρ

1.7
3.9
0.57
9.4

ˆγ

12
5.1
28
7.1

ˆγ / ˆρ

7.1
1.3
48
0.76

The estimates of ρ and γ are per kilobase.

which tend to produce small estimates of λ when estimates of γ are
large.

As discussed in Section 4.1, both GenCo and our method tend to
overestimate γ (GenCo more so than our method), but the fact that
both methods detected strong signals of gene conversion suggests
that gene conversion is likely to have played an important role in
shaping the observed pattern of genetic variation in the two genes.
This agrees with Langley et al.’s conclusion. However, unlike what
Gay et al. (2007) concluded, our analysis implies that crossover may
not have been greatly suppressed in the su(s) and su(wa) loci.

Table 4. Estimates of ρ, γ and λ for the su(s) and su(wa) loci
D.melanogaster

in

Gene

su(s)

su(wa)

Method

GenCo
Ours
GenCo
Ours

ˆρ

0.78
4.7
9.9
9.4

ˆγ

10
11
270
96

ˆγ / ˆρ

13
2
27
10

ˆλ

0.55
0.13
0.004
0.015

The estimates of ρ and γ are per kilobase, while the estimate of λ is in kilobase.

et al. (2000)—located near the telomere of the X chromosome of
D.melanogaster. The su(s) and su(wa) loci are about 4.1 kb and
2.5 kb long, respectively, and are about 400 kb apart. Langley et al.
(2000) surveyed samples from both an African and an European
population, but only the African sample was considered by Gay
et al., and we do the same here. The su(s) dataset contains 50
haplotypes and 41 SNPs, while the su(wa) dataset contains 50
haplotypes and 46 SNPs.
Gay et al. reported that, upon ﬁxing the mean tract length to
0.352 kb (Hilliker et al., 1994), they obtained ˆρ=0.067/kb and ˆγ =
26.9/kb, thus concluding ˆγ / ˆρ=432. In their paper, Gay et al. did not
specify whether the above estimates were for the su(s) locus or the
su(wa) locus. To compare their method GenCo with our method, we
redid the analysis, following the same procedure as in Section 4.1,
i.e. taking 20 random permutations of haplotype order and iterating
the computation 10 times. We used ρ=1.0/kb and γ =1.0/kb as the
starting values of the optimization procedure in the ﬁrst iteration.
The results, summarized in Table 3, are quite different between the
two methods. Assuming λ=0.352 kb, GenCo suggests that the gene
conversion rate is substantially higher than the crossover rate in each
gene, while our method implies that the two rates are comparable.
We also performed analysis with λ as a free parameter; Gay et al.
(2007) did not consider this analysis in their paper. In this case,
we used ρ=5.0/kb,γ =5.0/kb, and λ=0.352 kb as the starting
values of the optimization procedure in the ﬁrst iteration. GenCo
and our method again produced generally different results. The
corresponding maximum likelihood estimates of ρ,γ and λ are
shown in Table 4. For the su(s) locus, GenCo and our method
produced similar estimates of γ , but GenCo produced a much
smaller estimate of ρ than that of our method, while the opposite is

true for ˆλ. For the su(wa) locus, GenCo and our method produced

similar estimates of ρ, but GenCo produced a much larger estimate
of γ than that of our method, though both methods produced a value
of ˆγ that was substantially larger than ˆρ. The estimates of λ in both
methods were quite small; this could be an artifact of the methods,

i238

5 DISCUSSION
High-throughput sequencing technology has advanced remarkably
in the past few years (Bentley, 2006), and soon it will become routine
to obtain whole-genome sequence information. Such ﬁne-scale data
from populations will allow us to quantify fundamental population
genetics parameters with high accuracy. In particular, it will soon
be possible to provide a genomic annotation of gene conversion
rates and characterize the distribution of conversion tract lengths.
Hence, improved algorithms and statistical tools for studying gene
conversion are much in need.

In this article, we have developed a model that allows overlapping
gene conversions. We believe that this aspect of our model is crucial
in making the joint estimation of the gene conversion rate and the
mean conversion tract length feasible. Although the joint estimation
of the three parameters ρ,γ and λ is indeed a very difﬁcult problem,
and the method proposed here is unlikely to be optimal, we believe
that we have taken an important step towards devising a robust,
reliable method.

Our current method can be improved in several ways. When the
gene conversion rate γ is high, our method tends to underestimate
the conversion tract length λ slightly. On the other hand, when γ is
small, our method tends to overestimate γ slightly. We believe that
both biases can be corrected by considering larger threshold values
(a and b) on the maximum number of allowed gene conversion
initiation and termination events. We will explore this improvement
in the future. Other important future directions include handling
missing data and variable rates across the sequence.

The PAC model proposed by Li and Stephens (2003) is a
useful framework with many applications. Hellenthal et al. (2008)
recently proposed using a PAC-based copying model to infer human
colonization history. Clearly, the accuracy of that inference method
can beneﬁt from having a more realistic copying model, as that
proposed here.

ACKNOWLEDGEMENTS
We thank Jo Gay for making her source code available to us and
Charles H. Langley for providing us with the su(s) and su(wa) data.

Funding: Department of Energy (BER KP110201 to M.I.J. in part);
National Institutes of Health (R01-GM071749 to M.I.J. and R00-
GM080099 to Y.S.S. in part); an Alfred P. Sloan Research Fellowship
(to Y.S.S. in part); Packard Fellowship for Science and Engineering
(to Y.S.S. in part).

Conﬂict of Interest: none declared.

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i238

i231–i239

REFERENCES
Bentley,D.R. (2006) Whole-genome re-sequencing. Curr. Opin. Genet. Dev., 16,

545–552.

Crawford,D.C. et al.

(2004) Evidence for substantial ﬁne-scale variation in

recombination rates across the human genome. Nat. Genet., 36, 700–706.

Frisse,L. et al. (2001) Gene conversion and different population histories may explain
the contrast between polymorphism and linkage disequilibrium levels. Am. J. Hum.
Genet., 69, 831–843.

Gay,J.C. et al. (2007) Estimating meiotic gene conversion rates from population genetic

data. Genetics, 177, 881–894.

Ghahramani,Z. and Jordan,M.I. (1997) Factorial hidden Markov models. Mach. Learn.,

29, 245–273.

Hellenthal,G. (2006) Exploring Rates and Patterns of Variability in Gene Conversion and
Crossover in the Human Genome. PhD Thesis, University of Washington, Seattle.
Hellenthal,G. et al. (2008) Inferring human colonization history using a copying model.

PLoS Genet., 4, e1000078.

Hilliker,A.J. et al. (1994) Meiotic gene conversion tract length distribution within the

rosy locus of Drosophila melanogaster. Genetics, 137, 1019–1026.

Hudson,R.R. (1983) Properties of a neutral allele model with intragenic recombination.

Theor. Popul. Biol., 23, 183–201.

Hudson,R.R. (2001) Two-locus sampling distributions and their application. Genetics,

159, 1805–1817.

Hudson,R.R. (2002) Generating samples under the Wright-Fisher neutral model of

genetic variation. Bioinformatics, 18, 337–338.

Hwang,D.G. and Green,P. (2004) Bayesian Markov chain Monte Carlo sequence
analysis reveals varying neutral substitution patterns in mammalian evolution. Proc.
Natl Acad. Sci. USA, 101, 13994–14001.

Crossovers and gene conversions

Langley,C.H. et al. (2000) Linkage disequilibria and the site frequency spectra in the
su(s) and su(wa) regions of the Drosophila melanogaster X chromosome. Genetics,
156, 1837–1852.

Li,N. and Stephens,M. (2003) Modeling linkage disequilibrium and identifying
recombination hotspots using single-nucleotide polymorphism data. Genetics, 165,
2213–2233.

Mancera,E. et al. (2008) High-resolution mapping of meiotic crossovers and non-

crossovers in yeast. Nature, 454, 479–485.

Myers,S. et al. (2005) A ﬁne-scale map of recombination rates and hotspots across the

human genome. Science, 310, 321–324.

Padhukasahasram,B.

from
single-nucleotide polymorphisms using summary statistics. Genetics, 174,
1517–1528.

(2006) Estimating

recombination

rates

al.

et

Pritchard,J.K. and Przeworski,M. (2001) Linkage disequilibrium in humans: models

and data. Am. J. Hum. Genet., 69, 1–14.

Ptak,S.E. et al.

(2004)

Insights into recombination from patterns of

linkage

disequilibrium in humans. Genetics, 167, 387–397.

Rabiner,L. (1989) A tutorial on HMM and selected applications in speech recognition.

Proc. IEEE, 77, 257–286.

Song,Y.S. et al. (2007) Algorithms to distinguish the role of gene-conversion from
single-crossover recombination in the derivation of SNP sequences in populations.
J. Comput. Biol., 14, 1273–1286.

Voight,B.F. et al. (2006) A map of recent positive selection in the human genome. PLoS

Biol., 4, e72.

Wall,J.D.

(2004a) Close look at gene conversion hot spots. Nat. Genet., 36,

114–115.

Wall,J.D. (2004b) Estimating recombination rates using three-site likelihoods. Genetics,

167, 1461–1473.

International HapMap Consortium (2005) A haplotype map of the human genome.

Watterson,G. (1975) On the number of segregation sites. Theor. Popul. Biol., 7,

Nature, 437, 1299–1320.

256–276.

Jeffreys,A.J. and May,C.A. (2004) Intense and highly localized gene conversion activity

Wiuf,C. and Hein,J. (2000) The coalescent with gene conversion. Genetics, 155,

in human meiotic crossover hot spots. Nat. Genet., 36, 151–156.

Kingman,J.F.C. (1982) The coalescent. Stoch. Process. Appl., 13, 235–248.

451–462.

[10:13 15/5/2009 Bioinformatics-btp229.tex]

Page: i239

i231–i239

i239

