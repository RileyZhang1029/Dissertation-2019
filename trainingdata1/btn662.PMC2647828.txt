BIOINFORMATICS ORIGINAL PAPER Vol. 25 no. 5 2009, pages 643–649

doi:10.1093/bioinformatics/btn662

Data and text mining
Biomarker discovery in MALDI-TOF serum protein proﬁles using
discrete wavelet transformation
Theodore Alexandrov1,∗, Jens Decker2, Bart Mertens3, Andre M. Deelder4,
Rob A. E. M. Tollenaar5, Peter Maass1 and Herbert Thiele2
1Center for Industrial Mathematics, University of Bremen, D-28334 Bremen, 2Bruker Daltonik GmbH, D-28359
Bremen, Germany, 3Department of Medical Statistics and Bioinformatics, Leiden University Medical Center (LUMC),
2300 RC Leiden, The Netherlands, 4Department of Parasitology and 5Department of Surgery, Leiden University
Medical Center, 2300 RC Leiden, The Netherlands
Received on July 01, 2008; revised on December 22, 2008; accepted on December 23, 2008

Associate Editor: Burkhard Rost

the results.

ABSTRACT
Motivation: Automatic classiﬁcation of high-resolution mass
spectrometry proteomic data has increasing potential
in the early
diagnosis of cancer. We propose a new procedure of biomarker
discovery in serum protein proﬁles based on: (i) discrete wavelet
transformation of the spectra; (ii) selection of discriminative wavelet
coefﬁcients by a statistical test and (iii) building and evaluating
a support vector machine classiﬁer by double cross-validation
with attention to the generalizability of
In addition
to the evaluation results (total recognition rate, sensitivity and
speciﬁcity), the procedure provides the biomarker patterns, i.e. the
parts of spectra which discriminate cancer and control individuals.
The evaluation was performed on matrix-assisted laser desorption
ionization time-of-ﬂight (MALDI-TOF) serum protein proﬁles of 66
colorectal cancer patients and 50 controls.
Results: Our procedure provided a high recognition rate (97.3%),
sensitivity (98.4%) and speciﬁcity (95.8%). The extracted biomarker
patterns mostly represent the peaks expressing mean differences
between the cancer and control spectra. However, we showed that
the discriminative power of a peak is not simply expressed by its
mean height and cannot be derived by comparison of the mean
spectra. The obtained classiﬁers have high generalization power
as measured by the number of support vectors. This prevents
overﬁtting and contributes to the reproducibility of the results, which
is required to ﬁnd biomarkers differentiating cancer patients from
healthy individuals.
Availability: The data and scripts used in this study are available at
http://www.math.uni-bremen.de/∼theodore/MALDIDWT.
Contact: theodore@math.uni-bremen.de
Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION
Colorectal cancer (CRC) is one of the most common malignancies
and remains a principal cause of cancer-related morbidity and
mortality. The early detection of cancer is essential for a successful
∗

To whom correspondence should be addressed.

treatment. Currently, the colonoscopy is used to detect early stage
lesions, but this is an invasive and relatively expensive method.
Therefore, a different method would be desirable relaying on easily
accessible body ﬂuids, like serum. A sensitive blood test might not
only detect early stage malignancies, but also premalignant lesions
(not part of this study), thereby increasing the chance of survival
considerably.

The use of mass spectrometry for searching serum biomarkers
in cancer diagnostics was suggested by Petricoin et al. (2002)
but was factually ﬂawed. Second-generation studies discovered the
importance of avoiding bias and overﬁtting as well as the need
of validation (Ransohoff, 2004). Here a procedure is presented
for biomarker extraction from matrix-assisted laser desorption
ionization time-of-ﬂight (MALDI-TOF) serum protein proﬁles
constructed with attention to generalizability of the achieved results.
Recently, de Noo et al. (2006) demonstrated the feasibility of mass
spectrometry based protein proﬁling for the discrimination of CRC
patients from healthy individuals, using quite simple classiﬁcation
methods. This motivated us to develop an advanced procedure
of biomarker extraction using the ideas proposed in Schleif
et al. (2007): (i) discrete wavelet transformation (DWT) of the
spectra, (ii) features (wavelet coefﬁcients) selection by statistical
testing and (iii) support vector machine (SVM) classiﬁcation, see
Supplementary Figure 1 for an overall scheme.

Our new procedure presented in this article goes signiﬁcantly
beyond that of Schleif et al. (2007): (i) The actual approach does
not only give a classiﬁcation of spectra, but also supports the location
and scoring of spectral features which are putative biomarkers. For
this goal, we propose additional wavelet reconstructions to visualize
the results; (ii) The classiﬁer assessment is now using a double
cross validation scheme to avoid a possible bias of the results;
(iii) The feature selection is also included within the double cross
validation to avoid potential biases of the performance estimation
and (iv) Finally, we investigated the role of the statistical testing
and compared different tests and adjustments. In addition to the
Kolmogorov–Smirnov (KS) test we also used a Mann–Whitney
(MW) test for feature selection and also applied a Benjamini–
Yekutieli (BY) multiple test adjustment to get more conﬁdence about
the inﬂuence of the feature selection techniques. Finally, we added a

 2009 The Author(s)
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

T.Alexandrov et al.

Table 1. Patient characteristics and distribution across plates

Number
Mean age (range)
Male/female ratio
Number on plate 1/2/3

Patients

64
67.2 (37–89)
35/29
25/22/17

Controls

48
52.2 (29–78)
21/27
17/16/15

50

0

−50

y
t
i
s
n
e
n

t

i

Mean spectra for the cancer and control groups

 

CANCER

CONTROL

detailed analysis of the robustness of the classiﬁcation as a function
of the number of selected features and the number of resulting
support vectors. This is helpful to estimate the generalizability of
the resulting classiﬁcation model.

Our procedure was evaluated on new publicly available datasets
obtained according to the randomized block design, which helps
to minimize impact of potential confounding factors on the
experimental side and, thus also to avoid bias.

Being aware of the problem of non-reproducibility of promising
results in high-throughput mass spectrometry (Check, 2004;
Coombes et al., 2005; Ransohoff, 2004), we assessed the general-
ization power of the constructed classiﬁers as follows.

For different types of the feature selection, the conservativeness
was investigated as considering fewer features reduces the risk of
overﬁtting. Moreover, we thoroughly analyzed the generalization
error of the classiﬁers measured as the number of support vectors
used for the classiﬁcation (Bartlett and Shawe-Taylor, 1999).

2 METHODS
2.1 Serum protein proﬁling
Serum samples were obtained from a total of 66 CRC patients one day
before surgery and 50 healthy volunteers (Table 1). All stages of disease
were present in the patient group in comparable proportions. The Tumor-
Nodes-Metastases (TNM) stages are I-IIIc according to the AJCC Cancer
Staging Manual (6th edn). Moreover, patients without invasive carcinoma
but no premalignant cases were included. Informed consent was obtained
from all patients and the Medical Ethical Committee approved the study.
Blood was collected in a 10 cc serum separator vacutainer tube and
centrifuged 30 min later at 3000 r.p.m. for 10 min. Serum samples were
distributed into 0.5 ml aliquots and stored at −70
C until the experiment. The
isolation of peptides from serum was performed using the magnetic beads
based hydrophobic interaction chromatography (MB-HIC) kit from Bruker
Daltonics (Bremen, Germany), according to the manufacturers protocol. α-
Cyano-4-hydroxycinnamic acid (0.3 g/l in ethanol:acetone 2:1) was used
as matrix. All sample preparation steps were performed on a 8-channel
Hamilton STAR pipetting robot (Hamilton, Martinsried, Germany). Using
a randomized block design, correcting for demographic and pathological
variables, all samples were spotted in quadruple on 3 plates (Table 1).
The plates were measured on three consecutive days, Tuesday to Thursday.
MALDI-TOF mass spectrometry measurements were performed using
an Ultraﬂex TOF/TOF instrument (Bruker Daltonics), equipped with
a SCOUT ion source and measured in linear mode. All unprocessed
spectra were exported in standard 8-bit ASCII format. They consisted of
approximately 65 400 mass-to-charge ratio (m/z)-values, covering a domain
of 960–11 170 Da. For more information, see de Noo et al. (2006).

◦

2.2 Low-level analysis
The data have been exported using ClinProTools (CPT) software (version
2.2, Bruker Daltonics) where we performed recalibration, top-hat baseline
correction (all with default parameters), outlier detection, and as in the
reference paper, data reduction with factor 4. We found two additional

644

−100

 

1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 11000

m/z value

Fig. 1. Mean spectra for the cancer and control group (inverted, gray
spectrum) after low-level processing.

A1

D1

An−1

An

Dn−1

Dn

bior3.7 wavelet

scaling function
for bior3.7 wavelet

Fig. 2. Scheme of calculation of APPDWT and CONVDWT coefﬁcients,
the bior3.7 wavelet and its scaling function. Ai(Di) denote approximation
(detail) coefﬁcients of the i-th level, n is the maximum level (10 in our case).
Note that An belongs to both the APPDWT and CONVDWT coefﬁcients.

outliers in the control group compared with the reference paper, but included
one more cancer spectrum in the dataset for classiﬁcation. The interpolation
of all cancer and control spectra on one grid has been done using Matlab. At
the end, we had 64 cancer and 48 control spectra of length 16 331 covering a
domain of 960–11 163 Da. The mean spectra both for the cancer and control
groups are depicted in Figure 1.

2.3 Discrete Wavelet Transformation
DWT is an important tool in signal processing, in particular for its superior
properties of denoising and compression. The central idea of DWT is to ﬁnd
a lossless multi-scale representation of data by means of wavelet coefﬁcients.
Informally speaking, each coefﬁcient represents a contribution for some scale
and position. A vast literature on DWT is available, covering both theoretical
and applied issues, see e.g. Mallat (1999). DWT has been useful for MS data
processing for many years, see a review of Leung et al. (1998) for early
references.

Given a spectrum, the DWT was applied to produce a set of wavelet
coefﬁcients which are further used for feature selection and classiﬁcation.
We evaluated two approaches of calculating wavelet coefﬁcients. First,
as usual in DWT, we computed detail coefﬁcients of each level together
with the approximation coefﬁcients of the maximum level. Second, we
considered the approximation coefﬁcients of all
instead of the
detail coefﬁcients (Figure 2). We denote these approaches CONVDWT and
APPDWT, respectively. APPDWT is better suited for biomarker visualization
and peak detection since being reconstructed, each approximation coefﬁcient
produces the scaling function (a narrow bump) but not the wavelet (an
oscillating function) obtained for a detail coefﬁcient (Figure 2). The numbers
of calculated detail/approximation DWT coefﬁcients at each level (level
number in brackets) are: 8173 (1), 4094 (2), 2054 (3), 1034 (4), 524 (5),
269 (6), 142 (7), 78 (8), 46 (9), 30 (10). This accounts for a total of 16 444
coefﬁcients.

levels,

The bi-orthogonal bior3.7 wavelet was used, because the shape of its
scaling function closely matches the peak pattern of MALDI-TOF spectra

Biomarker discovery in MALDI-TOF serum protein proﬁles using DWT

(Schleif et al., 2007). This is a favorable property of the selected wavelet,
since for such a wavelet large values of DWT coefﬁcients can be associated
with peaks and a peak is represented by only a few dominant coefﬁcients.

Using wavelet coefﬁcients for classiﬁcation has the following advantages.
First, DWT provides automatic denoising as it separates noise contribution
(generating coefﬁcients of the ﬁrst-scale levels) and signal contribution.
Even if we do not carry out the denoising explicitly, this property of DWT
helps the statistical feature selection (introduced below) to ﬁnd signiﬁcant
differences between the two classes. In case of overlapping peaks, the peak
picking process becomes complicated and it is usually required to specify
a typical a priori peak width. The DWT approach does not require such
a speciﬁcation. However, if there is information available about the m/z
range and the expected width of the peaks this can improve the performance
signiﬁcantly.

2.4 Statistical feature selection
In order to ﬁnd those wavelet coefﬁcients which differentiate between
cancer and control spectra, we used non-parametric statistical testing of
the null hypothesis Hi
that no distinction between cancer and control
groups is expressed by the i-th coefﬁcient. Only the coefﬁcients signiﬁcantly
rejecting the hypothesis are used for classiﬁcation. Note that the applied
test of difference is aimed not at extraction of peaks but at extraction
of discriminative features. The statistical testing signiﬁcantly reduces the
number of coefﬁcients.

For the statistical feature selection we evaluated the KS and MW tests
(signiﬁcance level 0.05), which are both non-parametric and distribution
free tests for assessing whether two samples of observations come from
the same distribution or not. Since we compare thousands of coefﬁcients
simultaneously, the so-called ‘multiple testing’ adjustment of p-values has
to be applied. The aim of the adjustment is to control the type I error
rate deﬁned with respect to the multiple testing approach. Among the most
popular adjustments are the Bonferroni (Bonf) and the Benjamini–Hochberg
(BH) adjustment.

Bonf is perhaps the best known adjustment procedure in multiple testing. It
strongly controls the family-wise error rate (FWER) which is the probability
of at least one false positive within the set of tests. BH strongly controls
the false discovery rate (FDR) for independent test statistics. The FDR is
the expected proportion of type I errors among the rejected hypotheses. In
addition to the Bonf and BH, we evaluated the BY adjustment which strongly
controls the FDR for an arbitrary dependence structure. We considered
BY presupposing dependence between DWT coefﬁcients. As discussed, the
shape of the chosen wavelet matches a typical peak shape quite well but is
still not perfect. Hence, a large peak commonly generates not only one large
wavelet coefﬁcient, but several ones positioned close to the peak maximum.
Under the condition of complete null hypotheses (all coefﬁcients do not
distinguish cancer and control groups) the FDR would be equivalent to
the FWER. Obviously, this is not expected. In this case, the procedures
controlling FWER (Bonf) are more conservative than those controlling FDR
(BH, BY), because FWER-controlling procedures suppress false positives.
FDR-controlling procedures tolerate a few false positives provided that their
number is small compared to the number of all rejected hypotheses. For
further discussion on multiple testing approaches, see Dudoit et al. (2003).

2.5 SVMs
The selected discriminative DWT coefﬁcients are used as input data for
the classiﬁcation. For the classiﬁcation, we used a SVM of type C-SVM
with a gaussian kernel. SVM is a powerful and popular machine learning
technique, widely used for classiﬁcation and extensively applied in biology
(Noble, 2004). The SVM theory and algorithms are described in many papers
and books. For a short introduction to SVM from the biological viewpoint,
see Noble (2006).

The main idea of SVM is to establish a maximum margin classiﬁer. Linear
in its basic formulation, SVM classiﬁers become non-linear with respect to

Fig. 3. The i-th step of double CV used for simultaneous parameters
estimation and prediction assessment, i goes through all the given spectra.

the given data by exploiting a kernel function or, simply, a kernel. The most
often used types of kernels are linear, polynomial and the gaussian kernels.
We exploited the gaussian kernel as advised by Schleif et al. (2007) (the
linear kernel has also been used, but gave lower recognition rates, results not
shown).

The C-SVM classiﬁer we used, has a parameter C, which is a trade-off
between maximization of the classiﬁer capacity and minimization of the
number of misclassiﬁed examples. Together with the width parameter γ
of the gaussian kernel they represent the so-called SVM hyperparameters
which should be optimized for classiﬁcation. A variety of implementations
of SVM are available; we used the Bioinformatics Toolbox 2.5 of Matlab
7.4 (R2007a).

SVM was selected for classiﬁcation because of: (i) the small number
of hyperparameters and their interpretability, (ii) theoretically substantiated
good generalization properties of SVM classiﬁers, (iii) sparse nature of SVM
classiﬁers, i.e. the classiﬁer is built only on a representative part of the data.
The data vectors used (in our case each one contains the wavelet coefﬁcients
calculated for a spectrum) are called the support vectors and the other vectors
are not taken into account for classiﬁcation. A disadvantage of SVM is
the required runtime to optimize the hyperparameters. For routine classiﬁer
generation more efﬁcient alternatives than a simple grid search might be
required. The classiﬁcation of additional spectra is not a performance issue.

2.6 Double cross-validation
For the choice of SVM hyperparameters C and γ we used the double cross-
validation (CV) paradigm according to Mertens et al. (2006). Double CV is a
bias-reducing scheme of simultaneous parameters estimation and assessment
of the classiﬁer. Although double CV dates back to 1974 (Stone, 1974), this
approach is still rather new in the ﬁeld of mass spectrometry. In this ﬁeld, to
our knowledge double CV was ﬁrst introduced by Mertens et al. (2006) (see
this reference for a historical review on double CV) as well as by de Noo
et al. (2006) and these references are followed in the essential points.

The double CV scheme consists of an outer validation loop and an inner
training loop. We used leave-one-out CV for the outer loop and 5-fold CV
for the inner loop. In this setting, the i-th step of the double CV scheme
consists of two stages: (i) for the i-th element of the data the choice of
hyperparameters is done using 5-fold CV on the leftover part (with the feature
selection performed within the inner loop), then (ii) the feature selection is
done on the leftover part. Finally a classiﬁer is trained with the optimized
hyperparameters using all but the i-th spectrum. This classiﬁer is applied
for classiﬁcation of the excluded i-th spectrum. The total recognition rate
(TRR, the fraction of correctly classiﬁed spectra), sensitivity and speciﬁcity
are calculated in the outer validation loop. The scheme of the i-th step of the
double CV is shown in Figure 3.

As usual for SVM, given a train set and a test set, the hyperparameters C
and γ are optimized by grid search. The TRR is used as the minimization
criterion. At the i-th step of the outer loop, the TRR on all but the i-th
spectrum is estimated using 5-fold CV and the hyperparameters minimizing
this value are selected. Recall that the ﬁnal double CV TRR (presented in
Table 2) is calculated in the outer loop.

645

T.Alexandrov et al.

Table 2. Double CV classiﬁcation results for the detection of cancer using the proposed procedure

DWT type

Test

TRR
BH Bonf BY

Sensitivity
BH Bonf BY

Speciﬁcity
BH Bonf BY

Number of coefﬁcients
BH

Bonf BY

Mean number of SV
BH Bonf BY

APPDWT
KS
APPDWT
MW
CONVDWT KS
CONVDWT MW

96.4 96.4
96.4 97.3
95.5 95.5
94.6 94.6

96.4
97.3
96.4
96.4

96.9 98.4
96.9 98.4
96.9 96.9
95.3 96.9

98.4
96.9
96.9
96.9

95.8 93.8
95.8 95.8
93.8 93.8
93.8 91.7

93.8
95.8
95.8
95.8

6219 1545 3392
7068 1784 3920
419
603
613
438

299
303

55
56
66
81

44
43
54
61

49
52
49
55

APPDWT and CONVDWT specify the ways of wavelet coefﬁcients calculation. Column ‘Number of coefﬁcients’ contains the number of discriminative coefﬁcients selected.
Column ‘Mean number of SV’ shows mean number of support vectors describing the generalizability of the classiﬁer: a large number indicates overﬁtting.

Note that a step of the double CV with leave-one-out CV in the outer loop
and 5-fold CV in the inner loop simulates clinical diagnosis with 5-fold CV
used for training. In double CV, this step is repeated for each spectrum thus
providing the TRR and other characteristics of the considered prediction
procedure. After method evaluation, having a training dataset and a new
patient sample coming in, we (i) optimize C and γ using 5-fold CV on the
training data, (ii) select discriminative coefﬁcients of the training dataset,
(iii) apply the classiﬁer with the best parameters to the extracted features of
the new sample spectrum.

2.7 Biomarkers
Having obtained the classiﬁcation results, we are interested to interpret
the wavelet coefﬁcients used in the classiﬁcation and to identify putatitive
biomarkers. For this purpose, we calculated the parts of the spectra
represented by the selected wavelet coefﬁcients. Given the selected wavelet
coefﬁcients for each spectrum, we reconstructed the m/z ranges represented
by these coefﬁcients. Then we computed the class-discriminating m/z ranges
by averaging the resulting spectral components of all spectra within each
class. For CONVDWT coefﬁcients, the reconstruction is done using inverse
wavelet transformation. Unfortunately, an inverse wavelet transformation
is not possible for APPDWT coefﬁcients. Therefore, for each level of the
DWT we reconstructed the one-level signal from the selected approximation
coefﬁcients. From the produced one-level signals we took the maximum
value for each m/z-value.

Moreover, in order to ﬁnd the most class-discriminative features of the
spectra, we studied the parts of the spectra which correspond to a prespeciﬁed
number of the most signiﬁcant wavelet coefﬁcients, i.e. the coefﬁcients
having the lowest P-values of the statistical test.

3 RESULTS
3.1 Classiﬁcation results
The results of applying the double CV simultaneous parameters
choice and classiﬁer assessment scheme together with the introduced
wavelet-based approach are given in Table 2. The achieved TRR,
sensitivity and speciﬁcity for all tests and adjustments are higher
than those reported by de Noo et al. (2006) which are 92.6%, 95.2%
and 90.0%, respectively (even taking into account that we excluded
one additional outlier). The one cancer sample misclassiﬁed by all
the classiﬁers has late TNM stage (IIIc). Using APPDWT gave better
recognition rates than CONVDWT and the combination of MW and
Bonf (or BY) for APPDWT provided the best results (97.3% TRR).
Note that the achieved sensitivity is higher than the speciﬁcity as also
reported by de Noo et al. (2006). The runtimes (15 + 9 grid points,
112×(5 + 1) train-test runs for each grid point) on an Intel 2.66 GHz
PC were ∼9 h (KS, Bonf), 17 h (KS, BH/BY), 22 h (MW, Bonf)

646

and 30 h (MW, BH/BY). We also compared our procedure with
CPT v.2.2. Since double CV is not included in CPT yet, we used
the leave-one-out CV evaluation both in CPT and our procedure.
Moreover, the technical replicates have not been averaged (that is not
implemented in CPT) resulting in 438 spectra. Other preprocessing
steps (Section 2.2) were the same. The calculated TRR values are
98.63% produced by our procedure (APPDWT, MW, Bonf) versus,
at best, 98.46% for CPT (SVM, automatic number of peaks, KNN3).
This number is only slightly smaller than the one obtained with our
procedure and the difference can not be considered to be signiﬁcant.
However, note that the peak picking which depends on all spectra is
not included in the leave-one-out CV of CPT. The high-recognition
accuracies demonstrate the effectiveness of the classiﬁer in revealing
the difference between cancer and control spectra.

3.2 Generalization properties
As shown, our classiﬁcation procedure provides an improved
accuracy for cancer detection, and the TRR is several percent better
than those originally reported for the same data by de Noo et al.
(2006). However, the most important problem in proteomic proﬁling
today is not to gain several percent advance but to ﬁnd reproducible
biomarkers. As Ransohoff (2004) concluded, it is crucial to assess
reproducibility of results in some direct way.

Being aware of this problem, we used double CV with disjoint
datasets for optimization and validation. The whole procedure
(DWT, feature selection, classiﬁcation) is evaluated in the inner
loop of the double CV. This helps to avoid possible bias in results
and to make them reproducible. Furthermore, we investigated the
generalizability of the derived classiﬁers as follows.

First, we compared the conservativeness of the statistical test
used, in other words, the fraction of wavelet coefﬁcients which are
not rejected by the test. This question is related to the ‘overﬁtting’
problem, because in general a smaller dimension of the data used
for the classiﬁcation results in a reduced risk of overﬁtting. Table 2
shows the number of selected coefﬁcients for all the tests and
adjustments both for CONVDWT and APPDWT. Despite the same
TRR provided, MW with Bonf is better than MW with BY since the
former combination selects signiﬁcantly fewer coefﬁcients.

Investigating the conservativeness of the statistical tests is an
opportunity to study the generalization properties of the provided
classiﬁers beyond the set of
training spectra. An important
characteristic of any SVM classiﬁer is the use of only a part of
the given vectorial data, the so-called support vectors. If fewer
support vectors are used, the classiﬁer is more likely to give good
results for an extended set of samples and it is less likely be overﬁt

Biomarker discovery in MALDI-TOF serum protein proﬁles using DWT

(a)

y
t
i
s
n
e
t
n

i

Mean spectra and biomarker patterns

MW,Bonf
TRR = 97.3, sens = 98.4, spec = 95.8
mean number of support vectors = 43.4
1783.5 APPDWT coefficients used

mean spectrum, CONTROL
biomarker, CONTROL

mean spectrum, CANCER
biomarker, CANCER

(b)

y
t
i
s
n
e
t
n
i
 
f
o
 
e
c
n
e
r
e
f
f
i
d

1000 1200 1400 1600 1800 2000 2200 2400 2600 2800 3000

40

30

20

10

0
−10
−20
−30
−40
−50
−60
−70
−80

Difference in biomarker patterns (CANCER-CONTROL)
50

1867Da

1780Da

1692Da

2024Da

1619Da

1265Da

1208Da

1352Da

1467Da

1100 1200 1300 1400 1500 1600 1700 1800 1900 2000 2100

m/z value

m/z value

Fig. 4. (a) The class-discriminating parts of spectra (MW, Bonf, APPDWT) against the mean spectra (control data are shifted in intensity for better viewing)
in the interval 960–3500 Da (no discriminative peaks above 3500 Da). (b) Difference between these parts in the interval 1100–2100 Da. Positive (negative)
peaks relate to the cancer (control) spectra.

(Bartlett and Shawe-Taylor, 1999). Table 2 shows the mean number
of support spectra used in the outer loop of the double CV.

For the combination (MW, Bonf) the number of support vectors
is 43 on average, whilst the training dataset is of size 111. Therefore
the classiﬁcation procedure is able to represent the information
discriminating between cancer and control groups with one third
of the training spectra.

Also, the generalizability was estimated in the following empirical
way. In the outer loop of a double CV we classiﬁed spectra with
additional normal distributed noise that simulates classiﬁcation of
new data with models trained on the original data. The noise standard
deviation was 0.31 which is twice the real noise estimated in the
m/z-interval [1200,2400]. For the achieved classiﬁcation results see
Supplementary Table 1. Bonf-classiﬁers are more general than others
as their TRR is only slightly diminished [96.4% for (MW, Bonf)
versus 66.1% and 86.6% for (MW, BH) and (MW, BY), using
APPDWT coefﬁcients].

Finally, we investigated the stability of the feature selection
procedure using double CV. Therefore, we compared the features
extracted at each outer iteration of the double CV (Supplementary
Figure 2). Except for tiny variations, the feature extraction is very
stable. Moreover, we ran the whole classiﬁcation procedure with
the feature selection performed in advance outside of the double
CV. The provided classiﬁcation results were very similar to those
presented in Table 2 which indirectly conﬁrms the stability of the
feature selection procedure.

3.3 Biomarkers
The class-discriminating parts of the cancer and control spectra,
computed as described in Section 2.7 for the MW test and the Bonf
adjustment using APPDWT coefﬁcients are shown in Figure 4a.
Even though the scale of the wavelet coefﬁcients was not speciﬁed,
the discriminating parts consist of peaks which are all positioned in
the m/z-interval 1000–3300 Da (mostly inside 1200–2050 Da).

The fact that discriminative coefﬁcients represent peaks demon-
strates the ability of DWT to extract biologically relevant features.
In Figure 4b, the difference between the class-discriminating parts
of the spectra (cancer minus control) is presented and the eight peaks
with the largest difference are marked: 1208, 1265, 1352, 1467 Da

this

section we consider

In the remainder of

for control spectra and 1692, 1780, 1867, 2024 Da corresponding to
cancer spectra, respectively. The difference pattern is very similar to
the difference of the mean spectra and to the correlation coefﬁcients
presented by de Noo et al. (2006), Figure 3, although our pattern
is more detailed. In the results of de Noo et al. (2006), the control
peak at 1619 Da (difference in intensity −2.6) is overlooked, the
cancer peak at 1692 Da is almost unnoticeable, and the large peak
at 2024 Da is not separated from the tiny neighbor peak at 2013 Da.
the most
discriminative parts of the extracted biomarker patterns. Based
on the results of the statistical feature selection, we deﬁne the
discriminative power (the measure of difference) between cancer
and control spectra at some m/z-value through P-values as follows:
in DWT several scales are considered (we used 10 scales, the
ﬁrst represents the ﬁnest details of the spectra) and for each scale
the wavelet coefﬁcients at all possible positions (m/z-values) are
calculated. Then for each wavelet coefﬁcient (corresponding to
some position and some scale) the statistical difference between its
values for the cancer and control data is calculated by means of the
statistical test of difference. Thus, the discrimination power at some
position and on some scale is expressed by a P-value. As usual, the
smaller the P-value, the more discriminative is the position on this
scale.

Figure 5a depicts the mean spectra difference and the P-values
(using a log10-scale) calculated for the APPDWT coefﬁcients (MW,
Bonf) in the interval 1100–2460 Da. In this diagram, each cell
corresponds to a P-value and the width of the cell depends on the
scale. The cells are colored according to their P-values (log10-scale).
Darker cells indicate more discriminative wavelet coefﬁcients.
One can clearly see the correspondence between the large peaks
−10 (dark
expressing the mean spectra difference and the p<10
cells in Figure 5a), especially on the ﬁrst levels where wavelets
provide sufﬁciently ﬁne resolution. This illustrates that our statistical
feature selection does not miss the large mean difference between the
cancer and control data. Moreover, these results correlate with the
biomarker patterns presented in Figure 4b which mostly represent
these peaks.

Thus, the P-values of the wavelet coefﬁcients give an estimate of
the discriminative power of features at different scales and positions.

647

T.Alexandrov et al.

(a)

(b)

Fig. 5. The P-values (MW, Bonf) for APPDWT coefﬁcients plotted in log10-scale against the difference of the mean spectra for the wavelet scales L1–L9.
(a) All P-values. (b) Only the 100 smallest P-values showing the most discriminative parts of the biomarker patterns.

Table 3. Indication of whether the peaks (denoted by their m/z-values, in
Da) are reconstructed by the most signiﬁcant APPDWT coefﬁcients

Table 4. Generalization properties of the most discriminative APPDWT
coefﬁcients considering the number of support vectors

P-values

1
10
20
50
150
300

1208 1265 1352 1467 1692 1780 1867 2024

√
√
√
√
√
√

√
√
√

√
√
√
√
√

√
√
√
√
√

√
√

√
√

√

√
√
√
√

1
2

2.5
3

Signiﬁcance order
CPT signiﬁcance order

5
4
√
The MW test is used. The sign ‘
’indicates the presence of the peak in the corresponding
features. This table shows in particular that the largest peaks are not the most statistically
signiﬁcant (discriminative) ones. The signiﬁcance order summarizes the table. The ‘CPT
signiﬁcance order’ is calculated by the CPT software.

2.5
1

6.5
7

6.5
5

4
15

8
9

Considering the most discriminative parts of the biomarker
patterns (Figure 5b depicts only the 100 smallest P-values), the
discriminative power of the peak is not simply expressed by its
height. For example, the high intensity difference of the peak
at 1867 Da is not found among the most discriminative features
obtained. To provide more information for this observation, we
did a further evaluation. For different numbers of the coefﬁcients
with the smallest P-values we plotted the diagram as in Figure 5b
and checked whether the dark cells (discriminative coefﬁcients)
correspond to the peaks of largest
intensity difference. This
compares step-by-step the discriminative power of these peaks.
Table 3 shows whether the considered peaks are present in the most
discriminative parts of the biomarkers corresponding to different
quantities of the smallest P-values or not. It turns out that the most
discriminative (the most signiﬁcant one, signiﬁcance order 1) peak
is at 1265 Da.

We compared these results also with the most signiﬁcant peaks
produced by CPT 2.2 which uses a t-test based on the peaks areas,
see Table 3, row ‘CPT signifance order’ (for more CPT results see
Supplementary Table 2). CPT ﬁnds a similar set of peaks (the group
of the ﬁrst three peaks is the same) though there are variations in
their order. Unfortunately, TRR cannot be compared as CPT 2.2 does
not implement double CV.

Finally the TRR and the generalization properties of classiﬁers
which use only a limited number of the most discriminative

648

Number of coefﬁcients

1784 (Bonf)
100
50
20
10
5
1

TRR

97.3
95.5
94.6
94.6
95.5
95.5
95.5

Mean number of SV

43.4
39.5
49.5
62.8
66.8
70.0
88.2

The MW test is used to calculate the P-values and to rank the coefﬁcients. For
abbreviations, see Table 2.

wavelet coefﬁcients (Table 4) have been analyzed. As before, the
generalizability of a SVM-classiﬁer is estimated by the number of
support vectors. It may be unexpected to discover that the TRR
provided by a very small number and by thousands of coefﬁcients are
comparable. Nevertheless, the classiﬁers constructed using only a
few coefﬁcients need many support vectors. As an extreme example,
the most discriminative coefﬁcient on its own provides a recognition
rate of 95.5%, but the classiﬁer built on it is not general at all, as
88 spectra (almost 4/5 of the dataset) are used as (in this case one
dimensional) SVM support vectors. The large number of support
vectors used (compared with 43 for Bonf) most probably indicates
overﬁtting.

3.4 Possible modiﬁcations
The whole model building and validation procedure needs much
computation time. This is mainly due to the two-level grid search
and leave-one-out cross validation used in the outer loop. Time
could be saved by preselecting the m/z-intervals based on the mean
spectra difference, e.g. by taking only coefﬁcients from the intervals
with an absolute difference larger than a fraction M (0 < M <1) of
the maximum absolute difference value. For M=0.05 the intervals
constitute 1.6% of all m/z-values but include all the most signiﬁcant
peaks presented in Table 3.
Another way to reduce computation time is to use only selected
levels of the DWT. In our dataset the typical peak width is ∼30 Da
(empirically estimated). On the 5-th DWT level the width of scaling
function is ∼32 Da (15 and 65 Da for 4-th and 6-th levels). Thus the
scaling function of the 5-th level is a good approximation for peak.

Biomarker discovery in MALDI-TOF serum protein proﬁles using DWT

This was conﬁrmed by tests (Supplementary Table 3). Among the
test runs with individual levels the best results were obtained for
level 5 with the KS test and Bonf adjustment (97.32% TRR and a
mean of 43 support vectors).

experimental methods and the classiﬁcation model is beyond the
scope of this article. Based on the m/z-values of linear TOF spectra
an identiﬁcation is not possible and further biochemical and MS/MS
experiments are required.

4 CONCLUSIONS
We evaluated an automatic procedure of CRC detection using
MALDI-TOF spectra based on: (i) discrete wavelet transformation;
(ii) selection of discriminative wavelet coefﬁcients using the non-
parametric difference tests with multiplicity adjustment; (iii) SVM
classiﬁcation. Our procedure is based on the ideas published
in Schleif et al. (2007), but was signiﬁcantly extended as it was
summarized in the introduction.

Especially, we evaluated the feature selection here together
with the classiﬁcation using an up-to-date double CV scheme to
reduce potential bias. Moreover, we proposed a visualization of the
biomarker patterns used for classiﬁcation.

The presented procedure has been applied to a collection of
MALDI-TOF serum protein proﬁles from 66 CRC patients and 50
controls (de Noo et al., 2006). Compared with (de Noo et al., 2006),
a higher TRR, sensitivity and speciﬁcity for the detection of cancer
are achieved. Examining the properties of SVM classiﬁers with a
different number of wavelet coefﬁcients reveals that the number of
required support vectors goes up signiﬁcantly if too few coefﬁcients
are used. Even if such a small subset gives good classiﬁcation results
it indicates an overﬁtting to the given spectra and might indicate
a lack of generalizability of the model considering experimental
variability.

The biomarker patterns provided are similar to those of de Noo
et al. (2006) but have a higher resolution that in principle allows to
ﬁnd minor discriminating peaks close to other neighboring peaks.
The investigation of the found peaks showed that those of them
which intensity-wise differ the most between cancer and control
spectra are not the most discriminative ones in terms of the statistical
feature selection procedure.

We expect that applying our DWT-based classiﬁcation approach
with attention to generalization properties of classiﬁers, helps to
obtain high recognition rates for the detection of cancer and to ﬁnd
biologically valuable and interpretable biomarkers. The molecular
identiﬁcation of the peaks and multi-laboratory validation of the

ACKNOWLEDGEMENTS
We thank Martijn van der Werff for contribution to an initial variant
of the article, Marc Gerhard for help with ClinProTools software
and Jens Fuchser for proofreading of the article.

Conﬂict of Interest: none declared.

REFERENCES
Bartlett,P. and Shawe-Taylor,J. (1999). Generalization performance of support vector
machines and other pattern classiﬁers. In Schölkopf,B. et al. (eds), Advances in
kernel methods: SV learning, MIT Press, Cambridge, MA, USA, pp. 43–54.

Check,E. (2004) Proteomics and cancer: Running before we can walk? Nature, 429,

496–497.

Coombes,K.R. et al. (2005) Serum proteomics proﬁling – a young technology begins

to mature. Nat. Biotechnol., 23, 291–292.

de Noo,M. et al. (2006) Detection of colorectal cancer using MALDI-TOF serum protein

proﬁling. Eur. J. Cancer, 42, 1068–1076.

Dudoit,S. et al. (2003) Multiple hypothesis testing in microarray experiments. Stat. Sci.,

18, 71–103.

Leung,A.K. et al. (1998) A review on applications of wavelet transform techniques in

chemical analysis: 1989–1997. Chemometr. Intell. Lab., 43, 165–184.

Mallat,S. (1999) A wavelet tour of signal processing. Acad. Press, San Diego, CA, USA.
Mertens,B.J. et al. (2006) Mass spectrometry proteomic diagnosis: enacting the double

cross-validatory paradigm. J. Comput. Biol., 13, 1591–1605.

Noble,W.S. (2004) Support vector machine applications in computational biology. In
Schölkopf,B. et al. (eds), Kernel Methods in Computational Biology. MIT Press,
Cambridge, MA, pp. 71–92.

Noble,W.S.

(2006) What

is a support vector machine? Nat. Biotechnol., 24,

1565–1567.

Petricoin,E.F. et al. (2002) Use of proteomic patterns in serum to identify ovarian cancer.

Lancet, 359, 572–527.

Ransohoff,D.F. (2004) Rules of evidence for cancer molecular-marker discovery and

validation. Nat. Rev. Cancer, 4, 309–314.

Schleif,F.-M. et al. (2007) Support vector classiﬁcation of proteomic proﬁle spectra
based on feature extraction with the bi-orthogonal discrete wavelet transform.
Comput. Visual. Sci. [Epub ahead of print, doi:10.1007/s00791-008-0087-z, March
7, 2008].

Stone,M. (1974) Cross-validatory choice and assessment of statistical predictions.

J. Roy. Stat. Soc. B Met., 36, 111–147.

649

