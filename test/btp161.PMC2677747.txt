BIOINFORMATICS APPLICATIONS NOTE Vol.25 no.10 2009, pages 1338 1340 doi:10.1093/bioinformatics/btp161 Sequence analysis Identiﬁcation of ribosomal RNA genes in metagenomic fragments Ying Huang, Paul Gilna and Weizhong Li  California Institute for Telecommunications and Information Technology, University of California, La Jolla, San Diego, California, USA Received on November 3, 2008 revised on March 16, 2009 accepted on March 17, 2009 Advance Access publication April 3, 2009 Associate Editor: Ivo Hofacker ABSTRACT Motivation: Identiﬁcation of genes coding for ribosomal RNA (rRNA) is considered an important goal in the analysis of data from metagenomics projects.
Here, we report the development of a software program designed for the identiﬁcation of rRNA genes from metagenomic fragments based on hidden Markov models (HMMs). This program provides rRNA gene predictions with high sensitivity and speciﬁcity on artiﬁcially fragmented genomic DNAs. Availability: Supplementary ﬁles, scripts and sample data are available at http://tools.camera.calit2.net/camera/meta_rna. Contact: liwz@sdsc.edu Supplementary information: Supplementary Data are available at Bioinformatics online.
1 INTRODUCTION The emerging ﬁeld of metagenomics promises a more compre- hensive and complete understanding of the microbial world.
Many projects have been reported with metagenomic approaches to study microbes and microbial communities that live in many different environmental conditions (Tringe and Rubin, 2005). Analyzing the sequence data generated by these projects is far from easy and requires accessible and user-friendly tools (Raes et al., 2007). An essential step in any metagenomics project is the identiﬁcation of genes encoding for ribosomal RNAs (rRNAs), which are widely used for phylogenetic analysis and quantiﬁcation of microbial diversity.
Several methods haven been proposed for predicting non-coding RNA genes (Meyer, 2007), but a recent benchmark study by Freyhult et al. (2007) indicated that the most commonly used methods yield less than encouraging results.
Lagesen et al. (2007) proposed RNAmmer, a program based on hidden Markov models (HMMs) for annotation of rRNA genes.
Their algorithm predicts rRNAs in complete genomics sequences with high accuracy.
However, a major concern for their predictions is the inability to deal with fragments of rRNAs. Compared with assembled genomic sequences from single species, the raw sequence reads from a typical metagenomic study often remain unassembled due to insufﬁcient coverage.
For a typical metagenome dataset, the length of sequence read is 100 450 bp using 454 pyrosequencing, or 700 bp long if using Sanger sequencing.
Meanwhile, the full lengths of most of 16S and 23S rRNAs are 1200 bp. Therefore, most of rRNA   To whom correspondence should be addressed.
genes in metagenomic sequencing reads are fragmentary, and will be overlooked by RNAmmer that focus on full length rRNAs. To overcome this limitation, we used HMMs that can discover incomplete rRNA gene fragments for predictions.
In this article, we apply our algorithm on simulated sets of sequence reads of various lengths.
Our method provides rRNA predictions with high-sensitivities and speciﬁcities on the benchmark dataset. 2 ALGORITHM DEVELOPMENT As an important molecular machine in all living organisms, the ribosome can be broken down into two subunits, the small and the large subunit. In prokaryotes, the large subunit of the ribosome contains 5S and 23S rRNAs, while the small subunit contains 16S rRNAs. Therefore, we will try to build predictors for 5S, 16S and 23S rRNAs. To obtain a reliable multiple sequence alignment (MSA) for HMM building, we retrieved MSAs of 5S rRNAs from the 5S Ribosomal Database (Szymanski et al., 2002), and MSAs of 16S and 23S rRNAs from the European rRNA database (Wuyts et al., 2004). These databases provide high-quality alignment that combine sequence and structural information.
The MSAs were then divided into bacterial and archaeal domains.
All sequences with more than ﬁve ambiguous nucleotides in either end were removed from the alignment, and then sequences were further clustered at 98% identity threshold to reduce bias.
We then used software package HMMER (Eddy, 1998) version 2.3.2 to create HMMs from these alignments.
We used fs mode in HMMER package for HMM building instead of ls mode implemented in RNAmmer. In HMMER package, ls mode is suitable for identiﬁcation of a complete sequence domain, while fs mode is capable of ﬁnding domain fragments and maybe useful to detect incomplete rRNA genes.
In addition, domain information for sequences is not available in metagenomic projects, so HMMs from bacterial and archaeal rRNA alignments were both used to search input sequences.
Each sequence was classiﬁed to the domain that reported the most signiﬁcant E-value, and results obtained from corresponding HMMs were used as ﬁnal result.
3 EVALUATION Performance of our rRNA prediction algorithm was evaluated using artiﬁcial DNA fragments generated from fully sequenced archaea and bacteria genomes.
GenBank ﬁles for all fully sequenced genomes were retrieved from the ENTREZ Genome Project  2009 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[17:17 8/4/2009 Bioinformatics-btp161.tex] Page: 1338 1338 1340  Identiﬁcation of ribosomal RNA genes Table 1.
Prediction sensitivities for different fragment lengths Table 2.
Prediction speciﬁcities for different fragment lengths Prediction method hmm_fs BLASTN Prediction method hmm_fs BLASTN Length of reads 5S 16S 23S 5S 16S 23S Length of reads 5S 16S 23S 5S 16S 23S 100 200 300 400 500 600 700 800 91.9 95.8 96.8 97.6 98.2 98.0 98.7 98.2 98.2 97.9 99.3 98.3 99.2 98.8 99.5 99.2 96.2 98.6 99.0 99.2 99.1 99.1 99.3 99.6 79.4 85.7 88.3 89.1 89.2 89.5 90.3 90.8 89.9 96.7 99.0 97.5 99.2 98.4 99.5 99.2 94.8 97.8 98.2 98.5 98.4 98.5 98.7 99.1 100 200 300 400 500 600 700 800 88.6 90.4 91.7 92.3 93.7 92.0 93.9 92.6 92.7 91.2 93.5 95.4 91.9 91.4 91.0 89.6 94.5 94.0 94.4 94.3 93.3 94.2 94.9 94.5 92.8 93.0 94.9 94.2 95.0 94.1 95.6 94.1 91.5 88.1 86.9 88.6 84.4 86.5 85.5 82.3 94.8 94.6 94.8 94.9 94.1 94.6 95.6 94.9 Here, hmm_fs represents our algorithm.
Sensitivities are represented in percentage (%). Here, hmm_fs represents our algorithm.
Speciﬁcities are represented in percentage (%). (downloaded on September 30, 2008). To reduce the impact of sequence redundancy, we removed species related to training set (see Supplementary Tables for remaining species used for evaluation). To simulate the current sequencing techniques, fragments of the lengths 100 800 bp (in intervals of 100 bp) were randomly sampled from each genome to 1 genome coverage for each length.
These fragments were used to investigate prediction performance of both our method and RNAmmer, they were also analyzed by BLASTN against 5S Ribosomal Database and SILVA database (Pruesse 5 or et al., 2007) to identify rRNA genes (with E-value of 10 less). In current analysis, sampling of fragments was done without considering the sequencing errors, therefore estimated performances are optimistic.
The annotation information of rRNA genes was also retrieved from GenBank ﬁles. Sequence fragments that had an overlap ( 40 nt) with a known rRNA gene in the same strand were considered as a positive sample.
The ratios of true-positives relative to all annotated fragments (sensitivity) and to all predicted fragments (speciﬁcity) were used as a performance measure.
Both exactly matching predictions and partially matching predictions with correct strand were counted as true-positives.
Tables 1 and 2 show the prediction sensitivities and speciﬁcities for all fragment lengths.
The result for RNAmmer is shown in Supplementary Table S5. The sequence length of most 16S and 23S rRNA genes substantially exceeds 800 bp, therefore can not be detected by a full domain model like RNAmmer. It can be shown that our algorithm can predict sequence reads with rRNAs with a high sensitivity and speciﬁcity ( 90% in almost all conﬁgurations). More important, the prediction performance does not vary much on different read lengths.
One commonly used method for predicting rRNAs in metagenomic projects is based on BLAST (Altschul et al., 1997, Frias-Lopez et al., 2008). However, Lagesen et al. (2007) indicated that results based on BLAST can be problematic due to its inconsistency.
Compared with BLASTN, our algorithm achieves much better sensitivities (average 10.2% improvement) while the speciﬁcities are around 2.3% less for 5S RNA. The performances for 23S rRNA are almost the same for our algorithm and BLASTN. The biggest improvement comes from 16S rRNA prediction, it demonstrates that our algorithm improves the speciﬁcities signiﬁcantly and keeps the sensitivities slightly better.
The average running time of our algorithm was 744 ms per 800 bp read, and 145 ms per 200 bp read for a single 2.33G Xeon CPU. The running time for BLASTN was 239 ms per 800 bp read, and 123 ms per 200 bp read.
Additional analyses were performed on Sargasso Sea metagenomic project (Venter et al., 2004) consisted of 811 372 entries totaling over 800 Mbp. On this set the search speed was 1088 s per Mbp, and our algorithm identiﬁed 660 5S, 1337 16S and 2300 23S rRNA genes or fragments of genes.
4 CONCLUSION With the continued growth of metagenomic sequencing projects, identiﬁcation of rRNA genes within sequence fragments from these projects continues to be a very important task.
Here, we reported a HMM based algorithm to detect rRNA genes in short metagenomic fragments with high accuracies. Our algorithm is written in Python, and runs well on Linux/Unix and Windows XP systems with the installation of Python and HMMER package.
The scripts, sample dataset and usage instruction are available online at http://tools.camera.calit2.net/camera/meta_rna as a downloadable application.
Funding: Gordon and Betty Moore Foundation (CAMERA project, http://camera.calit2.net). Conﬂict of Interest: none declared.
REFERENCES Altschul,S.F. et al. (1997) Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.
Nucleic Acids Res., 25, 3389 3402.
Eddy,S.R. (1998) Proﬁle hidden Markov models.
Bioinformatics, 14, 755 763.
Freyhult,E.K. et al. (2007) Exploring genomic dark matter: a critical assessment of the performance of homology search methods on noncoding RNA. Genome Res., 17, 117 125.
Frias-Lopez,J. et al. (2008) Microbial community gene expression in ocean surface waters.
Proc. Natl Acad. Sci.
USA, 105, 3805 3810.
Lagesen,K. et al. (2007) RNAmmer: consistent and rapid annotation of ribosomal RNA genes.
Nucleic Acids Res., 35, 3100 3108.
Meyer,I.M. (2007) A practical guide to the art of RNA gene prediction.
Brief.
Bioinform., 8, 396 414.
Raes,J. et al. (2007) Get the most out of your metagenome: computational analysis of environmental sequence data.
Curr. Opin. Microbiol., 10, 490 498.
Pruesse,E. et al. (2007) SILVA: a comprehensive online resource for quality checked and aligned ribosomal RNA sequence data compatible with ARB. Nucleic Acids Res., 35, 7188 7196.
1339 [17:17 8/4/2009 Bioinformatics-btp161.tex] Page: 1339 1338 1340  Y.Huang et al. Szymanski,M. et al. (2002) 5S Ribosomal RNA database.
Nucleic Acids Res., 30, Venter,J.C. et al. (2004) Environmental genome shotgun sequencing of the Sargasso 176 178.
Sea.
Science, 304, 66 74.
Tringe,S.G. and Rubin,E.M. (2005) Metagenomics: DNA sequencing of environmental Wuyts,J. et al. (2004) The European ribosomal RNA database.
Nucleic Acids Res., 32, samples.
Nat. Rev.
Genet., 6, 805 814.
D101 D103. 1340 [17:17 8/4/2009 Bioinformatics-btp161.tex] Page: 1340 1338 1340
