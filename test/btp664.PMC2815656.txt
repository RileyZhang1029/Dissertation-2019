BIOINFORMATICS ORIGINAL PAPER Vol.26 no.3 2010, pages 319 325 doi:10.1093/bioinformatics/btp664 Structural bioinformatics Optimization of minimum set of protein DNA interactions: a quasi exact solution with minimum over-ﬁtting N. A. Temiz1, , A. Trapp2, , O.
A. Prokopyev2, and C. J. Camacho1, 1Department of Computational Biology, School of Medicine and 2Department of Industrial Engineering, School of Engineering, University of Pittsburgh, Pittsburgh, PA 15260, USA Received on August 25, 2009 revised on November 6, 2009 accepted on November 28, 2009 Advance Access publication December 4, 2009 Associate Editor: Anna Tramontano ABSTRACT Motivation: A major limitation in modeling protein interactions is the difﬁculty of assessing the over-ﬁtting of the training set.
Recently, an experimentally based approach that integrates crystallographic information of C2H2 zinc ﬁnger DNA complexes with binding data from 11 mutants, 7 from EGR ﬁnger I, was used to deﬁne an improved interaction code (no optimization). Here, we present a novel mixed integer programming (MIP)-based method that transforms this type of data into an optimized code, demonstrating both the advantages of the mathematical formulation to minimize over- and under-ﬁtting and the robustness of the underlying physical parameters mapped by the code.
Results: Based on the structural models of feasible interaction networks for 35 mutants of EGR DNA complexes, the MIP method minimizes the cumulative binding energy over all complexes for a general set of fundamental protein DNA interactions.
To guard against over-ﬁtting, we use the scalability of the method to probe against the elimination of related interactions.
From an initial set of 12 parameters (six hydrogen bonds, ﬁve desolvation penalties and a water factor), we proceed to eliminate ﬁve of them with only a marginal reduction of the correlation coefﬁcient to 0.9983.
Further reduction of parameters negatively impacts the performance of the code (under-ﬁtting). Besides accurately predicting the change in binding afﬁnity of validation sets, the code identiﬁes possible context-dependent effects in the deﬁnition of the interaction networks.
Yet, the approach of constraining predictions to within a pre-selected set of interactions limits the impact of these potential errors to related low-afﬁnity complexes.
Contact: ccamacho@pitt.edu droleg@pitt.edu Supplementary information: Supplementary data are available at Bioinformatics online.
1 INTRODUCTION Zinc ﬁnger (ZF) transcription factors are the largest family of nucleic acid binding factors in eukaryotes (Laity et al., 2001). Due to the relatively promiscuous interactions of these factors (Wolfe et al., 2000), the majority of their cognate DNAbinding sites are still poorly resolved.
Indeed, a major limitation on the analysis of ZF DNA interactions and other factors is the lack of reliable experimental  These authors contributed equally to this work.
To whom correspondence should be addressed.
techniques to map their speciﬁcity to other targets (Camenisch et al., 2008). Given this vacuum, the development of computational methods to assist in the identiﬁcation of protein DNA physical interactions can play an important role in revealing the molecular basis of how genes are activated/repressed, leading to normal cell function or to the acquisition of speciﬁc pathogenic traits.
The regularity of the structure of C2H2 ZF genes (Pavletich and Pabo, 1991 Pavletich and Pabo, 1993 Segal et al., 2006) and the dominant binding mode (Elrod-Erickson et al., 1996 Elrod- Erickson et al., 1998) make this family an ideal system to be studied both theoretically and experimentally.
The classical Early Growth Factor (EGR) gene, zif268 (Fig. 1) shows the main recognition motif, a helix binding to the major groove of the DNA. Three ZFs of EGR wrap around the major groove of DNA (Fig. 1A). This gene was found to have the consensus DNA sequence GCG G T GGGCG for ZF binding, where a high afﬁnity for guanine in DNA recognition is frequently observed.
The recognition motif typically involves helix positions 1, +3 and +6 (numbered from the start of the helix), each residue coordinating one nucleotide (Fig. 1B). However, high- resolution crystal structures (Elrod-Erickson et al., 1996) have also shown that water-mediated contacts and bonds to position (pos.) +2 might also occur.
It is important to note that other interactions with DNA bases showing non-classical binding modes are also physically possible, but less common (Siggers et al., 2005 Wolfe et al., 2000). Modeling protein interactions is a challenging problem in computational structural biology.
Indeed, despite recent advances in the ﬁeld (see, e.g. Mendez et al., 2005), empirical potentials are still quite limited (Camacho et al., 2006). For instance, the best outcome on a recent benchmark (Bueno et al., 2007b) of some of the best known methods (machine learning, physical and knowledge based) to predict changes in folding free energy for single mutants of aliphatic side chains was a mere 72% success rate on  Gs within 1 kcal/mol of the experimental data.
The reasons for this dismal outcome are the same for protein DNA interactions, i.e. the poor sampling of complexes (Morozov et al., 2005) and the difﬁculty in assessing changes in polar and water-mediated interactions (see, e.g. Bueno and Camacho, 2007a Ernst et al., 1995). More interestingly, the aforementioned benchmark revealed that all methods resulted in more or less equivalent predictions despite the fact that the number of free parameters varied widely between 5 and 40, reﬂecting the poor assessment of model over-ﬁtting. Recently, a 2 year effort mapping structural models to high-quality binding afﬁnity data of ZF/DNA complexes  The Author(s) 2009.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
N.A.Temiz et al. Fig.1.
Interactions of ZF-DNA triplets.
(A) EGR DNA complex (Elrod- Erickson et al., 1996). (B) Binding mode of ﬁnger I of EGR. H-bonds are shown as pink dashed lines.
Binding site residues are indicated.
(C) 2D representation of the interaction network of ﬁnger I of EGR to its DNA target.
Inter-molecular H-bonds are indicated by arrows between residues and DNA, side-chain backbone and side-chain side-chain intra-molecular bonds are noted as arrows over the top and lines below the protein sequence, respectively.
(D) Typical interaction network of an EGR-like ZF. H-bonds typically form at positions 1,+2,+3 and +6 with respect to the beginning of the helix.
Dashed lines in ﬁngers II and III from pos +2 show the possible H-bonds by Ser residues to C (ﬁnger II) or A (ﬁnger III) in the complementary strand.
(Temiz and Camacho, 2009) led to the development of a novel interaction code.
The key feature of this approach is the pre-selection of structural models based on distance constraints as opposed to optimizing an imperfect scoring function.
A 10 parameter ZF/DNA atomic interaction code was developed using ﬁve crystals (Elrod- Erickson et al., 1996 Elrod-Erickson et al., 1998 Kang, 2007) as templates for homology models of ZF structures and binding modes, a minimal set of binding afﬁnities from seven mutants of ﬁnger I of EGR (Liu and Stormo, 2005) and three mutants of ﬁnger III (Bae et al., 2003). Predictions on independent validation sets resulted in structural models for the mutant complexes, as well as in differences between mutant (multiple amino acid and nucleotide mutations) and wild-type (WT) binding afﬁnities,  Gbind, of just a few tenths of a kcal/mol. From a methodological point of view, the code assumed that the experimental  Gbind of the selected mutants were exact.
This is not a common assumption for this type of data.
However, the manual optimization of a full binding afﬁnity database of feasible structural models (referred to as submodels ) involved the difﬁcult task of checking an exponentially large number of submodel combinations.
For instance, Figure 2 shows a simple example for two data points where each mutant has three different arrangements of possible leading to 32 combinations.
For all 35 inter-molecular bonds, mutants available for EGR ﬁnger I (Liu and Stormo, 2005), one has roughly 335 possible ways of minimizing  Gbind. To provide a mathematical framework to solve this type of problems and validate the experimentally based approach to decode protein interactions, we develop a novel non-linear mixed integer programming (MIP) method which optimizes over all mutants of EGR ﬁnger I.
The scalability of the method allows us to probe the over-ﬁt and under-ﬁt of the method by solving interaction codes with 320 Fig.2.
Sketch of three feasible submodels for two mutants, and the nine possible combinations (I,  , IX) in which, depending on the value and number of parameters, different submodels minimize the binding free energy (see text). Arrows correspond to H-bonds, circles and squares correspond to desolvation penalties and half open or ﬁlled triangles indicate the absence or presence of excess water molecules near the indicated interaction.
For details and color codes see (Temiz and Camacho, 2009). different number of parameters i.e. from 12 interactions all the way down to ﬁve independent variables.
The resulting codes strongly support the robustness of the physical parameters obtained in (Temiz improving the correlation coefﬁcient R2 and Camacho, 2009), to 0.998 with just seven free parameters (minimum over-ﬁtting). Further decreasing the number of parameters negatively under- ﬁts the predictions in the validation sets.
To demonstrate that the MIP is independently capturing the underlying interactions, we systematically eliminated all seven ﬁnger I mutants used to map the original code, obtaining in a few minutes almost equivalent interaction codes.
Finally, given that the homology (sub)models of ﬁnger II and III mutants of EGR involved the extra challenge of predicting water-ﬁlled cavities at the binding interface, we show how one can use the unprecedented accuracy of our MIP-based code to further validate water positions.
2 METHODS 2.1 ZF/DNA interactions The basic assumption of the experimentally based approach to represent ZF/DNA interactions (Temiz and Camacho, 2009) is that changes in the afﬁnity of a complex due to mutations are uniquely determined by changes in the contact energies and solvation factors between the structures.
Based on the above, we developed the following scheme to decode the interaction potential:  Build homology submodels of mutant TF based on templates from known complex structures.
Based on the conservation of the tetrahedral coordination of the zinc ion and helical binding domain, predicting both quality alignment and backbone submodels is relatively straightforward (Prasad et al., 2003). Perform MD simulations of the homology submodels in the absence of DNA in explicit solvent to readily identify feasible intra-molecular hydrogen bonds (H-bonds). ZF/DNA homology submodels are built by superposition in crystal- lographically validated binding modes.
DNA structures considered in our submodels are from DNA bound to ZFs if not available, DNA triplets are taken from the PDB. Inter-molecular H-bonds are  Optimization of minimum set of protein DNA interactions deemed feasible if side chain conformations sampled from the MD in the absence of DNA are within an empirical 4 Å distance threshold of the DNA acceptor/donor. With this pre-screening, we deﬁne a series of submodels of feasible low energy combinations of intra- and-inter-molecular H-bond networks for each complex (see, e.g. Fig.2). Unless crystal information is available, water molecules are placed in all cavities that can ﬁt one.
These waters are used to predict whether bonds are more or less exposed to solvent, and to determine whether the accessibility water factor is applicable (see below). Effective free energies are assigned to all H-bonds: eij to inter- molecular H-bonds, δi to atomic desolvation penalties triggered by unmatched hydrogen bond donors or acceptors and buried hydrophobic residues.
These interactions are further modulated by a novel water factor λw that is applied depending on the number of water molecules contacting the atomic interactions.
Thus, given a submodel, these assignments allow us to compute the binding energy as:  GCalc= ( f (λw) εk+f (λw) δk) k (1) the water factor is f (λw)= (1 λw) for multiple waters surrounding a H- bond and 1/(1 λw) for a water free bond.
Then, the change in binding the wild type (WT) free energy relative to a reference state (often, conﬁguration) is  Gbind = GCalc (submodel)  GCalc (WT), which is related to biochemical binding data using the ratio of the dissociation constants Kd as (cid:2) (cid:3) (cid:1) =exp KdMut KdWT  Gbind RT (2) where R and T are the gas constant and temperature, respectively, and Mut refers to the mutation relative to WT.
Using just seven mutant complexes of ﬁnger I [see ref.
(Temiz and Camacho, 2009) for details], the interaction code was solved for a seven parameter interaction potential.
These include: (i) three H-bonds, (a) the two (bidentate) H-bonds between Arg and Guanine, e1  Arg = G, which is assumed to be twice the strength of both a single K G H-bond and of a side chain phosphate backbone (bb) H-bond, (b) the bidentate e2 Gln = A H-bond, which is assumed to have the same strength as Asn = A with the strength of individual H-bonds (e.g. Asn.OD-A) partitioned proportional to their partial charges, (c) e3 Asp-C H-bond used to estimate all bonds involving Asp side chains (ii) three desolvation penalties (a) e4  δNH2 for unmatched side chain NH2 groups, (b) e5  δOD for a free side chain with an unmatched oxygen group at the binding interface from Gln, Asn, Glu or Asp and (c) e6  δHB for burying a sc-sc H-bond between any two interface residues at positions 1, +2, +3 or +6 and leaving at least one oxygen unmatched and (iii) the water factor λw, corresponding to the fraction by which the transition state of H-bonds exposed to extra waters is decreased.
Three other mutants from ﬁnger III of EGR were used to model interactions not present in ﬁnger I.
2.2 Mixed integer programming Mixed integer programming (MIP) is a mathematical tool which can be used to ﬁnd solutions to problems involving some combinatorial structure.
MIP formulation may include both integer and continuous variables, constraints (which typically enforce restrictions on permissible variable combinations), as well as an objective function, which provides for a means of evaluating the quality of a given solution satisfying the constraints (Floudas and Pardalos, 2009 Pardalos and Resende, 2002). Three standard methods for solving different classes of MIPs include exact methods [e.g. branch-and- bound, branch-and-cut, branch-and-price, cutting plane (Nemhauser and Wolsey, 1988)], metaheuristic techniques (Glover and Kochenberger, 2003 Vazirani, 2001), as well as approximation algorithms (Vazirani, 2001). MIPs have being successfully applied to a broad range of problems including bioinformatics (Floudas and Pardalos, 2000), protein design (Fung et al., 2005) and structural alignment (Dundas et al., 2007). Fig.3.
Mapping of MIP parameters onto a free energy landscape of four submodels ( j ) of complex ( i ) QDNR/GAC. The condition that only one submodel minimizes the free energy is imposed by the constraint jxij = 1.
H-bonds are represented by two letters, the ﬁrst letter corresponding to the residue and the second the nucleotide.
In practice, the arrangement of submodels on the funnel is given by the solution of the MIP application.
2.3 Mapping interaction code into a MIP Variable deﬁnition (Fig. 3):  ek: parameters in the interaction code (0 ek  4), H-bonds and desolvation factors  λw: unknown water factor (0 λw  1)  xij = 1 if submodel j Si (where Si is a list of feasible submodels for ZF/DNA complex i) is assigned to complex i xij = 0 otherwise.
Data modeling:  Submodel j( Si) for i is deﬁned as the sum of the interactions of the ij is either submodel relative to a reference, i.e. a known coefﬁcient or a known function of λw. When ek is not present, wk ij is deﬁned as 0. ij(λw)ek, where wk k wk (cid:4)   Gi: experimental change in binding energy for complex i.
Basic MIP optimization formulation:  Objective function minimizes binding energy over all complexes: (cid:1) (cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5) Gi  min e,λw ,x i (cid:6) (cid:1) k xij  (cid:7)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5),subject to: wk ij(λw)ek (3)  the constraint that exactly one submodel is correct for each complex i: xij =1  i (4) (cid:1) j Si (cid:1) j Si  the constraint that the correct submodel for each complex i has the (cid:1) (cid:1) lowest energy of all submodels for that complex: xij  ij(λw)ek  xij wk for all i,j Si, for all (cid:6) Si and (cid:6)(cid:7)= j  and constraints on type and bounds of variables: wk k k i(cid:6)(λw)ek 0 λw 1,0 ek 4 k xij  0,1  i,j. and (5) (6) Equivalent non-linear mixed 0 1 reformulation of (3-6):  Formulation (3)-(6) is simpliﬁed by reformulating the non-linear integer program into a mixed integer problem, which is linear for a 321  N.A.Temiz et al. ﬁxed λw. Objective function (3) is replaced by: ti subject to ti  Ei  min e,λw ,x,t,y (cid:1) (cid:1) j Si i ti  Ei+  i yij (cid:1) j Si yij and (7) Note that we still retain the constraint (4). where Ei is  Gi and new variables ti serve to eliminate the non-linear absolute value terms in (3). Depending on the sign of j Si yij or j Si yij, minimization of (7) yields either ti  Ei (cid:4) Ei (cid:4) ti  Ei+(cid:4) i. j Si yij New variables yij = xij (cid:4) (cid:4) k wk ij(λw)ek if xij =1 and 0 otherwise: k wk i,j Si and yij  ij(λw)ek serve to linearize the non-linear terms inside absolute values in (3) via the following constraints (8)-(9), which force yij to be equal to  i,j Si (cid:1) ij(λw)ek 0 yij  Mijxij yij  (cid:1) wk ij(λw)ek Mij(1 xij) i,j Si wk k (8) (9) k where Mij is a constant chosen to be large enough to give a valid upper bound on variable yij. Lastly, linearized constraint set (10) is equivalent to (5), while (11) is same as (6): (cid:1) k for all i, j Si, 0 λw 1, (cid:1) ij(λw)ek  wk for all (cid:6) Si and (cid:6)(cid:7)= j 0 ek 4 k i(cid:6)(λw)ek+Mij(1 xij) wk (10)  k and xij  0,1  i,j. (11) Formulation (4), (7)-(11) is a much simpliﬁed version of (3) (6). While it is still non-linear on the parameter λw, we can further transform it into a standard (linear) MIP through a straightforward discretization-linearization procedure.
3 RESULTS 3.1 Solving MIP formulation to decode protein interactions (cid:4) k wk the While formulation (7) (11) eliminates the difﬁculties of absolute values present in the objective (3) as well as non-linear constraints (5), there remains the presence of non-linearities in the ij(λw)ek expressions.
However, these non-linearities always appear in the form of a product of some ek parameters together with expressions involving λw. By representing continuous parameter λw as its binary representation, we are able to introduce further linearizations which transform the problem into a mixed integer program without any non-linearities. p, Assuming we desire to represent λw within accuracy ε=10 where p is some positive integer, then we need exactly (cid:9) binary variables z(cid:6) 0,1 , so that λw (cid:4) The products involving λw and ek appear in two distinct forms: (a) (1 λw)ek and (b) ek /(1 λw). To reformulate (a) using the binary ek λwek = ek (cid:4) representation of λw, any product (1 λw)ek can be represented as (cid:6)z(cid:6) is a product of a continuous variable ek and binary variable z(cid:6). Let c(cid:6)k = z(cid:6)ek , (cid:6)=  (cid:6)z(cid:6), where each ek2 log10 log2 (cid:6)=1 ek2 Z  (cid:6)z(cid:6). (cid:6)=12 Z Z = (12) (cid:8) 1,...,Z, where the equality over non-linear products is imposed via p 322 (cid:6)=12 Z a standard linearization technique using four additional constraint sets, see, e.g. (Prokopyev et al., 2005 Wu, 1997). Then (a) can be rewritten as ek (cid:4) (cid:6)c(cid:6)k. For the reformulation of (b), ﬁrst let uk = ek /(1 λw). Then we can equivalently write ek = uk λwuk. The term λwuk can be linearized in the same manner as ek = uk (cid:4) previously described let v(cid:6)k = z(cid:6)uk , (cid:6)=1,...,Z. Then by enforcing (cid:6)v(cid:6)k, together with the additional four constraint sets on the v(cid:6)kvariables, we can replace any occurrence in the form of expression (b) with uk. The four additional constraint sets necessary to enforce the equality of c(cid:6)k = z(cid:6)ek , (cid:6)=1,...,Z and v(cid:6)k = z(cid:6)uk , (cid:6)= 1,...,Z, respectively, are 0 c(cid:6)k  ek and ek 4(1 z(cid:6)) c(cid:6)k 4z(cid:6) (for c(cid:6)k), and 0 v(cid:6)k  uk and uk Mk(1 z(cid:6)) v(cid:6)k  Mkz(cid:6) (for v(cid:6)k), where Mk is a large enough constant upper bounding uk. (cid:6)=12 Z After the aforementioned discretization-linearization procedure is performed, we obtain a linear mixed 0 1 programming problem, which can be tackled utilizing any standard MIP solver, e.g. CPLEX (ILOG, 2007). Each solution in our computational experiments was obtained within 30 min using a Dual-core Intel Xeon machine with 3 GB of RAM.
3.2 Avoiding over-ﬁtting We use the MIP formulation to optimize a 12 parameter interaction code (six H-bonds, ﬁve desolvation penalties and the water factor λw), mapping the 35 mutants of EGR ﬁnger I (Liu and Stormo, 2005). In Figure 4, we compare the MIP solution to the parameters obtained based on Equation (2), i.e. directly reading the interactions from well-deﬁned mutants [no optimization see (Temiz and Camacho, 2009)], as well as the corresponding correlation coefﬁcient R2. It is important to stress that these parameters are all fundamental interactions (H-bonds and desolvation energies), including the novel water accessibility factor λw that corresponds to an implicit solvation parameter.
For a 12 parameter representation, we obtain a correlation coefﬁcient R2 = 0.99857.
Upon inspection of the results, one immediately notices possible correlations on the parameters that in hindsight could easily correspond to chemically equivalent interactions.
Hence, the power of our MIP formulation is perhaps best reﬂected in that testing this possibility, say, whether the desolvation penalty of an unmatched NH (δNH) is half that of a NH2 (δNH2) group, is as simple as introducing one additional constraint, i.e. δNH2 = 2δNH. The new set of parameters with now 11 parameters is shown in Figure 4, resulting in a R2 = 0.99855.
Further analysis of the code in Figure 4 suggests an equivalence between a single H-bond of Arg-G and a Arg-phosphate DNA backbone H-bond, followed by matching the Arg-A and Arg-G bonds by simply scaling the bonds according with the AMBER (Cornell et al., 1995) partial charges of the different nucleotides A and G. The elimination of these two free parameters yields an almost identical R2 value.
Although the chemistry behind the H-bonds Gln = A and Asn = A is identical, our parameters suggest that the Gln = A bonds are slightly weaker, consistent with the extra entropy loss entailed by the larger Gln side chain.
Nevertheless, we assess the impact of equating the strength of these two sets of H-bonds, obtaining almost no change in the quality of our predictions.
Finally, equating an oxygen desolvation from Asp, Gln and Asn results in a seven parameter potential with R2 = 0.9983, as compared with the same parameters decoded from Equation (2) using individual mutants R2 = 0.9975.
Optimization of minimum set of protein DNA interactions Fig.5.
Predictions of  Gbind in independent validation datasets of ﬁngers II and III mutants of EGR. R2 correlation coefﬁcient of predicted and experimental changes in binding afﬁnities for MIP solutions with different number of parameters.
Open spheres and open squares show correlation coefﬁcients for ﬁnger II and III mutants of EGR, respectively.
Solid sphere and solid square show the original predicted correlation coefﬁcient (Temiz and Camacho, 2009). The two symbols for six parameters correspond to whether a H-bond or a desolvation penalty is further eliminated as a free parameter.
by which we minimize error, as well as the quantity and accuracy of experimental data.
While minimizing the L2-norm (least squares) is a standard means to minimize residual error, our alternate choice to minimize the L1-norm (least absolute values) is also a widely accepted approach to minimize error, and has the further advantage of making our formulation more amenable to the subsequent linearizations that we implement.
A distinct advantage of our applied exact solution technique versus other possible heuristic approaches is that it guarantees the global optimality of the obtained solution for the considered mathematical programming formulation, rather than just an adequate solution.
Hence, our contribution for this paper is at least as much the introduction of the novel MIP optimization approach to solve such problems, as it is in getting deﬁnitive results on the protein DNA interactions with the initial dataset we solved.
3.3 Avoiding under-ﬁtting Numerically, the formulation would allow us to continue eliminating parameters.
However, contrary to a neural net or a scoring function where parameters do not have a clear meaning, here there is no intuition to equate, say, the magnitude of the Gln = A H-bonds of  0.90 kcal/mol and the NH2 + 0.95 kcal/mol desolvation penalty.
On the other hand, further equating parameters of the same type (either H-bonds or desolvation) are detrimental to the mapping of the binding data (Figs 4 and 5). It is important to point out that the assessment of whether the representation under-ﬁt the data depends on the expected accuracy.
It is quite possible that, as more high-quality binding data is available, mapping some of the small differences that were inconsequential for the present analysis might subsequently turn out to be statistically signiﬁcant. 3.4 Submodel reassessment and validation based on MIP-optimal parameters the different set of optimized parameters against We test two independent sets of ﬁnger II and III mutants that were not part of the MIP optimization process.
Predictions of the complex structures and binding afﬁnities on these validation datasets resulted in correlations of R2 = 0.97 (Fig. 5 and Supplementary Figure S1). Although these correlations are good, they are not as good as EGR ﬁnger I.
One reason is that homology submodels for ﬁngers II and III are naturally 323 Fig.4.
Convergence of MIP optimization code based on EGR mutants of ﬁnger I.
Top panel shows the R2 correlation coefﬁcient as a function of the number of parameters.
Lower panel displays changes in the optimal parameters as equivalent parameters are collapsed into one.
For comparison, we show the results of (Temiz and Camacho, 2009) with no optimization (boxed points and black square). The two symbols for six parameters correspond to whether a H-bond or a desolvation penalty is further eliminated as a free parameter.
It is important to emphasize that the solutions of the MIP formulation not only extract an accurate interaction code but also predict the interaction submodels that minimize the binding free energy of each complex.
For instance, for 12 parameters, the combination of submodels V in Figure 2 minimized the free energy, whereas for 9 parameters submodels II are selected.
It is only with seven parameters that the MIP solution converged to the pair of submodels in I.
The shift from one set of optimal submodels to another is expected.
In fact, this is what makes the problem of optimizing a structure-based energy score difﬁcult (i.e. different set of parameters lead to possibly different minima). However, contrary to other methods, our approach beneﬁts from searching for the optimal solution among a set of feasible pre-deﬁned structures (e.g. Fig.3) such that predictions are at least consistent with known protein DNA structures.
Besides eliminating parameters, our approach could as easily eliminate mutants.
Supplementary Table S1 shows the MIP results for seven parameters after the systematic elimination of all seven ﬁnger I complexes used to map the original code, demonstrating the underlying consistency of the parameters and not just the fact that we have already found a good solution based on selected mutants.
Moreover, we note that for all the MIP solutions, the submodels that optimized the objective function did not change.
Our approach to reduce over-ﬁtting is somewhat similar to iterative backward elimination, a standard technique in regression to remove superﬂuous parameters.
However, this phenomenon is virtually impossible to eliminate.
The results of any such prediction technique which minimizes the distance between observed and ﬁtted values (including our MIP formulation) are fundamentally inﬂuenced by multiple factors, including the criteria in general  N.A.Temiz et al. Fig.6.
Re-examining context-dependent solvation effects in ﬁnger II mutants of EGR. (A) Changes in solvation patterns for ﬁnger II mutants.
First column shows the ﬁnger I crystal complex of Q (dark boxes) and D (light boxes) binding modes (Elrod-Erickson et al., 1998). Second column shows the original solvation patterns (Temiz and Camacho, 2009) and third column shows the updated solvation patterns (this study). (B) Cartoon of the updated submodel QGDR/GCA complex.
DNA is shown in dark sticks.
Asp+3 is shown in light sticks.
Crystal waters are shown as spheres.
Dashed lines indicate H-bond interactions.
Gln-1 and Arg+6, shown in light sticks, protect Asp+3 from solvation. Light colored numbers are predicted afﬁnities using optimized code (in parenthesis are afﬁnities based on unoptimized code, and black numbers are predicted and experimental relative afﬁnities. less reliable than those of ﬁnger I, since most of our templates are from ﬁnger I co-crystals.
Since placing water molecules in a protein interface is still a challenging problem (Bonvin et al., 1998 Dennis et al., 2000), it is not surprising that some of the largest deviations between predicted and experimental binding afﬁnities were in submodels where water molecules play a critical role modulating the interactions (Fig. 6). This problem is compounded by context-dependent effects from adjacent ZFs (Liu and Stormo, 2008 Pabo et al., 2001 Segal et al., 1999). This is the case of the binding modes that have a Gln or Asp at pos. 1 that show different solvation patterns in the ﬁnger I crystals and in the validation dataset for ﬁnger II models.
Crystal structures (Elrod-Erickson et al., 1998) show side chains at pos. 1 are partially solvated, while the binding interfaces at pos. +3 and +6 are desolvated, relative to WT (see shaded and open triangles). Similar submodels for ﬁnger II (Temiz and Camacho, 2009) reﬂected the excess of water molecules at pos. +3 and +6 observed in the WT ﬁnger II crystal structure, and the extra protection of side chains at pos. 1 relative to WT ﬁnger I that has solvent at its 5 Based on the increased accuracy of the MIP formulation, we found that predictions for at least two of these original submodels became worse.
Close inspection of these models led to a reassessment of the solvation patterns, leading us to conclude that bonds at pos. +3 might not be as solvated as expected.
For instance, Figure 6B shows a new submodel of QGDR/GCA using the crystal waters visible in WT, where the Asp+3-C H-bond is 3 Å away from the closest water molecule.
Moreover, contrary to our earlier submodels, we now estimate that the extra waters modeled in complexes involving purines, as in QSNR/GAA, are blocked by the Ser+2-C H-bond (cid:10) (but not necessarily by the Ser+2-A in ﬁnger III). Thus, the Gln 1 bonds are now desolvated as in QGDR/GCA. Something similar occurs with Asp 1-C in the D binding mode.
As shown in Figure 6A, these updated solvation patterns in the new submodels are not only more consistent among each other but also have greatly improved end.
(cid:10) (cid:10) 324 some of the worst predictions in (Temiz and Camacho, 2009). Using Equation 2, the new relative afﬁnities (in red in updated submodels) lead to  Gs of 0.65, 1.82 and 0.58 for the three ﬁnger II mutants QGDR/GCA, QSNR/GAA and DGNR/GAC compared with the experimental values of 0.95, 1.77, 0.71, respectively.
Overall, the correlation coefﬁcient R2 of ﬁnger II mutants improved from 0.957 to 0.971.
4 CONCLUSION Our understanding of how transcription factors work cooperatively to regulate gene expression is still in its infancy.
A major challenge for computational biology in the coming years is to develop tools that help us understand the molecular basis of how transcription factors identify and bind their multiple targets.
The most important missing pieces of this puzzle are the lack of a quantitative understanding of protein DNA interactions and experimental techniques that can account for DNA speciﬁcity. Here, we demonstrate that the problem of decoding protein DNA interactions using a pre-selected set of feasible homology submodels is particularly suited to be tackled via a method involving mixed integer programming.
Speciﬁcally, the MIP solution of the interaction code for C2H2 ZF transcription factors resulted in an almost exact mapping of the change in binding free energies of a set of 35 mutants of EGR ﬁnger I, as well as that of two validation sets of mutants of ﬁngers II and III of EGR (Fig. 5 and Supplementary Figure S1). It is also clear that using MIP can further expedite the discovery and validation of relevant parameters by providing an efﬁcient tool to optimize the increasing complexity of the objective function that minimizes the difference between the predicted lowest binding free energy submodel of each complex and experimental data.
Three key advantages of our mathematical formulation are its inherent ﬂexibility, extensibility and scalability. Thus, as we receive or gather more complete information in the form of new crystals or binding data, results can be automatically updated and re-optimized, eliminating the need for manual intervention of every ZF and ensuring an optimal prediction power.
The removal of constraints and variables from our representation is just as important as their addition.
As shown here, a given solution can suggest the convergence of physical parameters, which can reduce the number of parameters by simply enforcing a new relationship.
Doing so lowers the available degrees of freedom in our representation, resulting in a more compact interaction code less prone to over-ﬁtting. Here, the convergence of the interactions as the number of free parameters were reduced strongly support the universality of the selected physical parameters, which include three H-bonds, three desolvation penalties and a water factor.
Other interactions can now be further built based on other sets of mutants (e.g. from ﬁnger III) to obtain a more complete representation of possible interactions.
It is important to stress, however, that the combination of high-quality crystal structures and binding data of ﬁnger I mutants of EGR is not available for other ZFs. Our unique methodology also eliminates most false positives by scoring the lowest binding free energy submodel in each complex, signiﬁcantly limiting the effect of missing the true complex structure by simply selecting a related feasible submodel belonging to the same funnel (see Figs 3 and 6). Moreover, close inspection of outliers can be used as a self consistent proof checking of initial submodels. Such a feedback was used in Figure 6 to suggest new  submodels for ﬁnger II mutants, and, in all likelihood, should prove useful elucidating other context-dependent effects from adjacent ZFs or DNA, which are quite subtle to generalize.
In summary, the combination of biochemical data, structural information and the described MIP mathematical framework, provides an easily scalable and efﬁcient tool for the (i) automatic selection of exactly one submodel for each complex (ii) each selected submodel has the lowest energy for each complex and (iii) parameters as well as selected submodels provide the closest ﬁt to the experimental data for the considered objective function with minimum over-ﬁtting. Funding: National Science Foundation (MCB-0744077 to C.J.C., CMMI0825993 to O.A.P.) US Air Force Ofﬁce of Scientiﬁc Research (FA95500810268 to O.P.) US Department of Education Graduate Assistance in Areas of National Need Fellowship Program (P200A060149 to A.T.). Conﬂict of Interest: none declared.
REFERENCES Bae,K.H. et al. (2003) Human zinc ﬁngers as building blocks in the construction of artiﬁcial transcription factors.
Nat. Biotechnol., 21, 275 280.
Bonvin,A.M. et al. (1998) Water molecules in DNA recognition II: a molecular dynamics view of the structure and hydration of the trp operator.
J. Mol. Biol., 282, 859 873.
Bueno,M. and Camacho,C.J. (2007a) Acidic groups docked to well deﬁned wetted pockets at the core of the binding interface: a tale of scoring and missing protein interactions in CAPRI. Proteins, 69, 786 792.
Bueno,M. et al. (2007b) SIMPLE estimate of the free energy change due to aliphatic mutations: superior predictions based on ﬁrst principles.
Proteins, 68, 850 862.
Camacho,C.J. et al. (2006) Scoring a diverse set of high-quality docked conformations: a metascore based on electrostatic and desolvation interactions.
Proteins, 63, 868 877.
Camenisch,T.D. et al. (2008) Critical parameters for genome editing using zinc ﬁnger nucleases. Mini.
Rev.
Med.
Chem., 8, 669 676.
Cornell,W.D. et al. (1995) A 2Nd generation force-ﬁeld for the simulation of proteins, nucleic-acids, and organic-molecules.
J.
Am.
Chem.
Soc., 117, 5179 5197.
Dennis,S. et al. (2000) Continuum electrostatic analysis of preferred solvation sites around proteins in solution.
Proteins, 38, 176 188.
Dundas,J. et al. (2007) Topology independent protein structural alignment.
BMC Bioinformatics, 8, 388.
Elrod-Erickson,M. et al. (1998) High-resolution structures of variant Zif268-DNA complexes: implications for understanding zinc ﬁnger-DNA recognition.
Structure, 6, 451 464.
Elrod-Erickson,M. et al. (1996) Zif268 protein-DNA complex reﬁned at 1.6 A: a model system for understanding zinc ﬁnger-DNA interactions.
Structure, 4, 1171 1180.
Ernst,J.A. et al. (1995) Demonstration of positionally disordered water within a protein hydrophobic cavity by Nmr. Science, 267, 1813 1817.
Optimization of minimum set of protein DNA interactions Floudas,C. and Pardalos,P. (2000) Optimization in Computational Chemistry and Molecular Biology: Local and Global Approaches.
Kluwer Academic Pub.
Dordrecht, Netherlands. Floudas,C. and Pardalos,P. (2009) Encyclopedia of Optimization.
Springer, New York. Fung,H. et al. (2005) Computational comparison studies of quadratic assignment like formulations for the in silico sequence selection problem in de novo protein design.
J. Comb.
Optim., 10, 41 60.
Glover,F. and Kochenberger,G. (2003) Handbook of Metaheuristics. Kluwer Academic Publishers, Dordrecht, Netherlands. ILOG (2007) CPLEX 11.0 User s Manual.
ILOG CPLEX Division.
Incline Village, NV. Kang,J.S. (2007) Correlation between functional and binding activities of designer zinc-ﬁnger proteins.
Biochem. J., 403, 177 182.
Laity,J.H. et al. (2001) Zinc ﬁnger proteins: new insights into structural and functional diversity.
Curr. Opin. Struct. Biol., 11, 39 46.
Liu,J. and Stormo,G.D. (2005) Quantitative analysis of EGR proteins binding to DNA: assessing additivity in both the binding site and the protein.
BMC Bioinformatics, 6, 176.
Liu,J. and Stormo,G.D. (2008) Context-dependent DNA recognition code for C2H2 zinc-ﬁnger transcription factors, Bioinformatics, 24, 1850 1857.
Mendez,R. et al. (2005) Assessment of CAPRI predictions in rounds 3-5 shows progress in docking procedures.
Proteins, 60, 150 169.
Morozov,A.V. et al. (2005) Protein-DNA binding speciﬁcity predictions with structural models.
Nucleic Acids Res., 33, 5781 5798.
Nemhauser,G. and Wolsey,L. (1988) Integer and Combinatorial Optimization.
Wiley, New York. Pabo,C.O. et al. (2001) Design and selection of novel Cys2His2 zinc ﬁnger proteins.
Annu. Rev.
Biochem., 70, 313 340.
Pardalos,P. and Resende,M. (2002) Handbook of Applied Optimization.
Oxford University Press, New York. Pavletich,N.P. and Pabo,C.O. (1991) Zinc ﬁnger-DNA recognition: crystal structure of a Zif268-DNA complex at 2.1 A.
Science, 252, 809 817.
Pavletich,N.P. and Pabo,C.O. (1993) Crystal structure of a ﬁve-ﬁnger GLI-DNA complex: new perspectives on zinc ﬁngers. Science, 261, 1701 1707.
Prasad,J.C. et al. (2003) Consensus alignment for reliable framework prediction in homology modeling.
Bioinformatics, 19, 1682 1691.
Prokopyev,O. et al. (2005) On multiple-ratio hyperbolic 0-1 programming problems.
Pac. J. Optim. 1/2, 327 345.
Segal,D.J. et al. (2006) Structure of Aart, a designed six-ﬁnger zinc ﬁnger peptide, bound to DNA. J. Mol. Biol., 363, 405 421.
Segal,D.J. et al. (1999) Toward controlling gene expression at will: selection and design of zinc ﬁnger domains recognizing each of the 5 -GNN-3 DNA target sequences.
Proc. Natl Acad. Sci.
USA, 96, 2758 2763.
Siggers,T.W. et al. (2005) Structural alignment of protein DNA interfaces: insights into the determinants of binding speciﬁcity. J. Mol. Biol., 345, 1027 1045.
Temiz,N.A. and Camacho,C.J. (2009) Experimentally based contact energies decode interactions responsible for protein-DNA afﬁnity and the role of molecular waters at the binding interface.
Nucleic Acids Res., 37, 4076 4088.
Vazirani,V. (2001) Approximation Algorithms.
Springer, Berlin. Wolfe,S.A. et al. (2000) DNA recognition by Cys2His2 zinc ﬁnger proteins.
Annu. Rev.
Biophys. Biomol. Struct., 29, 183 212.
Wu,T.-H. (1997) A note on a global approach for general 0 1 fractional programming.
Eur. J. Oper. Res., 101, 220 223.
325
