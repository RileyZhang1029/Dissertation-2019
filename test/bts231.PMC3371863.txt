Copyedited by: ZAZA MANUSCRIPT CATEGORY: BIOINFORMATICS Vol.28 ISMB 2012, pages i163 i171 doi:10.1093/bioinformatics/bts231 Detection of allele-speciﬁc methylation through a generalized heterogeneous epigenome model Qian Peng 1,2, and Joseph R. Ecker 2,3,4 1Department of Computer Science and Engineering, University of California-San Diego, 9500 Gilman Drive, La Jolla, CA 92093 and 2Plant Biology Laboratory, The Salk Institute for Biological Studies, La Jolla, CA, 92037, USA. 3Genomic Analysis Laboratory, The Salk Institute for Biological Studies, La Jolla, CA, 92037, USA. 4Howard Hughes Medical Institute, The Salk Institute for Biological Studies, 10010 North Torrey Pines Road, La Jolla, California 92037, USA ABSTRACT Motivations: High-throughput sequencing has made it possible to sequence DNA methylation of a whole genome at the single- base resolution.
A sample, however, may contain a number of distinct methylation patterns.
For instance, cells of different types and in different developmental stages may have different methyl- ation patterns.
Alleles may be differentially methylated, which may partially explain that the large portions of epigenomes from single cell types are partially methylated, and may have major effects on transcriptional output.
Approaches relying on DNA sequence polymorphism to identify individual patterns from a mixture of heterogeneous epigenomes are insufﬁcient as methylcytosines occur at a much higher density than SNPs. Results: We have developed a mixture model-based approach for resolving distinct epigenomes from a heterogeneous sample.
In particular, the model is applied to the detection of allele-speciﬁc methylation (ASM). The methods are tested on a synthetic methylome and applied to an Arabidopsis single root cell methylome. Contact: qpeng@cs.ucsd.edu 1 INTRODUCTION The advancement of high-throughput sequencing has opened up many important areas of applications, one of which is epigenome sequencing.
DNA methylation may repress or activate transcription, and is known to be involved in embryogenesis, genomic imprinting and tumorigenesis in mammals, and transposon silencing in plants (Bestor, 2000 Li et al., 1992 Lippman et al., 2004 Rhee et al., 2002 Zhang et al., 2006 Zilberman et al., 2007). To understand the regulation and dynamics of DNA methylation, the locations of the modiﬁed cytosines need to be identiﬁed. The ﬁrst single-base resolution mappings of DNA methylation were produced for the whole Arabidopsis thaliana genome (Cokus et al., 2008 Lister et al., 2008) and for selected subsets of sites in the mouse genome (Meissner et al., 2008) using various bisulﬁte sequencing technologies.
DNA methylation is the modiﬁcation of DNA base cytosine (methylcytosine). A map of DNA methylation at single-base resolution is referred to as methylome or epigenome. Cells of different types and in different developmental stages may have different methylation patterns.
It has been observed that large portions of the Arabidopsis methylomes are partially methylated (Lister et al., 2008). This may be as a result of the  To whom correspondence should be addressed.
sample containing a number of distinct methylomes. Aberrant methylation is also a general feature of cancer genomes.
A better understanding of methylation patterns in cancer genomes may lead to both new diagnostic markers and therapies based on the detection of methylation changes occurring early in tumorigenesis (Laird, 2003). In a tumor tissue particularly of an early stage, however, cancerous cells and normal cells are often mixed together.
DNA methylation patterns can also act as markers for tracing stem cell expansion and tumor growth (Kim et al., 2005 Shibata and Tavaré, 2006 Yatabe et al., 2001). Making use of methylation patterns in this way requires determining methylation patterns associated with individual cells or cells from the same clone.
When comparing human ﬁbroblast cell IMR90 and H1 embryonic stem cell (ESC) lines, it is observed that IMR90 has a lower level of methylation than H1 ESC (Lister et al., 2009). Both IMR90 and H1 are of a single cell type.
While it is expected that large portions (80%) of the X chromosome are partially methylated as the IMR90 cell line is from a female and the DNA methylation is known to play an important role in X chromosome inactivation (Riggs, 1975), it is unexpectedly observed that around 38% of IMR90 autosomes are identiﬁed as partially methylated domains (PMD). What is the nature of partial methylations in a single cell type Might allelic differences contribute to the partial methylations Answering these questions requires detecting allele-speciﬁc methylation (ASM) patterns.
The methylcytosine is sometimes referred to as the ﬁfth DNA base (Lister and Ecker, 2009). Applying methods for detection of single nucleotide polymorphism (SNP) to methylation, however, may present difﬁculties. Methylcytosine is much more dynamic than nucleotides and observations generally suggest that methylation of a cytosine site is a statistical event.
Unlike SNPs where a nucleotide occurs at a rate of 0, 50 or 100% in a diploid individual (if sequencing errors may be ignored), the methylation level at a particular site may fall anywhere in the range from 0% to 100%. Whether a methylcytosine is allele-speciﬁc therefore cannot be determined by the site alone.
It needs supporting evidence from the neighboring nucleotides. If a partially methylated cytosine is in the close vicinity of a SNP such that reads are long enough to cover both sites, then it is straightforward to determine from which allele the reads are originated thus determining the methylation level of the respective alleles.
Some studies have shown that ASM is associated with SNPs (Kerkel et al., 2008 Shoemaker et al., 2010). The density of methylation across the whole genome, however, is much higher than that of DNA sequence polymorphism. For instance, while there are close to 3 million SNPs discovered in the human genome 62 million and 45 million methylcytosines were detected in H1 and  The Author(s) 2012.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i163 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Q.Peng and J.R.Ecker IMR90 cells (Lister et al., 2009). It has also been observed that changes in cytosine methylation occur at a frequency much greater than that of the DNA sequence mutations (Ossowski et al., 2010 Schmitz et al., 2011). As a result, SNPs are absent in large portions of the methylomes. We will describe a method in this article that detects ASM without the assistance of SNPs. In addition, even though the functionalities of ASM are not well understood except that they play an important role in imprinting (Hellman and Chess, 2007 Kerkel et al., 2008), it seems that the methylation level of an individual cytosine is less important than the overall levels of methylations within a region, which is also in contrast to the SNPs. We, therefore, focus our effort in detecting regions of ASM. The remainder of the article is organized as follows.
A mixture model is described in Section 2 for modeling the outcome of a methylation sequencing experiment where the sample may contain a mixture of heterogeneous epigenomes. It aims at predicting methylation levels for each cytosine in each individual epigenome. Section 3 lays out the details for detecting regions of ASM based on the mixture model and validates the methods on a synthetic methylome. The methods are then applied to an Arabidopsis root cell methylome and the results are listed in Section 4.
Section 5 discusses the results and offers some future directions.
2 A MIXTURE MODEL FOR HETEROGENEOUS EPIGENOMES In bisulﬁte sequencing experiments, DNA fragments are treated with sodium bisulﬁte. The process converts unmethylated cytosines into uracils. The sequence of nucleotides (reads) in the converted fragments are subsequently determined by a sequencer.
The reads produced by the sequencer are aligned to a reference genome.
Usually only uniquely mapped reads are retained.
As a result, what we have is a set of reads that are most similar in sequence to their respective mapped locations in the reference genome, which are presumably the genomic origins of the fragments that produced the reads.
In addition, each cytosine on every mapped read is labeled as either methylated or unmethylated. The methylation level of a particular cytosine is computed as follows: if there are x reads that map to the position, and y out of the x reads have at this position a methylcytosine, then the methylation level is y/x. Note that if the read depth at a cytosine position is below a certain threshold, which is determined by the allowed false positive rate, the methylation is not called, i.e. y=0. (Lister et al., 2008) If the original sample is composed of a mixture of epigenomes, be it from a set of different cell types, tissues or alleles, the mapped reads will reﬂect the mixture.
Our goal is to infer the original makeup of the mixture from the mapped reads.
It should be noted that the attainment of the goal depends on whether the original epigenomes are sufﬁciently heterogeneous so that we may distinguish them.
As we are only concerned with methylation, we restrict the reads to the genomic positions where the methylation level is greater than zero.
The epigenomes and reads may be represented as binary strings, where methylcytosine is set to 1 and the remainder to 0.
Let R be a set of binary strings, which we assume are the reads produced by a bisulﬁte sequencing experiment further restricted to methylation sites.
For string r R, let xri be the letter appearing at position i from r let [ra,rb] be the positions that r spans.
Let C= cj j=1  k be the set of natural frequencies of epigenomes, i164 where cj is the frequency of the j-th epigenome, and k is the total number of epigenomes. When the model is used to detect the ASM of a diploid organism, k equals to 2.
Let M = mij i=1  n,j=1  k , where mij is the probability of methylation of epigenome j at position i, and n is the length of the epigenome. The probability of observing string r is P(r)= k(cid:2) j=1 cjprj, where prj is the probability that string r originates from epigenome j, and mijxri+(1 mij)(1 xri) (1) (cid:5). prj = rb(cid:3) (cid:4) i=ra The probability of observing the set R is therefore P(r), (cid:3) P(M ,C,R)= r R (cid:2) r R or equivalently the log likelihood l(M ,C,R)= logP(r). The optimization goal is to determine parameters C and M such that the probability of observing the set R is maximum, thus best explaining the reads.
We estimate array C and matrix M by maximizing the likelihood l, (cid:2) r R argmaxM ,C logP(r), which can be solved by using the expectation-maximization (EM) algorithm (Dempster et al., 1977). First, we deﬁne a membership matrix where arj = A= arj r R,j=1...k , (cid:6) 1 if r j, 0 if r / j.
As the membership of string r with respect to epigenome j is unknown, it is estimated by its expected value as.
arj = cjprj(cid:7) j(cid:5) cj(cid:5) prj(cid:5) k(cid:2) (cid:2) The likelihood can then be rewritten as l(M ,C,R,A)= r R j=1 k(cid:2) (cid:2) r R j=1 and the optimization becomes argmaxM ,C arj log(cjprj), Solving the maximization constrained by update equations at each M-step iteration of the EM algorithm as follows (see Appendix A for the detailed derivation), (cid:7) (cid:7) (cid:7) r arj j(cid:5) arj(cid:5) r cj = , mij = arj log(cjprj). k (cid:7) j=1 cj =1 yields the (cid:7) r arjxri(cid:7). r arj When the algorithm converges, the matrix M contains the predicted methylation levels for each epigenome in the mixture.
(2) (3) [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i164 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: 3 DETECTION OF ASM In this section, we describe how the model is used to detect allele-speciﬁc methylated regions in a diploid organism.
Notice that ASM is not a precisely deﬁned term.
It generally refers to a signiﬁcant difference between the methylation levels of the two alleles.
First, the methylome of a diploid individual is scanned for partially methylated regions (PMRs) as candidates for further analysis.
Second, for each candidate region, the reads that align to this region are computationally assigned to the two alleles and the methylation levels of individual cytosines from each allele are estimated.
Last, regions are classiﬁed to allele-speciﬁc or non- speciﬁc methylated regions, based on read assignments and the predicted methylation levels from the previous step.
A synthetic methylome is used to test the model and to illustrate the details of each step.
We remark that determining whether a read along with its methylcytosines has a higher probability to originate from one allele or the other relies on the differences between the reads, i.e. the methylation states of the cytosines on the reads.
The density of methylcytosines of a genome relative to the read length in a sequencing experiment is therefore critical.
For instance, if, on average, a read covers at most one methylcytosine, then there is very little hope to deconvolve the allelic methylation states without additional information.
While anticipating the rapid growth of the read length in high-throughput sequencing technology, we ﬁrst tested our method on Arabidopsis thaliana, which has a reasonably high methylation density.
The median genomic distance, for instance, between consecutive methylcytosines on Chromosome 1 of A. thaliana Col-0 is 15, while the typical read length of an Illumina sequencer is between 100 and 150 bp presently.
3.1 Identify PMRs as candidates To detect ASM regions, the whole methylome is scanned for PMRs as candidates, as there is obviously not much difference between the two alleles if the methylation level of a region is near nil or complete.
A contiguous methylated region (CMR) refers to a genomic region where the genomic distance between any two consecutive methylcytosines is no larger than a separation threshold s, which is set at around a width comparable to the read length.
Each CMR is scanned with a ﬁxed-width sliding window where the window width is the number of methylcytosines. A ﬁxed-width window inside a CMR is classiﬁed as a PMR if no fewer than 90% of the methylcytosines are at most 70% methylated (Lister et al., 2009). A PMR may be called with or without a speciﬁc lower bound for methylation levels.
In the data we have analyzed, the average level of methylations in a CMR is at least 25%, due to that (i) the region has contiguous methylcytosines (ii) the allowed false positive rate for calling a methylcytosine (Lister et al., 2008) in combination with the sequencing coverage dictates an implicit lower bound on the methylation levels.
Consecutive PMRs within the same CMR are merged into a single region.
The dataset being tested is a synthetic methylome that is made up by combining the reads of two methylomes from Arabidopsis root cells: epidermis (Wer+) and endodermis (Scr+). The root cells are obtained by ﬂow sorting their methylomes by MethylC-Seq bisulﬁte sequencing (Lister et al., 2008). The genomic length of the reads is 83 bp. The reads from one cell type in the mixture are treated as if they are from one allele of the synthetic methylome. The ASM Detection of Allele-Speciﬁc Methylation Table 1.
Samples of partially methylated regions for classiﬁcation  20 mC NS CS  35 mC NS CS  50 mC NS CS Samples Training Testing 255 100 255 100 42 19 44 21 10 6 10 6 mc: methylcytosine CS: cell-speciﬁc NS: non-speciﬁc of the synthetic methylome is, therefore, simulated by cell-speciﬁc methylation in the mixture.
Forward strand and reverse strand are processed separately.
As ASM and cell-speciﬁc methylation arise from different the patterns of differential methylations biological processes, might, therefore, carry signatures unique to each type.
The aforementioned synthetic methylome is appropriate for testing cell- speciﬁc methylations yet whether it is a good surrogate for testing ASMs may be questioned.
We argue that since the classiﬁcation is largely based on overall methylation levels within a region rather than relations among methylation levels of individual cytosine sites, the criteria similarly apply to both cell-speciﬁc methylation and ASM. The separation threshold s is set to 100 bp. Each CMR is scanned with a sliding window of width 20, 35 and 50 methylcytosines respectively.
Each PMR in the synthetic methylome is labeled as either cell-speciﬁc (allele-speciﬁc), if no fewer than 90% cytosines in the region are methylated in only one of the two cells, or non- speciﬁc otherwise.
For the purpose of learning, consecutive windows within the same CMR are merged into one region only if they are labeled as the same type.
For a sliding window of width 20, both cell-speciﬁc regions and non-speciﬁc regions have a median width of 23 methylcytosines. All of the cell-speciﬁc regions and around the same number of randomly selected non-speciﬁc regions are kept as samples for further analysis.
The samples are divided into training and testing samples (Table 1). 3.2 Predict allelic methylation levels For each PMR, the algorithm described in Section 2 is applied with k=2. For each sample of the synthetic methylome, the reads from the two individual methylomes are mixed together.
One potential problem with the EM algorithm is that it may converge to a local optimum.
There are various ways to initialize the parameters.
One initialization is to randomly assign each read to a cluster, i.e. set arj =1 at probability 1/k. Another option is to set cj =1/k, and then randomize matrix M.
A third option is to randomize the membership matrix A, which appears to be the best option after testing with simulated data.
We run the algorithm L times, each with a new random matrix A as the initialization.
Let A1, A2,...,AL be the membership matrix when each individual run converges, from which two new initializations are derived: AL+1 and AL+2, for two additional runs.1 They are deﬁned as 1A subtlety here concerns the ordering of the clusters at the end of each run.
The details are omitted.
i165 [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i165 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Q.Peng and J.R.Ecker Fig.1.
Experimental (a and b) versus predicted (c and d) methylation levels of the synthetic methylome. Experimental methylation levels from Wer+ are shown in circles, Scr+ in stars.
Two symbols in the bottom ﬁgures (c and d) indicate two predicted individual methylomes for the synthetic methylome. The left (a and c) is of an allele-speciﬁc region: chromosome 1: [7313026, 7313482] on forward strand.
The region contains 50 methylcytosines (mC) 160 reads are aligned to this region.
The right (b and d) is of a non-speciﬁc region: chromosome 3: [12698733, 12699133] on forward strand.
The region contains 42 mC 367 reads are aligned to the region aL+1 follows: for r R, j=1...k, L(cid:2) i=1 1 if j=argmaxk 0 otherwise.
= 1 (cid:6) L aL+2 ai rj =   rj rj j(cid:5)=1(aL+1 rj(cid:5) ) Of the total L+2 runs, the one that converges to the largest likelihood is selected.
The matrix M yields a predicted level of methylations at each cytosine site.
Figure 1 illustrates two samples of PMRs from the synthetic methylome: one cell-speciﬁc and the other non-speciﬁc. Both experimental and predicted methylation states are shown.
The experimental data are from the individual methylomes and are thus treated as golden.
The predicted methylation states are used for further classiﬁcation. 3.3 Classify candidate regions with a support vector machine classiﬁer Once the methylation levels of individual methylcytosines in each allele are estimated and the membership of reads predicted by the model, what remains is to characterize and classify each region based on the estimations.
Recall that we used a rather simplistic rule to automatically label the samples in the synthetic methylome when i166 preparing the training and testing samples.
The labels are derived from the knowledge of the two individual methylomes making up the synthetic methylome, and therefore are independent of the predictions made by the mixture model.
One option is to use the same rule to classify a region from predicted methylation levels.
We hope to capture more characteristics of the two classes, however, so multiple measures are employed for this task when it is applied to the real epigenome. We also use the synthetic methylome to train a support vector machine (SVM) classiﬁer that is later used for a real single cell methylome. Notice that the value arj gives the probability that the read r is from allele j.
If a read needs to be assigned to a single allele, it should be assigned to the j that has the larger value of arj, or formally, to cluster jr =argmaxj(arj). The features for SVM are extracted from the estimated methylation levels (M ) and allele frequencies (C). A total of nine features are used (details omitted due to exigencies of space). Both linear and radial basis function (RBF) kernels are tested the latter yield better performance.
Five-fold cross-validation is used to select the best parameters for the kernel function from each training set.
The testing results are shown in Table 2.
In some of the false positive (FP) samples, both cells have completely unmethylated reads and these reads are clustered together in the synthetic methylome, which are then classiﬁed as allele-speciﬁc (cell-speciﬁc). We hypothesize that these regions have ASM in both individual cell types.
[11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i166 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Table 2.
Testing results for classiﬁcation of partially methylated regions Samples CS  20 mC NS  35 mC NS CS  50 mC NS CS Predicted CS Predicted NS 88 (TP) 12 (FN) 13 (FP) 87 (TN) 17 2 3 18 5 1 1 5 Accuracy 87.5% 87.5% 83.3% CS: cell-speciﬁc NS: non-speciﬁc Table 3.
Classes based on differential averaged methylation Class name d [0.0,0.2] (0.2,0.9) Moderately differentially methylated [0.9,1.0] Highly differentially methylated Similarly methylated Label ds dm dh Table 4.
Predicted ASM regions Method svm lmr dmr mww Intersection Detection of Allele-Speciﬁc Methylation 4 DETECT ASM REGIONS FOR ARABIDOPSIS EPIDERMIS METHYLOME The methods are applied to the methylome of a single cell type, a root epidermis (Wer+) cell from A. thaliana Col-0.
There are a total of 452 partially methylated regions as deﬁned in Section 3.1.
The total genomic length of the regions is 84 397 bp, covering 9980 methylcytosines. The 22926 reads are aligned to these regions.
Once the methylation levels of the two alleles and the membership of all reads are predicted by the models, the results are subject to four methods for classiﬁcation as mentioned in Sections 3.3 and 3.4.
Recall that the SVM model is trained on the synthetic methylome made up of two Arabidopsis root methylomes, Wer+ being one of them.
Table 4 shows the number of PMRs predicted to be allele- speciﬁc by each method and the intersection is taken so as to obtain the most conservative predictions.
The ﬁrst two rows of the table reﬂect the intersections taken between the dh class and all other criteria, and dm class and other criteria, respectively, totaling 34 regions.
Table 5 lists the details and annotations for group (1), and Table 6 for group (2). Based on the predicted methylation levels, both groups are highly allele-speciﬁc. While one of the two alleles has nearly no methylation, in the ﬁrst group of 18 regions, the other allele is in general highly methylated and in the second group of 16 regions, the methylated allele is more partially methylated. An example from each group is shown in Figure 2.
If the criteria for ASM are relaxed a bit by removing the rather stringent ﬁlter lmr, many more regions [the last row (3) in Table 4] are admitted Regions 277 (cid:2) (cid:2) dh: 19 362 39 (cid:2) dm: 368 (cid:2) (cid:2) dm 18(1) 16(2) 192(3) Table 5.
Predicted ASM regions, group (1) in Table 4 ch Coord start Coord end No.of mC str Gene model 3.4 Identify ASM regions with multiple ﬁlters Using an SVM classiﬁer has its limitations.
A classiﬁer trained on one organism will certainly not be appropriate for other organisms.
A classiﬁer trained on one cell type may be questionable for another very different type.
When parameters for the sequencing experiment change, the classiﬁer should be retrained.
In addition, there may not be sufﬁcient data samples for learning at all.
Additional measures are therefore necessary for real data.
The Mann Whitney Wilcoxon (mww) test is performed on the two clusters resulting from the mixture model.
If the null hypothesis is rejected, one cannot readily claim that the methylations are allele- speciﬁc. But if on the other hand the null hypothesis is not rejected, it is unlikely that the methylations are allele-speciﬁc. Two additional ﬁlters are based on methylation rates.
One ﬁlter is called low methylation rate (lmr). It computes whether one of the two clusters is 10% methylated at 80% sites.
The other is called differential averaged methylation rate (dmr). The averaged methylation rate for each cluster in the region is deﬁned as n(cid:2) i=1 rj = 1 n mij mi1+mi2 , and the differential averaged methylation as d = r1 r2. We deﬁne three classes based on this measure shown in Table 3.
1 1 1 1 1 2 2 2 3 3 4 4 4 4 5 5 5 5 6173395 17295458 17824930 18450185 21929675 6173517 17295563 17825022 18450342 21929885 7089119 7340522 7089281 7340662 14386759 14387012 12092053 16726743 12092151 16726938 2367251 10912792 2367352 10913005 11932172 11932467 13269127 5128508 13269376 5128716 8215115 22267311 8215303 22267477 26117272 26117538 20 24 20 20 21 21 23 23 20 29 20 25 24 28 22 24 25 20 +  AT1G17940  AT1TE57315  + AT1TE59180  +  AT1TE61145 +  AT1G59660  AT1G59670  AT2G16380 3 UTR + + AT2TE29970  AT2G16930 +  AT2G34060  AT2G34070  AT3TE50300  +   AT3G45570 AT3TE67795 + +  AT4G04670 +  AT4G20210  AT4TE50030  AT4TE55215   AT4G22690  AT4G22700  AT4TE62330  AT5TE18530 +  AT5G15725 + AT5TE29690  +  AT5TE80145 +  AT5G54810 AT5TE94040 + ch: chromosome str: strand  : upstream  : downstream Signs in the last column indicate opposite strands.
i167 [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i167 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Q.Peng and J.R.Ecker Table 6.
Predicted ASM regions, group (2) in Table 4 ch Coord start Coord end No.of mC 1 1 1 2 2 2 3 3 3 3 4 4 5 5 5 5 18054504 21249227 29696108 2168534 11844725 11844762 10865759 12092064 16266681 16934173 4097347 4547945 13812896 15205421 15268332 17406449 18054609 21249472 29696354 2168695 11844944 11845016 10866031 12092269 16266822 16934369 4097458 4548048 13813035 15205719 15268498 17406557 20 20 26 21 20 25 21 25 21 20 20 39 21 23 21 22 ch: chromosome str: strand  : upstream  : downstream Signs in the last column indicate opposite strands.
str  + +    + + +  +  + +  + Gene model  AT1G48820 +  AT1G48810 AT1TE70195  AT1TE70200   AT1G78960 AT2TE09960  AT2G05752 AT2TE51520  AT2G27780 AT2TE51520  AT2G27780  AT3TE45185  AT3TE50300  AT3TE65915   AT3G44718  AT3TE68630 +  AT3G46110 +  AT4TE17760 AT4TE19110  AT4G07747 AT5TE49235  AT5TE55020 AT5TE55235  AT5G38220 + AT5TE62865  Fig.2.
Read assignments (a and b) and methylation levels (c and d) of the predicted ASM regions of Arabidopsis Wer+ cell.
Circle and star symbols in c and d represent two alleles.
Lines in top (a and b) ﬁgures are restricted reads (solid and dotted lines represent two alleles) small diamonds on lines are methylations. Left (a and c) : a region of Table 4(1): chrom 4: [13269127, 13269376]  strand.
Right (b and d) : a region of Table 4(2): chrom 5: [17406449, 17406557] + strand i168 [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i168 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Detection of Allele-Speciﬁc Methylation Table 8.
GO annotation summary for protein coding genes in Table 7 Functional category Gene body Upstream Downstream Unknown cellular components Chloroplast Other intracellular components Other cellular components Other cytoplasmic components Other membranes Nucleus Plastid Plasma membrane Unknown molecular functions Other enzyme activity Other binding Protein binding Transferase activity Other molecular functions Transferase activity Transporter activity Hydrolase activity DNA or RNA binding Nucleotide binding Other metabolic processes Unknown biological processes Other cellular processes Response to stress Response to abiotic or biotic stimulus Transcription,DNA-dependent Protein metabolism Transport 2 2 2 2 3 2 1 1 2 5 3 1 2 8 1 4 4 1 Others 10 15 8 6 7 6 4 2 5 3 12 7 6 4 4 5 1 3 3 3 19 17 18 5 5 3 5 1 15 16 6 6 6 4 3 5 1 3 19 8 6 3 4 2 4 12 18 12 7 6 4 1 4 10 5 CONCLUSION AND DISCUSSION We have described a computational model for resolving distinct epigenomes from a heterogeneous sample.
In particular, we applied this model to identify allele-speciﬁc methylated regions.
The reads from potentially multiple epigenomes are mapped to a common reference genome.
The goal is essentially to infer the distinct methylation patterns from the mapped reads.
Our approach is different from previous attempts in that it does not rely on SNPs, which are few and far between when compared with methylcytosines. The model was tested on a synthetic methylome. The classiﬁcation based on the mixture model in conjunction with an SVM classiﬁer yielded an accuracy of 87.5%. Even though the SVM approach is not always applicable to real methylomes, since all the features are derived from the predicted methylation levels and cluster frequencies, the test results reﬂect the reliability of the predictions made by the model.
Additional multiple ﬁlters for ASMs may further reduce the number of false positives.
Additional approaches may be employed to validate the methods for ASM detection.
One approach is to use ASMs determined with SNP data as ground truth, although such data are presently sparse and anecdotal.
Another approach to validate ASM is to use heritable epi-alleles in combination with phasing information obtained from crossing of plants.
i169 Fig.3.
An example from Table 4 group (3): region: chrom 1: [77393, 77508]  strand, 20 mC. (a) reads assignments.
(b) predicted methylation levels Table 7.
Annotation summary of all ASM regions in Table 4 Annotation Overlap Upstream Downstream Protein coding gene TE gene Pseudogene mi, t, other RNA Transposon (only) (cid:5) 4 (4) exon 9 (7) intron 1 (1) 3 UTR 19 (8) 2 1 66 (39) 50 (24) 56 (25) 11 (3) 2 5 (2) 4 (1) 3 3 Numbers in parenthesis are on the opposite strands.
Upstream and downstream are within 1kb. for further examination.
An example from this group is shown in Figure 3.
Table 7 summarizes the TAIR9 annotations (TAIR, 2009) for all three groups of a total of 226 predicated ASM regions.
Many regions overlap with natural transposons as expected the last row in the table reports the number of regions that have no other annotation than transposon. For the protein coding genes, the gene ontology annotations are summarized in Table 8.
One region from group (3), on forward strand of chromosome 1: 11267775  11268327, is on the antisense of an exon of protein coding gene AT3G29360, an imprinted gene in A. thaliana seed reported by McKeown et al. (2011). The region has 26 methylcytosines. [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i169 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Q.Peng and J.R.Ecker We applied the methods to regions of the genome with relatively high density of methylcytosines with each region being treated independently.
By taking advantage of pair-end reads and other information, it will also be possible to do phasing and extend and connect the regions.
Our model assumes that methylations are independent of each other.
Methylations in some regions have a tendency to occur in clusters, which indicates a certain dependency.
While our model gives a reasonably good ﬁrst-order approximation, Markov chain-based models perhaps may be explored to take the dependency into consideration.
Identifying ASM is still only at initial research stages.
Another direction for future research is to focus on understanding the functionalities of ASM, for instance, how they are related to allele-speciﬁc expression.
More complicated heterogeneous epigenome samples may arise from a mixture of various cell types, or a mixture of cancerous cells at various stages, which present yet more and greater challenges than the allelic methylations of a diploid cell.
Such samples will enable an ultimate test for the power of the methods.
The initial steps are to develop scenarios and criteria for validation as it becomes less obvious what deﬁnes cell-speciﬁc methylations in the context of multiple cell types.
ACKNOWLEDGEMENT We would like to thank Drs Ryan Lister and Ronan O Malley from the Salk Institute for providing the experimental data, and Professor Sanjoy Dasgupta from UC-San Diego for insightful discussions.
Funding: This work was supported by the Howard Hughes Medical Institute and the Gordon and Betty Moore Foundation to JRE. JRE is an HHMI-GBMF Investigator.
Conﬂict of Interest: none declared.
REFERENCES Bestor,T.H. (2000) The DNA methyltransferases of mammals.
Hum.
Mol. Genet., 9, 2395 2402.
Cokus,S.J. et al. (2008) Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning.
Nature, 452, 215 219.
Dempster,A. et al. (1977) Maximum likelihood from incomplete data via the EM algorithm.
J. R. Stat.
Soc.
Ser. B, 39, 1 38.
Hellman,A. and Chess,A. (2007) Gene body-speciﬁc methylation on the active X chromosome.
Science, 315, 1141 1143.
Huala,E. et al. (2001) The Arabidopsis Information Resource (TAIR): a comprehensive database and web-based information retrieval, analysis, and visualization system for a model plant.
Nucleic Acids Res., 29, 102 105.
Kerkel,K. et al. (2008) Genomic surveys by methylation-sensitive SNP analysis identify sequence-dependent allele-speciﬁc DNA methylation. Nat. Genet., 40, 904 908.
Kim,J.Y. et al. (2005) Counting human somatic cell replications: Methylation mirrors endometrial stem cell divisions.
Proc. Natl.
Acad. Sci.
USA, 102, 17739 17744.
Laird,P.W. (2003) The power and the promise of DNA methylation markers.
Nat. Rev.
Cancer, 3, 253 266.
Li,E. et al. (1992) Targeted mutation of the DNA methyltransferase gene results in embryonic lethality. Cell, 69, 915 926.
Lippman,Z. et al. (2004) Role of transposable elements in heterochromatin and epigenetic control.
Nature, 430, 471 476.
Lister,R. and Ecker,J.R. (2009) Finding the ﬁfth base: Genome-wide sequencing of cytosine methylation. Genome Res., 19, 959 966.
Lister,R. et al. (2008) Highly integrated single-base resolution maps of the epigenome in Arabidopsis. Cell, 133, 523 536.
Lister,R. et al. (2009) Human DNA methylomes at base resolution show widespread epigenomic differences.
Nature, 462, 315 322.
McKeown,P. et al. (2011) Identiﬁcation of imprinted genes subject to parent-of-origin speciﬁc expression in arabidopsis thaliana seeds.
BMC Plant Biol., 11, 113. i170 Meissner,A. et al. (2008) Genome-scale DNA methylation maps of pluripotent and differentiated cells.
Nature, 454, 766 U91. Ossowski,S. et al. (2010) The rate and molecular spectrum of spontaneous mutations in Arabidopsis thaliana. Science, 327, 92 94.
Rhee,I. et al. (2002) DNMT1 and DNMT3b cooperate to silence genes in human cancer cells.
Nature, 416, 552 556.
Riggs,A. (1975) X inactivation, differentiation, and DNA methylation. Cytogenet. Cell Genet., 14, 9 25.
Schmitz,R.J. et al. (2011) Transgenerational epigenetic instability is a source of novel methylation variants.
Science, 334, 369 373.
Shibata,D. and Tavaré,S. (2006) Counting divisions in a human somatic cell tree: How, what and why Cell Cycle, 5, 610 614.
Shoemaker,R. et al. (2010) Allele-speciﬁc methylation is prevalent and is contributed by CpG-SNPs in the human genome.
Genome Res., bf 20, 883 889.
Yatabe,Y. et al. (2001) Investigating stem cells in human colon by using methylation patterns.
Proc. Natl.
Acad. Sci.
USA, 98, 10839 10844.
Zhang,X. et al. (2006) Genome-wide high-resolution mapping and functional analysis of DNA methylation in Arabidopsis. Cell, 126, 1189 1201.
Zilberman,D. et al. (2007) Genome-wide analysis of Arabidopsis thaliana DNA methylation uncovers an interdependence between methylation and transcription.
Nat. Genet., 39, 61 69.
APPENDIX A Section 2 described the model for a mixture of epigenomes. This section details the derivation of the update equations at each M-step iteration for the EM algorithm.
Recall from Section 2 that the optimization goal is to determine the methylation probability matrix M and the epigenome frequency array C such that the likelihood l(M ,C,R,A) as deﬁned by Equation (3) is maximized given the set of observed restricted reads R. The membership matrix A is estimated by Equation (2) at each iteration.
As the maximization of likelihood l(M ,C,R,A) is constrained by k j=1 cj =1, i.e. the epigenome frequencies sum up to 1, we will introduce Lagrange multiplier λ and maximize the unconstrained function (cid:7) l(M ,C,R,A,λ)= arj log(cjprj) λ cj 1   k(cid:2) j=1  . (cid:2) r R k(cid:2) j=1 Substituting in prj given by Equation (1), we have   k(cid:2) j=1   cj 1 (cid:5) mijxri+(1 mij)(1 xri)   k(cid:2)    l= = = (cid:4) arj log k(cid:2) (cid:2) (arj logprj+arj logcj) λ r R j=1 k(cid:2) (cid:2) rb(cid:2) i=ra r R j=1 k(cid:2) (cid:2) arj logcj λ + r R j=1 k(cid:2) rb(cid:2) (cid:2) i=ra r R j=1 k(cid:2) (cid:2) arj logcj λ r R j=1   k(cid:2) j=1 j=1 + arj (cid:4) cj 1 cj 1  .
xri logmij+(1 xri)log(1 mij) (cid:5) [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i170 i163 i171  Copyedited by: ZAZA MANUSCRIPT CATEGORY: Maximizing l with respect to M ,C,λ by setting the respective partial derivatives to zero yields the following set of equations =0 (cid:13) (cid:12)  l mij =0    xri mij  1 xri 1 mij arj arj(xri mij)=0, (cid:2) (cid:2) (cid:2) r r =0   l cj arj cj  cj = 1 r λ  λ=0 (cid:2) arj, r Detection of Allele-Speciﬁc Methylation  l λ (cid:2) =0   j  λ= (cid:13) =1 arj (cid:12) (cid:2) 1 λ (cid:2) (cid:2) r arj. r j Solving for mij and substituting in λ for cj lead to the update equations at each M-step iteration of the EM algorithm as follows, (cid:7) r arjxri(cid:7) r arj mij = cj = , (cid:7) (cid:7) (cid:7) r arj j(cid:5) arj(cid:5) r.
i171 [11:32 31/5/2012 Bioinformatics-bts231.tex] Page: i171 i163 i171 