BIOINFORMATICS ORIGINAL PAPER Vol.25 no.16 2009, pages 2126 2133 doi:10.1093/bioinformatics/btp278 Gene expression KIRMES: kernel-based identiﬁcation of regulatory modules in euchromatic sequences Sebastian J. Schultheiss1,2, , Wolfgang Busch2, , Jan U. Lohmann2,3, Oliver Kohlbacher4 and Gunnar Rätsch1 1Friedrich Miescher Laboratory of the Max Planck Society, 2Max Planck Institute for Developmental Biology, Tübingen, 3Department of Stem Cell Biology, University of Heidelberg and 4 Wilhelm Schickard Institute for Computer Science, University of Tübingen, Germany Received on October 31, 2008 revised on March 16, 2009 accepted on April 21, 2009 Advance Access publication April 23, 2009 Associate Editor: Trey Ideker ABSTRACT Motivation: Understanding transcriptional regulation is one of the main challenges in computational biology.
An important problem is the identiﬁcation of transcription factor (TF) binding sites in promoter regions of potential TF target genes.
It is typically approached by position weight matrix-based motif identiﬁcation algorithms using Gibbs sampling, or heuristics to extend seed oligos. Such algorithms succeed in identifying single, relatively well-conserved binding sites, but tend to fail when it comes to the identiﬁcation of combinations of several degenerate binding sites, as those often found in cis- regulatory modules.
Results: We propose a new algorithm that combines the beneﬁts of existing motif ﬁnding with the ones of support vector machines (SVMs) to ﬁnd degenerate motifs in order to improve the modeling of regulatory modules.
In experiments on microarray data from Arabidopsis thaliana, we were able to show that the newly developed strategy signiﬁcantly improves the recognition of TF targets.
Availability: The python source code (open source-licensed under GPL), the data for the experiments and a Galaxy-based web service are available at http://www.fml.mpg.de/raetsch/suppl/kirmes/ Contact: sebi@tuebingen.mpg.de Supplementary information: Supplementary data are available at Bioinformatics online.
1 INTRODUCTION One of the most important problems in understanding transcriptional regulation is the prediction of transcription factor target genes based on their promoter sequence.
A transcription factor binding site (TFBS) is a short sequence segment ( 10 bp) located near a gene s transcription start site and is recognized by respective transcription factors (TFs) for gene regulation (Gupta and Liu, 2005). TFBSs recognized by the same TF usually show a conserved pattern, which is often called a TF binding motif (Gupta and Liu, 2005). Such binding motifs are typically identiﬁed through ﬁnding overrepresented motifs in promoter sequences of a set of genes that is enriched with targets for a speciﬁc TF. The simplest approaches  To whom correspondence should be addressed.
Present Address: Biology Department, Duke University, Box 90338, Durham, NC 27708, USA include the identiﬁcation of overrepresented oligomers relative to a background model (Bailey and Elkan, 1994). More sophisticated models include Gibbs sampling methods (Lawrence et al., 1993) that try to identify position weight matrices (PWMs), cf.
e.g. Schneider et al. (1986), which characterize binding sites in the candidate promoter sequences (Stormo, 2000). Although these methods have been very successful for bacterial and yeast genomes, their success was limited in higher eukaryotes for which TF binding motifs are often degenerate and the search space is considerably larger.
While some recent techniques have improved the state-of-the-art, they all tend to fail if the motif is deﬁned only weakly or found solely in the context of other motifs.
Despite these challenges, there are two possible redeeming factors: (i) many eukaryotic genomes have been or are being sequenced, and comparative genomic analysis can be extremely powerful and (ii) most eukaryotic genes are controlled by a combination of factors with the corresponding binding sites forming homotypic or heterotypic clusters known as cis-regulatory modules (CRMs) (Gupta and Liu, 2005). In this work, we want to exploit these redeeming factors and thus have developed novel methods that are able to classify genes as being either targets of the (combination of) TFs being studied or not, based on the presence of motifs and features capable of describing CRMs. This was implemented as a two-step procedure.
We ﬁrst used de novo motif ﬁnding tools or known motif databases like transfac (Matys et al., 2003) or jaspar (Sandelin et al., 2004) to identify a set of potential motifs.
Then, we used support vector machines (SVMs) employing a newly developed kernel, called the regulatory modules (RM) kernel, that is capable of capturing information about the motifs and their relative location to classify promoter sequences.
Additionally, we demonstrate the potential of our approach to exploit conservation information to improve the classiﬁcation performance.
Most previous approaches to discover CRMs are based on the identiﬁcation of motifs and their co-occurrences, e.g. Frith et al. (2008) and Sinha and Tompa (2002). Other approaches exploit site-clustering information with de novo motif discovery to build rules discriminating modules that preserve the ordering of motifs, e.g. Segal and Sharan (2005). Finally, Yada et al. (1998) suggested to use hidden Markov models to represent CRMs and Gupta and Liu (2005) developed a Monte Carlo method  2009 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2126 2126 2133  and dynamic programming approach to screen motif candidates.
The main difference between our approach and most previous approaches is that we use discriminative methods to analyze CRMs, not just an individual TFBS. In particular, instead of using zeroth- order inhomogeneous Markov chains, we use support vector kernels to model higher order sequence information around candidate TFBS. This manuscript is organized as follows: we start Section 2 by describing the basic methodology of classifying sequences with SVMs using standard sequence kernels.
It is followed by a detailed explanation of the main idea of this work in Sections 2.3 and 2.4, to combine de novo motif ﬁnders with state-of-the-art motif modeling.
In Section 3.2, we outline a problem derived from Arabidopsis thaliana microarray expression experiments, with loss or gain of function of certain TFs. In our experiments, we ﬁrst illustrate that the straightforward approaches cannot achieve reasonable results, while the newly developed methods are able to drastically improve the target gene recognition performance.
Finally, the article is concluded with a brief discussion in Section 5.
2 APPROACH SVMs are a well-established machine learning method introduced by Boser et al. (1992), to solve classiﬁcation tasks frequently appearing in computational biology and many other disciplines.
Typical examples are the classiﬁcation of tumor images or gene expression measurements, the detection of biological signals in DNA, RNA or protein sequences as well as the recognition of hand written digits or faces in images.
SVMs are widely used in computational biology due to their high accuracy, their ability to deal with high-dimensional data, and their ﬂexibility in modeling diverse sources of data (Müller et al., 2001 Noble, 2006 Schölkopf and Smola, 2002 Schölkopf et al., 2004). The goal of training an SVM is learning to label a dataset just like the training examples (x(i),y(i)),i=1,...,N. Here, x are the examples (sequences in our case), and y the labels.
For a two-class problem, labels are of the form +1 and 1, where the label +1 is assigned to a sequence x if it is part of the positive gene set, and 1 if it is part of the negative set.
After training, the classiﬁer is able to assign such a labeling to any sequence.
If it is regulated by the same combination of TFs as the training examples, a correctly trained classiﬁer will assign +1 to a sequence, otherwise 1.
The domain knowledge inherent in the classiﬁcation task is captured by deﬁning a suitable kernel function k(x,x(cid:3) ), which computes the similarity between two examples x and x(cid:3). This strategy has two advantages: the ability to generate non-linear decision boundaries using methods initially designed for linear classiﬁers and the possibility to apply a classiﬁer to data that have no obvious vector space representation, for example, DNA/RNA or protein sequences as well as structures (Ben-Hur et al., 2008). Two- class SVMs use a maximum-margin hyperplane that separates the classes of the input vectors in the feature space.
We give an introduction to existing SVM kernels that work on sequences, like the weighted degree (WD) kernel.
Subsequently, we extend the WD kernel in two different ways: ﬁrst, we consider an addition to use conservation information.
Second, given a list of potential motifs, we propose a new kernel that integrates information on the motif sequences with information about their co-occurrence with the aim to characterize RM.
KIRMES 2.1 Spectrum kernel Given two example sequences x and x(cid:3) over the alphabet , a simple way to compute the similarity is to count the number of co-occurring oligomers of ﬁxed length (cid:2). This idea is realized in the so-called spectrum kernel that was ﬁrst proposed for classifying protein sequences by Leslie et al. (2002): (cid:1) (cid:3) (x,x )= kspec (cid:2)  spec (cid:2) (x), spec (cid:2) (x ) , (cid:2) (cid:3) (cid:2) where   is the number of letters in the alphabet.
spec is a mapping of the sequence x into a  (cid:2)-dimensional feature-space.
Each dimension corresponds to one of the  (cid:2) possible strings s of length (cid:2) and is the count of the number of occurrences of s in x.
This kernel is well suited to characterize sequence similarity based on oligos that appear in both sequences independent of their position.
If the classiﬁcation of promoter sequences of genes as TF targets was solely based on binding to speciﬁc oligos, then the spectrum kernel would be a reasonable choice.
If the motif is less conserved, then allowing for mismatches or gaps can be beneﬁcial (Leslie et al., 2003). Note that this kernel is (by design) incapable of recognizing positional preferences TFs, and thus TFBSs, might have relative to the transcription start or among each other.
2.2 WD Kernel The so-called WD kernel proposed by Rätsch and Sonnenburg (2004) computes the similarity of sequences of ﬁxed length L by considering the substrings up to length (cid:2) starting at each position l separately: (cid:5) x[l:l+d]=x (cid:3)[l:l+d] I , (1) (cid:4) (cid:3) kwd (cid:2) (x,x )= L(cid:3) (cid:2)(cid:3) βd d=1 l=1 L (cid:2) d+1 where βd =2 (cid:2)2+(cid:2) , and x[l:l+d] is the substring of length d of x at position l (Rätsch and Sonnenburg, 2004 Sonnenburg et al., 2007b). In the WD kernel, only oligos appearing at the same position in the sequence contribute to the similarity of two sequences.
The WD kernel with shifts (Rätsch et al., 2005), or WDS kernel, is an extension of the WD kernel allowing some positional ﬂexibility of matching oligos: (cid:3) kwds (cid:2),S (x,x )= L(cid:3) l=1 (cid:4)  1 (cid:2)(cid:3) S(cid:3) s=0 d=1 (cid:4) s+i l x[l+s:l+d+s]=x I 2dL(S+1) (cid:3)[l:l+d] (cid:4) (cid:5) + I x[l:l+d]=x (cid:3)[l+s:l+d+s] (2) (cid:5)(cid:5) It considers oligomers up to length d, and allows them to be shifted up to S positions, starting from i, in the input sequences.
This kernel is better suited for motifs with indels or at varying positions see e.g. Rätsch et al. (2005) and Sonnenburg et al. (2007a). The locality improved and oligo kernels by Zien et al. (2000) and Meinicke et al. (2004), respectively, achieve a similar goal in a slightly different way.
2.3 WD kernel with conservation information To include conservation information, we extended the WDS kernel with a term to multiply the score of the local matches of an 2127 [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2127 2126 2133  S.J.Schultheiss et al. Fig.1.
The idea behind the RM kernel: a motif ﬁnder is applied to the regulatory sequences in the input set (long, dark bars), which identiﬁes overrepresented motifs (short, light bars). The best matching motifs (boxed) in every sequence serve as starting points, where we excise a window of 20 bp around the center of each motif occurrence for the WDSC kernel.
Conservation information for these windows is looked up in a precomputed multiple genome alignment (cf. Section S.2 of the Supplementary Material for details on conservation data). Additionally, we construct an input vector for the RBF kernel of the pairwise motif distance, and distance to the transcription start (if available). oligo of length d at position i with a quantity that depends on its conservation.
We propose to use the average conservation of the oligo in pregenerated alignments of sequences from G other organisms: γ A d,i,x =1+ A Gd I(xi+j =xg i+j), (3) G(cid:3) g=1 d(cid:3) j=0 where xg is the sequence of the syntenic regions in the genome of organism g=1,...,G and A 0 is a parameter allowing one to control the importance of the conservation.
We add 1 to not ignore unconserved sequences: ideally, the conservation should only add information by emphasizing the conserved and hence likely functionally important regions of the regulatory sequence.
All results shown were obtained with the setting of A=1. Using this deﬁnition of a conservation score, we can now deﬁne the WD kernel with shifts and conservation (WDSC): (cid:3) kwdsc (cid:2),S,A(x,x )= L(cid:3) l=1 (cid:4)  (cid:2)(cid:3) S(cid:3) s=0 d=1 (cid:4) s+i l x[l+s:l+d+s]=x γd,i,xγd,i,x(cid:3) 2d(S+1) (cid:5) (cid:3)[l:l+d] I (cid:4) +I x[l:l+d]=x (cid:3)[l+s:l+d+s] (4) (cid:5)(cid:5) The above kernel, like the WDS kernel, corresponds to a feature space spanned by all possible k-mers at every position.
While the feature value is 1 for the WDS kernel if the k-mer is present at a certain position, for the WDSC kernel the feature value is γd,i,x, i.e. it is computed depending on the conservation of the k-mer at this position.
2.4 A kernel for regulatory modules Suppose we are given a set of M motifs Mm, m=1,...,M, which may either come from a database or from a de novo motif detection method.
Such motifs are often represented in a way that one can easily scan a given sequence for occurrences of the motif (e.g. as PWMs). In a preprocessing step, we compute the best matching position pm,x(i) of each motif Mm in all considered sequences x(i),i=1,...,N. In case of PWMs, the PWM score (Schneider et al., 1986) and in case of oligo-based motifs, the Hamming distance may be used to decide which position in the sequence matches best.
We use MotifScanner from the inclusive package by Thijs et al. (2002) to scan sequences for the best matching occurrence of a PWM in case of an oligomer, we use a regular expression pattern with 2128 decreasing discriminative power to ﬁnd the closest match.
In case of a tie, the last match in the sequence is selected.
2.4.1 Kernel for multiple motifs For the kernel functions, all input vectors need to be of the same length.
Therefore, we have to choose the same number of matches per sequence for all motifs (1 in our case), regardless of the quality of the matches, as shown in Figure 1.
Biologically, a threshold quality seems more intuitive.
Then, several good matches would be considered, or no match for sequences that do not contain the motif.
However, a soft margin during training allows the algorithm to ignore some mislabeled data points, i.e. sequences that do not contain the motif, without strong effects on generalization.
A soft margin SVM uses a slack variable ξ and can tolerate training data points that, e.g. clearly lie in the space of the class they do not belong to without skewing the separating hyperplane in order to correctly classify such outliers.
This allows the SVM to separate data that would not be linearly separable when using a hard margin, usually achieves a better classiﬁcation result due to a smoother hyperplane, and makes the SVM more robust against noisy data (Schölkopf and Smola, 2001). Similar ideas have been proposed and successfully used in image analysis, using kernel methods where motifs correspond to points of interest, e.g. sharp edges (Mikolajczyk et al., 2005 Nowak et al., 2006). )=(cid:6) The main idea of the kernel that we propose is to represent an input sequence x by the set of sequences xm:=x[pm,x w,pm,x+w] originating from the region of length 2w around the best motif match pm,x of motif Mm in x.
Each sequence region xm contributes independently to the similarity between two input sequences: k1(x,x(cid:3) m). This term characterizes the co-occurrence of a collection of motifs in two sequences x and x(cid:3). The similarity is highest if all motifs appear in both sequences (in arbitrary order). We propose to use a position-speciﬁc string kernel, for instance the WDSC kernel, to compute the similarity of the regions.
m=1 k(xm,x(cid:3) M information For the position of the motif does not the ﬁrst part of 2.4.2 Modeling positional the kernel, inﬂuence the similarity at all, since the motif windows have been extracted from the input sequence.
the kernel, the best motif we try to capture the relative position of matches to each other and to the transcription start site, if available.
This is achieved by computing all pairwise distances In the second part of [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2128 2126 2133  between match positions of motifs: v(x)=(cid:7) (cid:8)(cid:5) p1,x ptss,...,pM,x ptss,p1,x p2,x,...,pi,x pj,x,...,pM 1,x pM,x , for all i(cid:6)= j= 1,...,M, where ptss is the position of the transcription start site in the sequence.
A simple way of computing the similarity between two such vectors is to use the radial basis function (RBF) kernel, e.g. Schölkopf and Smola (2002): )=exp (cid:7)v v(cid:3)(cid:7)2 (cid:3) krbf σ (v,v (cid:10) (cid:9) , σ where σ is a kernel hyperparameter to be found by model selection.
In the kirmes pipeline (described below), we create one string kernel per motif, with all the windows where the motif occurs as input data and sum them up to a combined kernel, and add an RBF kernel for all pairwise positions.
Having both parts of the kernel deﬁned, the question how to combine them remains.
We propose to simply add both contributions in the RM kernel: (cid:3) krm (cid:2),S,A,σ (x,x )= wm kwdsc (cid:3) (cid:2),S,A(xm,x m) (cid:3) σ (v,v ) (5)   +krbf   M(cid:3) m=1 Here, wm are the weights assigned to the subkernels kwdsc, which are all set to 1 per default, and xm is the best match of motif Mm in the sequence x.
Please note that if we add the kernels, it amounts to concatenating the feature spaces.
If one multiplied the contributions of distances and motif-sequence similarity, the kernel would be in some sense similar to the previously proposed oligo kernel (Meinicke et al., 2004). In our case, this would not be feasible, since we want to inspect the kernel contributions independently and determine the sequence logo that each string kernel uses to discern the two input classes.
Therefore, we want a clear distinction between the contributions of the positional kernel part and the motif part of the kernel.
3 METHODS 3.1 kirmes pipeline Below, we introduce an integrated python pipeline, called kirmes, using the previously described kernels to classify promoter regions of genes as targets of a certain combination of TFs (i.e. as co-regulated). We outline a use case with a scenario where this pipeline can be applied.
DNA sequences considered in the input sets can come from any part of the euchromatin, e.g. upstream and downstream regions of a gene, intronic and exonic parts, as well as untranslated regions (UTR) in the 3 direction, each of arbitrary length.
The selection of this region depends on the organism the data stems from for the use case, we will assume this to be A.thaliana, where good results can be obtained with a combination of upstream, UTR and intronic sequences.
We used 1000 bp upstream of the transcription start in general, longer sequences introduce more noise.
In organisms with shorter promoters a reduction would be beneﬁcial for the signal-to-noise ratio.
or 5 (cid:3) (cid:3) Figure 2 shows an outline of the pipeline for the classiﬁcation of promoter sequences based on microarray experiments (cf. Section 3.2). In the ﬁrst step, there is a chocie between several 3.1.1 Initial motif ﬁnding methods to identify candidate motifs.
Initially, we used a common Gibbs sampling algorithm (Lawrence et al., 1993) called MotifSampler from the inclusive package by Thijs et al. (2002) that ﬁnds overrepresented motifs Mm, m=1,...,M and creates subkernels for up to M motifs.
To make sure we do not include motifs that are too common, we use several strategies: KIRMES Fig.2.
A cartoon workﬂow of the kirmes pipeline: the preprocessing step requires the genomic sequence and a set of regulatory sequences from genes that were determined to be co-expressed in microarray experiments, and ideally a negative set.
kirmes conducts a motif ﬁnding step, where it locates the positions of overrepresented motifs in fasta ﬁles of the genes regulatory region.
For the classiﬁcation, we build an input vector with sequence sections of 20 bp, centered around the motif positions obtained during the motif ﬁnding step, and optional conservation information from related genome sequences for the WDSC kernel, as described in Section 2.3.
The classiﬁer is trained on the labeled dataset of positives and negatives and can then be applied repeatedly on unlabeled prediction datasets to classify genes as co-regulated by the same mechanism as the input dataset or not.
ﬁrst, a background model for this organism second, minimum occurrences were set to 15 % or three genes of the set, whichever is more third, 1000 random gene sets were generated and searched for motifs of the same length and determinacy. This was measured through the information content of the position frequency matrix of the motif, an output of the Gibbs sampling program.
Since this last step takes a signiﬁcant amount of time depending on the length and number of sequences, we searched for alternatives.
We settled on one approach, where we count the occurrence of any oligomer of length six in positive sequences (oligo counting). We selected a subset of those oligomers that appear in at least 15% of all positive sequences.
This simple strategy certainly leaves room for improvements, but our experiments in Section 3.2 illustrate that it already works rather well.
3.1.2 SVM training We use the large-scale machine learning toolbox shogun at http://www.shogun-toolbox.org (Sonnenburg et al., 2006) through its python interface.
It provides implementations of all kernels described in this work and allows for fast training using several different SVM implementations, e.g. SVMlight (Joachims, 1999). As described in Section 2.4, we create a kernel for every candidate motif Mm and use a window of 20 bp around each occurrence in every sequence.
We tested different widths 2129 [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2129 2126 2133  S.J.Schultheiss et al. and settled for this length as it gave the highest accurracy for a representative dataset (cf. Supplement S.4 in the Supplementary Material). 3.1.3 Interpretation of results To ﬁnd out which of the candidate motifs Mm, m=1,...,M from the initial motif ﬁnding step contribute the highest discriminative power of the combined RM kernel krmk, we take a look at all the subkernels, each of which describe exactly one motif.
Every subkernel has an assigned weight wm=1  m=1,...,M, as described in Equation (5). If we iterate over all motifs Mm and in turn set wm=0,wi =1 i(cid:6)= m once for every motif Mm and re-evaluate the SVM with the combined kernel krm\ m on the same dataset x, we can obtain a ranked list of all motif kernels: we subtract the new training accuracy from the re-evaluation with one of the weights set to 0 (measured in area under the receiver operating characteristic curve, auROC) from the reference accuracy of the combined kernel with all weights set to 1.
This difference gives us the gain in accuracy for just this motif window.
The subkernels that contribute the largest difference are the most interesting ones for the experiment, since they contain the strongest candidate binding motif.
We then calculate positional oligomer importance matrices developed by Sonnenburg et al. (2008) to obtain a 1mer sequence logo (Schneider and Stephens, 1990) from the kernel that shows the motif that this kernel is attuned to.
This ranked list of motifs, along with the auROC difference, allows for a straightforward interpretation of the kirmes prediction results.
3.2 Microarray expression data We derive sets of co-expressed genes from microarray experiments performed with the commercial Affymetrix GeneChip Arabidopsis ATH1 array.
This chip is designed to measure transcript abundance of more than 20 000 genes of the model organism A.thaliana (Redman et al., 2004). The sets are obtained through a stringent analysis of expression change using the software GeneSpring (Agilent Technologies). We labeled genes as co-expressed when they showed a 4-fold change of expression in the experiment as compared with the control, and considered those genes not co-expressed if their levels remain the same, compared with the control, within a margin of 0.2-fold change.
The fold change is computed from the normalized gene expression level p in treatment and respective control, c: (cid:15) n=  c/p if p/c 1 if p/c 1 p/c In this case, the direction of the change is represented by the sign of n, positive means up and negative means down relative to the control.
If several replicates were available, the mean after normalization is taken for every gene, for all replicates of p and c, respectively.
We used microarray data from two different experimental setups (cf. Section S.1 in the Supplementary Material). The ﬁrst setup uses leaves from wild type A.thaliana plants exposed to medium at 38 C versus leaves exposed to the same medium at room temperature, expression measurement taken 1 h after exposure (Busch et al., 2005). The second setup uses inducible overexpression of Arabidopsis meristem regulators with the AlcR/AlcA system.
Plants harboring 35S::AlcR/AlcA::GOI (gus control, leafy, shootmeristemless, wuschel) constructs were grown in continuous light for 12 days and induced with 1% ethanol.
After 12 h of EtOH treatment, seedlings were dissected and RNA was processed from the shoot apex and from young leaves.
Affymetrix ATH1 arrays were hybridized in duplicates for each gene construct and condition (Leibfried et al., 2005). In total, we considered 14 different gene sets to be discriminated by the methods.
3.3 Use case When a researcher has conducted several microarray experiments and has obtained a list of co-expressed genes that react in concert, ideally over several different experiments, and assumes they are targets of a speciﬁc combination of TFs, kirmes can be used to ﬁnd common motifs in this list and in turn in all other known genes.
The experimental design is cruical for the success of our 2130 method: kirmes will work best if used on gene sets derived from time-series experiments or from loss or gain of function experiments of a speciﬁc gene.
The regulatory sequences of a gene set identiﬁed in such a manner have to be available in fasta format.
The regulatory region can be anything from promoters, introns, to even the whole chromatin, of arbitrary length, and can stem from any organism.
To effectively use the positional information of promoter regions, it is a good idea to select the sequences in such a way that the translation start site is at the same position in each of them.
kirmes assumes that the sequences of regulatory regions are given in two sets: a set enriched with TF targets (labeled positive) and a second set containing no or very few targets (labeled negative). Negative sets could be genes whose expression does not change from the control to the experimental condition, and that are ideally expressed at levels above the microarray detection threshold.
kirmes is available publicly at http://galaxy.fml.mpg.de/, our Galaxy webserver. Galaxy is an open source, scalable framework for tool and data integration developed by Giardine et al. (2005): users can upload their sequence ﬁles kirmes will classify the input gene set and return the names of the co-regulated genes as well as discriminative motifs in a list.
fasta ﬁles of sequences can be uploaded to our Galaxy server, where we use the 6mer oligo-counting strategy and the WDS kernel.
Conservation information is not supported as it depends on the organism from which the sequences were obtained, it may not always be available and would require a signiﬁcantly larger infrastructure.
There is no upper limit on the amount of input sequences in place, but at least ﬁve sequences should be uploaded for cross-validation to work.
In our case, we worked with gene sets from microarray experiments described in Section 3.2.
Here, we were looking for a heat shock element identiﬁed by Leibfried et al. (2005) as well as a binding motif for the TF wuschel in A.thaliana. We made use of the experimental logic to obtain well-suited gene sets (cf. Section S.1 in the Supplementary Material). The user working with kirmes can adjust the number of most discriminative motifs to be reported by the program.
These motifs are ranked according to their contribution towards class discrimination and are good starting points for further expression or binding validation experiments.
After training of a kirmes classiﬁer, a further prediction dataset can be uploaded.
This could for instance be comprised of the same regulatory regions, but this time for all of the annotated genes of this organism.
This is especially useful if some newly discovered genes are not yet represented on the microarray platform the expression experiments were performed with, or they were expressed close to the detection threshold and so cannot be readily excluded from the list of genes whose expression was changed in the experiment.
3.4 Experimental setup To train and test the method and compare it against baseline kernels, we ﬁrst split the data into two parts (80% : 20%). The ﬁrst part is used for motif ﬁnding and SVM training.
For hyperparameter tuning, we used the ﬁrst part with 5-fold cross-validation to ﬁnd the optimal combinations of hyperparameters. (The SVM and the considered kernels have several hyperparameters to be given in advance.
This includes the regularization parameter C of the SVM, the maximal length of oligomers (cid:2) and the maximal shift S considered in the WDS kernel.) The second part is used to estimate the generalization performance.
Here, we measure the auROC as the generalization performance (random guessing corresponds to 50% auROC). The above procedure is repeated ﬁve times for different splits of training and test examples (outer cross-validation loop). As performance measure, we report the average auROC over the ﬁve splits.
To compare our method with the priority algorithm, we used the datasets from yeast chromatin immunoprecipitation experiments on tiling array chips from the extensive study by Harbison et al. (2004). priority was developed by Gordân et al. (2008) and has been applied to this dataset before, but only in comparison to other Gibbs sampling algorithms.
We chose this algorithm [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2130 2126 2133  KIRMES A B Fig.3.
(A) Accuracy of the spectrum and WDS kernels: the prediction is rarely better than random guessing for these kernels.
The kernels are not well-suited for this particular problem.
The names of the gene sets are derived from the tair7 annotation by the Swarbreck,D. et al. (2007) and are explained in detail in Section S.1 of the Supplementary Material.
(B) Accuracy of variations of the kirmes approach: this graph shows a comparison of the basic kernels and the conservation kernels (C) combined with two different motif generation approaches: by oligo-counting (Oligo) or by Gibbs sampling (Gibbs). The average performance (µ) is given for each kernel variant.
The ﬁrst set is taken from a control experiment, where no overrepresented motifs should occur.
to compare our method with because it was tested on exactly the kind of data we recommend to be used with kirmes. The comparison to kirmes is in some ways different to the original setup by Gordân et al. (2008): our method needs labeled information as it is a supervised learning technique.
Thus, we employ a 5-fold cross-validation, as described above.
To make the conditions as comparable as possible, the unsupervised priority will also see only the same 80% split of sequences to ﬁnd an overrepresented motif PWM. We search for the top-ranking PWM reported on the training set in the remaining 20% of the positive and negative sequences and calculate the auROC from the distance of the best motif occurrences in the sequences from the reported PWM. This area is compared with the one reported by the cross-validation run of kirmes. 4 RESULTS The goal is to predict the expression change status of potential target genes for overexpressed TFs based on their promoter sequence, with the datasets and the setup described above.
4.1 Comparison on A.thaliana gene sets In a ﬁrst experiment, we illustrate that simple methods, as for instance SVMs with a spectrum or WDS kernel, cannot easily solve the considered classiﬁcation problem.
The results are given in Figure 3A. We can observe that essentially for all gene sets, an SVM with the spectrum kernel fails to identify positive genes (auROC close to 50%). An SVM with the WDS kernel performs slightly better, but still produces close to random predictions.
In Figure 3B, we present results of the proposed methods in four variants: with motif discovery by Gibbs sampling versus oligo-counting as well as with and without the use of conservation.
We can make the following observations: (i) all four versions show a signiﬁcantly improved performance relative to the base- line methods.
(ii) Motif ﬁnding using oligo-counting seems to work considerably better in combination with SVMs than Gibbs sampling, except on the control.
A possible reason may be that the number of considered oligos M=100,...,200 is higher than the number of motifs generated by the Gibbs sampler, M 50.
(iii) Using conservation as weighting for the WDS kernel considerably improves the recognition performance.
It results in an average performance improvement of 5 percentage points.
4.2 Contribution of vector features To evaluate the contributions of the individual feature types of the input vectors, we used a representative gene set of the A.thaliana experiments for illustration.
We considered different combinations of the feature types of the RM kernel (sequence windows, conservation information and positional information) and observed the classiﬁcation performance.
The results are shown in Figure 4, where each bar corresponds to the auROC after a 5- fold cross-validation with the respective features.
We also analyzed other gene sets (data not shown), and observed that the sequence window feature was consistently the most important feature, while positional information in some cases made a big difference, while in other cases its contribution was neglectable. Positional preference or lack thereof has been studied for many TFs, e.g. by Smith et al. (2007) for the cyclic-AMP response element.
For this TF, position plays a major role in many reported experiments, but there are cases of functional binding sites that have effects on genes many thousands of base pairs away from the binding site (Smith et al., 2007). Therefore, it is not surprising that for some sequences positional information adds no discriminative power, even within the same gene set, and for others it adds more than 10 percentage points.
Conservation always boosts the performance by 5 percentage points (cf. Fig.3). 4.3 Comparison to PRIORITY As described in Section 3.4, we compared kirmes to the state-of- the-art Gibbs sampler priority by Gordân et al. (2008). This setup lets us use priority as a classiﬁer: we measure its performance on a testing set that the Gibbs sampler did not use to build its motif PWM. 2131 [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2131 2126 2133  S.J.Schultheiss et al. Fig.4.
Comparison between the contributions of each feature type of the input vector.
A dataset of 42 positive and 1562 negative genes was used from the A.thaliana experiments.
Box Plot for KIRMES and PRIORITY Cross-validation Runs on 286 Gene Sets from Yeast ChIP-chip Experiments Quartile 1 Minimum Median Maximum Quartile 3 1 0.9 0.8 0.7 0.6 0.5 0.4 e v r u c  C O R e h   t  r e d n u   a e r A PRIORITY KIRMES Fig.5.
Comparison between the Gibbs sampler priority and the kirmes approach for the task of identifying genes regulated by a TF. The box plot shows the average auROC on the 268 gene sets, giving the minimum, maximum, median, ﬁrst and third quartile values (cf. Sections 3.4 and 4.3). That way, we can use the top-scoring PWM from the training set and ﬁnd occurrences in the testing set.
The distance to the PWM of each respective best match is scored.
This score is used to compute a ROC curve.
In Figure 5, we show a box plot on the average auROC of the two approaches on 268 gene sets from Harbison et al. (2004), preprocessed by Raluca Gordân. kirmes is clearly the more accurate classiﬁer, and it can also reveal the motifs it deemed most discriminant.
5 CONCLUSION The results clearly illustrate the power of our approach in exploiting the relationship between motifs as well as conservation to improve the recognition of TF targets.
All four variants signiﬁcantly improve the performance over naïve baseline methods.
The normalization scheme for the multiple genome alignment can be remodeled to take into account evolutionary distances.
The comparison with priority in Figure 5 shows that kirmes is, not surprisingly, a more accurate classiﬁer than this state-of- the-art Gibbs sampler, because it can make use of several motifs and their positional interdependence.
We are not aware of a more similar classiﬁcation program that uses the same type of original data, against which we could have compared kirmes in lieu of priority.
2132 We chose the Gibbs sampling program MotifSampler in our study because it performed best on the A.thaliana data among four compared Gibbs samplers.
It was, however, not included in the comparison of samplers by Gordân et al. (2008). In light of the versatility of kirmes, it would seem pertinent to reinvestigate the performance on a wider selection of data, e.g. by choosing priority as a replacement for the older sampling program or the simplistic oligo-counting method.
For practical purposes, the kirmes algorithm can be applied to any combination of regulatory regions and also any organism.
A researcher may use kirmes to ﬁlter gene sets obtained through statistical methods from expression or binding data.
These sets are usually generated when evaluating microarray expression or binding data, e.g. from analyzing a regulatory network around a TF. Careful experimental design will lead to very concise predictions.
Use of the web service integrated into Galaxy is straightforward and the resulting classiﬁcation may help to select genes that should be investigated further.
kirmes can visualize the central motifs and the area surrounding them that were most discriminant during classiﬁcation this output can serve as a starting point for researchers wanting to investigate the regulatory mechanism that drives the expression changes in the experiments they have conducted.
The output is more valuable than the one shown by a Gibbs sampling algorithm, because the surrounding regions describe the regulatory module to greater detail than the original 6mer would.
Even for experiments where very complex regulatory mechanisms are suspected, kirmes will report at least dominant signatures of the most prevalent mechanism.
Here, careful experimental design and time- series experiments can help to untangle more complex relationships.
In that sense, using kirmes is not the ﬁnal solution when trying to understand regulation, but a tool that can be used to direct the design of further validation experiments.
The use by experimentalists will ultimately determine the utility of this approach and govern the direction of further extensions together with technological advances such as next-generation sequencing methods for transcriptome or protein binding data, or its application to other motif-driven biological processes like alternative splicing.
ACKNOWLEDGEMENTS The authors thank the anonymous reviewers for their helpful suggestions that greatly improved the manuscript.
G.R. would like to thank Gabriele Schweikert for comments on the manuscript.
S.J.S. is indebted to Raluca Gordân for providing data and very helpful comments on comparing our methods.
We thank Sören Sonnenburg for support with the python interface of the shogun toolbox and Alexander Zien for comments on the RM kernel.
Funding: Max Planck Society W.B. is a scholarship holder of the Cusanuswerk J.U.L. is an EMBO Young Investigator.
Conﬂict of Interest: none declared.
REFERENCES Bailey,T. and Elkan,C. (1994) Fitting a mixture model by expectation maximization to discover motifs in biopolymers. In Proceedings of ISMB 94, Vol.2, AAAI Press, Menlo Park, CA, USA. ISCB, pp.
28 36.
Ben-Hur,A. et al. (2008) Support vector machines and kernels for computational biology.
PLoS Comput. Biol., 4, e1000173. [16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2132 2126 2133  KIRMES Boser,B. et al. (1992) A training algorithm for optimal margin classiﬁers. In Proceedings Rätsch,G. et al. (2005) RASE: recognition of alternatively spliced exons in C. elegans. COLT 92.
ACM Press, Pittsburgh, Pennsylvania, pp.
144 152.
Bioinformatics, 21(Suppl. 1), i369 i377. Busch,W. et al. (2005) Identiﬁcation of novel heat shock factor-dependent genes and Redman,J. et al. (2004) Development and evaluation of an Arabidopsis whole genome biochemical pathways in A. thaliana. Plant J., 41, 1 14. affymetrix probe array.
Plant J., 38, 545 561.
Frith,M. et al. (2008) Discovering sequence motifs with arbitrary insertions and Sandelin,A. et al. (2004) Jaspar: an open-access database for eukaryotic transcription deletions.
PLoS Comput. Biol., 4, e1000071. factor binding proﬁles. Nucleic Acids Res., 32, D91 D94. Giardine,B. et al. (2005) Galaxy: a platform for interactive large-scale genome analysis.
Schneider,T.D. and Stephens,R.M. (1990) Sequence logos: a new way to display Genome Res., 15, 1451 1455.
Gordân,R. et al. (2008) A fast, alignment-free, conservation-based method for transcription factor binding site discovery.
In Vingron,M. and Wong,L. (eds), Lecture Notes in Computer Science: RECOMB 2008, Vol.4955, Springer, Heidelberg, pp.
98 111.
Gupta,M. and Liu,J. (2005) De novo cis-regulatory module elicitation for eukaryotic genomes.
Proc. Natl Acad. Sci.
USA, 102, 7079 7084. consensus sequences.
Nucleic Acids Res., 18, 6097 6100.
Schneider,T.D. et al. (1986) Information content of binding sites on nucleotide sequences.
J. Mol. Biol., 188, 415 431.
Schölkopf,B. and Smola,A.J. (2001) Learning with Kernels: Support Vector Machines, Regularization, Optimization, and Beyond.
MIT Press, Cambridge, MA.
Schölkopf,B. and Smola,A. (2002) Learning with Kernels.
MIT Press, Cambridge, MA.
Schölkopf,B. et al. (2004) Kernel Methods In Computational Biology.
MIT Press, Harbison,C. et al. (2004) Transcriptional regulatory code of a eukaryotic genome.
Cambridge, MA.
Nature, 431, 99 104.
Joachims,T. (1999) Making large-scale SVM learning practical.
In Schölkopf,B. et al. (eds), Advances in Kernel Methods - Support Vector Learning.
MIT Press, Cambridge, MA.
Segal,E. and Sharan,R. (2005) A discriminative model for identifying spatial cis- regulatory modules.
J. Comput. Biol., 12, 822 834.
Sinha,S. and Tompa,M. (2002) Discovery of novel transcription factor binding sites by statistical overrepresentation. Nucleic Acids Res., 30, 5549 5560.
Lawrence,C.E. et al. (1993) Detecting subtle sequence signals: a Gibbs sampling Smith,B. et al. (2007) Evolution of motif variants and positional bias of the cyclic-amp strategy for multiple alignment.
Science, 262, 208 214. response element.
BMC Evol. Biol., 7(Suppl. 1), S15. Leibfried,A. et al. (2005) Wuschel controls meristem function by direct regulation of Sonnenburg,S. et al. (2006) Large scale multiple kernel learning.
J. Mach.
Learn.
Res., cytokinin-inducible response regulators.
Nature, 438, 1172 1175.
7, 1531 1565.
Leslie,C. et al. (2002) The spectrum kernel: a string kernel for SVM protein classiﬁcation. In Proceedings of the Paciﬁc Symposium on Biocomputing, World Scientiﬁc, New Jersey, London, Singapore, Beijing, Shanghai, Hong Kong, Taipei, pp.
564 575.
Leslie,C. et al. (2003) Mismatch string kernels for discriminative protein classiﬁcation. Bioinformatics, 20, 467 476.
Matys,V. et al. (2003) Transfac: transcriptional regulation, from patterns to proﬁles. Sonnenburg,S. et al. (2007a) Accurate splice site prediction using support vector machines.
BMC Bioinformatics, 8(Suppl. 10), S7. Sonnenburg,S. et al. (2007b) Large scale learning with string kernels.
In Bottou,L. et al. (eds), Large Scale Kernel Machines, MIT Press, Cambridge, MA, USA, pp.
73 104. importance matrices understanding support vector machine-based signal detectors.
Bioinformatics, 24, 6 14.
(2008) POIMs: positional oligomer Sonnenburg,S. et al. Nucleic Acids Res., 31, 374 378.
Stormo,G.D. (2000) DNA binding sites: representation and discovery.
Bioinformatics, Meinicke,P. et al. (2004) Oligo kernels for datamining on biological sequences: a case 16, 16 23. study on prokaryotic translation initiation sites.
BMC Bioinformatics, 5, 169.
Mikolajczyk,K. et al. (2005) A comparison of afﬁne region detectors.
Int.
J. Comput. Vis., 65, 43 72.
Swarbreck,D. et al. (2007) The Arabidopsis Information Resource (TAIR): gene structure and function annotation.
Nucleic Acids Res., 36(Database issue), D1009 D1014. Müller,K. et al. (2001) An introduction to kernel-based learning algorithms.
IEEE Trans.
Thijs,G. et al. (2002) Inclusive: integrated clustering, upstream sequence retrieval and Neural Netw., 12, 181 201. motif sampling.
Bioinformatics, 18, 331 332.
Noble,W. (2006) What is a support vector machine Nat. Biotechnol., 12, 1565 1567.
Nowak,E. et al. (2006) Sampling strategies for bag-of-features image classiﬁcation. In Yada,T. et al. (1998) Automatic extraction of motifs represented in the hidden Markov model from a number of DNA sequences.
Bioinformatics, 14, 317 325.
European Conference on Computer Vision.
Springer, Heidelberg. Zien,A. et al. (2000) Engineering support vector machine kernels that recognize Rätsch,G. and Sonnenburg,S. (2004) Accurate splice site detection for Caenorhabditis elegans. In Schölkopf,K.T.B. and Vert,J.-P. (eds), Kernel Methods in Computational Biology, MIT Press, Cambridge, MA, USA, pp.
277 298. translation initiation sites.
Bioinformatics, 16, 799 807.
[16:17 14/7/2009 Bioinformatics-btp278.tex] Page: 2133 2126 2133 2133
