BIOINFORMATICS ORIGINAL PAPER Vol.
25 no.
21 2009, pages 2735 2743  doi:10.1093/bioinformatics/btp531  Genome analysis Efﬁciently ﬁnding genome-wide three-way gene interactions from transcript- and genotype-data Mitsunori Kayano1,2, Ichigaku Takigawa1,2, Motoki Shiga1,2, Koji Tsuda2,3 and Hiroshi Mamitsuka1,2,  1Bioinformatics Center, Institute for Chemical Research, Kyoto University, Gokasho, Uji 611-0011, 2Institute for Bioinformatics Research and Development (BIRD), Japan Science and Technology Agency (JST) and 3Computational Biology Research Center, National Institute of Advanced Industrial Science and Technology (AIST), 2-42 Aomi, Koto-ku, Tokyo 135-0064, Japan Received on March 17, 2009  revised on August 6, 2009  accepted on August 25, 2009 Advance Access publication September 7, 2009 Associate Editor: Alfonso Valencia  i.e.
two interacting genes in expression under  ABSTRACT Motivation: We address the issue of ﬁnding a three-way gene interaction, the genotypes of another gene, given a dataset in which expressions and genotypes are measured at once for each individual.
This issue can be a general, switching mechanism in expression of two genes, being controlled by categories of another gene, and ﬁnding this type of interaction can be a key to elucidating complex biological systems.
The most suitable method for this issue is likelihood ratio test using logistic regressions, which we call interaction test, but a serious problem of this test is computational intractability at a genome-wide level.
Results: We developed a fast method for this issue which improves the speed of interaction test by around 10 times for any size of datasets, keeping highly interacting genes with an accuracy of  85%.
We applied our method to  3  108 three-way combinations generated from a dataset on human brain samples and detected three-way gene interactions with small P-values.
To check the reliability of our results, we ﬁrst conducted permutations by which we can show that the obtained P-values are signiﬁcantly smaller than those obtained from permuted null examples.
We then used GEO (Gene Expression Omnibus) to generate gene expression datasets with binary classes to conﬁrm the detected three-way interactions by using these datasets and interaction tests.
The result showed us some datasets with signiﬁcantly small P-values, strongly supporting the reliability of the detected three-way interactions.
Availability: Software is available from http://www.bic.kyoto- u.ac.jp/pathway/kayano/bioinfo_three-way.html Contact: kayano@kuicr.kyoto-u.ac.jp Supplementary information: Supplementary data are available at Bioinformatics online.
1 INTRODUCTION We address the issue of efﬁciently ﬁnding a three-way gene interaction, precisely two interacting genes in expression under the genotypes of a different gene, given a dataset in which both gene     To whom correspondence should be addressed.
(a)  0 1  .
2 e n e G  8 0  .
6  .
0  4 0  .
2  .
0  0 0  .
(c)  0  .
1     2 e n e G  8  .
0  6  .
0  4  .
0  2  .
0  0  .
0  0.0  0.2  0.4 0.6 Gene 1  0.8  1.0  (b)  0  .
1     2 e n e G  8  .
0  6  .
0  4  .
0  2  .
0  0  .
0  (d)  0  .
1     2 e n e G  8  .
0  6  .
0  4  .
0  2 0  .
0  .
0  0.0  0.2  0.4 0.6 Gene 1  0.8  1.0  0.0  0.2  0.4 0.6 Gene 1  0.8  1.0  0.0  0.2  0.4 0.6 Gene 1  0.8  1.0  Fig.
1.
Synthetic examples: expressions of two genes under the three classes of another gene.
(a) randomly distributed, (b,c) easily categorized into three classes and (d) a switching mechanism.
expressions and genotypes are measured for each individual.
We illustrate our problem setting by using synthetic 2D diagrams in Figure 1, where expression values of two genes are plotted with three classes (genotypes): +, * and (cid:3).
In this ﬁgure, panel (a) shows expression values being just randomly distributed  (b) shows expression values being easily categorized into three classes  and (c) shows that classes can be categorized by expressions without using two genes at the same time.
We are not interested in (a c) but in (d), which shows that the correlation in expression between two genes differs for each class.
More concretely, two genes are positively correlated for one class, whereas they are negatively correlated for another.
This is exactly a switching mechanism in expression between correlation and inverse-correlation of two genes, controlled by another gene.
Also this is the three-way gene interaction which we attempt to ﬁnd in this article.
We note that this can be categorized into a general switch in biology.
A simple, well-known example is Max, a transcription factor, which plays a role of an activator or a suppressor, depending on whether it binds to Myc (i.e.
Myc-Max)    The Author(s) 2009.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2735 2735 2743   M.Kayano et al.
or Mad (i.e.
Mad-Max) (Ayer and Eisenman, 1993).
We emphasize that this type of interaction must be a key to elucidating complex biological systems.
A reasonable approach to detect such three-way interactions is the likelihood ratio test for regression (LRTR).
Particularly, logistic regression must be suitable the most, because of categorical responses (genotypes) in our setting (McCullagh and Nelder, 1989).
The ﬁrst item of note is that parameter estimation for logistic regression is based on the maximum likelihood, for which a time- consuming iterative gradient descent, Newton Raphson, is usually used.
Secondly, in our case, classes are genotypes, causing a problem of an explosive number of combinations of one SNP (genotypes) and two genes (expressions).
For example, for 50 000 SNPs and 1000 genes, we have roughly 5  1010 (= 50 000 1000  1000) combinations, making scanning over all possible combinations intractable.
In fact,  24 h are needed to run Newton Raphson over only 107 combinations in our experiments.
Thus, the main focus of this article is to speed up the procedure of ﬁnding the three- way interactions.
Our strategy for this issue is to prune irrelevant combinations, such as those in which the expression values of two genes are randomly distributed as in Figure 1a, by using a hypothesis test assuming the normality of given examples.
The contribution of this article can be summarized into three folds: (i) We present a problem setting of ﬁnding a three-way gene interaction of two numerical variables and one categorical, corresponding to a biological switch in expression.
(ii) LRTR and LRT of logistic regression (LRTLR) are the standard approaches for this problem, but these are computationally inefﬁcient, particularly for a huge number of combinations that we can have.
We then propose an efﬁcient method for pruning large part of input combinations.
(iii) Our experiment with a huge dataset of human brain samples showed that our method run 10 times faster than LRTLR for any data size, keeping the accuracy of detecting three-way interactions at  85%.
2 RELATED WORK Three-way interactions in expression have not been considered except only a few cases of using simple methods (Li et al., 2004  Zhang et al., 2007).
There are two reasons for this: (i) dealing with more than two-way correlations is intractable at a genome-wide level, because of the explosive number of combinations and (ii) three-way interactions along this line can be inferred from two- way co-expression.
We emphasize that our three-way interaction is different from them, in terms that correlation or inverse-correlation in expression of two genes is controlled by genotypes of another gene.
Genome-wide association studies (GWA) using genotypes, especially single nucleotide polymorphisms (SNPs), have been highlighted in these few years (McCarthy and Hirschhorn, 2008), whereas cDNA microarrays have been a standard tool for understanding gene/protein behaviors in a cell.
Thus, currently a large number of studies use both gene expressions and genotypes, showing the importance of combining these two information sources (Nica and Dermitzakis, 2008).
Consequently, we now have a unique dataset, in which both gene expressions and genotypes are measured at once for each individual, and this type of dataset, which we use in this article, is increasing in these few years, which makes  2736  our approach very promising (Dixon et al., 2007  Myers et al., 2007  Schadt et al., 2008).
the two most  A standard analysis in GWA is conducted between a single SNP (i.e.
genotypes at a locus) and a categorical or continuous outcome (phenotype).
For this analysis, typical approaches are ANOVA (Analysis of Variance) and LRTR (Balding, 2006).
Usually more complex analysis is multiple (usually two) SNPs with a single phenotype where two-way ANOVA or LRTR with two explanatory variables can be considered.
This situation is closely related with epistasis, a general concept in modern quantitative genetics (Aylor and Zeng, 2008  Cordell, 2002), meaning the interaction between multiple loci and phenotype (Marchini et al., 2005).
Our problem setting looks similar to this but interestingly in the reverse direction.
That is, we consider the interaction between two expression phenotypes under categorical genotypes which thus have not been examined in GWA.
We note that ANOVA cannot be applied to this issue,1 whereas LRTR can be applied as a standard manner for our setting.
Another item of note is that ﬁnding three-way interactions in only SNPs exists (Lo et al., 2008), but their problem setting is straightforward and totally different from our setting.
3 METHODS 3.1 Notations and preliminaries Let X be an input matrix, in which each row is an individual and each column is a numerical vector of gene expressions or a categorical vector of SNPs (in genes).
Let E be the set of genes for which expressions are measured in X and Q be the set of SNPs in X , indicating that  E + Q  is the total number of columns of X .
To test the three-way interaction, we choose one combination, i.e.
two genes (e1 and e2) and one SNP (q) out of E and Q, respectively, and we write X (e1,e2,q) which has only three columns of X , corresponding to e1, e2 and q [we write X (e,q) when we choose only one gene e out of E and q out of Q].
Hereafter, until Section 3.6, we assume that we already choose one combination.
For gene expressions, let X =(X1 ,..., XK ) (cid:4)  RK be a K-dimensional numerical variable, taking value x=(x1 ,..., xK ) (cid:4) .
We note that using two genes in expression does not necessarily mean K =2.
For example, for two genes, we can set K =3, where X1, X2 and X3 correspond to one gene, the other gene and the interaction between these two genes, respectively.
For genotypes, let C be the number of groups (or classes), and in fact, C=3.
We denote three genotypes by G1,G2 and G3, into one of which each individual falls.
Let Y be the class variable, taking value y, where Y =(Y1,Y2) (cid:4)  0,1   0,1 .
Here, we note that y takes the following values: y=(1,0) if x  G3.
We denote if x  G1, y=(0,1) (cid:4) (cid:4)=(y(1),y(2)), N inputs (individuals) by X=(x1,...,xN ) which can be classiﬁed into N1, N2 and N3 inputs for G1, G2 and G3, respectively.
The average expression values can be deﬁned for each class c and all classes:  xc= 1 (cid:1) N j=1 xj, respectively, c=1 Nc xc.
IK is the identity matrix of size K, and 1 is an where  x=1/N n-dimensional vector in which all elements are 1. j=1(xj  x)(xj  x) (cid:4), B=(cid:1) (cid:1) j=1 j Gc (xj  xc)(xj  xc) (cid:4), where T = B+ W. We can further deﬁne covariance matrix Sc for class (c=1,..., C), and total covariance c, Sc= 1 matrices S and ST , S= 1 Nc j=1 j Gc N W) and  (cid:1) j=1 j Gc xj and  x= 1 statistics: T =(cid:1)  c=1 Nc( xc  x)( xc  x) (cid:4) (cid:1) C c=1  and W =(cid:1) (xj  xc)(xj  xc) (cid:1)  if x  G2 and y=(0,0)  and Y =(y1,...,yN )  (xj  xc)(xj  xc)  incorporate  Nc j=1 j Gc  (= 1  (cid:1)  (cid:1)  some  basic  C c=1  We  Nc  Nc  N  N  K  N  C  N  N  (cid:4)  (cid:4)  (cid:4)  (cid:4)  (cid:4)  1ANOVA can be applied only to the case with a single continuous response (phenotype) and one or more discrete explanatory variables (genotypes).
[11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2736 2735 2743   (cid:1)  (cid:1)  (cid:4)  N  C c=1  (= 1  (xj  x)(xj  x) ST = 1 (cid:1) (cid:1) Nc j=1 j Gc c=1 NcSc and S= 1 C C c=1 NcSc.
N We show the multivariate normal distribution, having two parameters, µc and  c (the mean and the covariance matrix of class c), and the log-density (log-likelihood) function of this distribution can be given as follows:  that W =  N T).
We  note  (cid:2)(µ,  X) =   C(cid:2)   C(cid:2)  c=1  Nc 2  (cid:3)  log det(2π c)  (cid:4)  Nc 2  tr  1  c Sc+( xc µc)  (cid:4)  1  ( xc µc)  c=1  (1) From this equation, we can see that  xc, covariance matrix Sc and covariance matrix S can be the maximum likelihood estimators of µc,  c and   (=  1=   =  C), respectively.
c  .
We brieﬂy describe likelihood ratio test (LRT), which will be used.
We ﬁrst assume that examples x1,x2 ,...,xn are generated according to parameter vector θ.
Let H0 : θ    0 be a null hypothesis and H1 : θ    1 be the alternative hypothesis.
The statistic λ for testing H0 against H1 can be deﬁned 1 are the maximum likelihoods under θ    0 as λ= L       , where L 0 and L and θ    1, respectively.
Usually we can use the log-likelihood ratio (LLR), 1  (cid:2)  =logL  2logλ=2((cid:2)    0), where (cid:2)  0.
We note that this q r distribution as N   , where q r is the degree of statistic follows χ2 freedom (df ) of the χ2 distribution.
1 and (cid:2)   =logL  /L    0  0  1  1  3.2 Finding three-way interactions: interaction test  (Likelihood Ratio Test of Logistic Regression, LRTLR)  A standard and exact approach for our problem is LRTLR (McCullagh and Nelder, 1989), which we simply call interaction test in this article.
3.2.1 Logistic regression We ﬁrst denote the probability that x is in G1 by p1(x), and similarly the probability that x is in G2 by p2(x), by which the probability that x is in G3 is p3(x) (=1 p1(x) p2(x)).
We use logistic regression to link these probabilities to K-dimensional input x by using weight parameters (or coefﬁcients) w=(w , where w1= (w10,w11,...,w1(K 1))  (cid:4) ,w 2)  (cid:4) 1  (cid:4)  (cid:4)       p1(x)=     p2(x)=  (cid:4)  , w2=(w20,w21,...,w2(K 1))     exp(w     1+exp(w 1x)+exp(w (cid:4) (cid:4) 2x) 1x)+exp(w 1+exp(w (cid:4) (cid:4) 2x)  (cid:4) 1x) (cid:4) 2x)  exp(w     log  log  as follows: =w (cid:4) 1x =w (cid:4) 2x  p1(x) p3(x) p2(x) p3(x)  Here, we denote p1(x), p2(x) and p3(x) by p1(x w), p2(x w) and p3(x w) (=1 p1(x w) p2(x w)), respectively, because they can be functions of w. We can then write the likelihood of logistic regression for given N examples and parameters w, as follows:  (2)  p1(xi w)yi1 p2(xi w)yi2 p3(xi w)1 yi1 yi2 ,  L(w)= N(cid:9) i=1 where yi =(yi1,yi2) (cid:4) .
3.2.2 Parameter estimation We can obtain the maximum likelihood ˆw for w by maximizing the log-likelihood l(w)=logL(w).
A estimator standard approach for this purpose is the Newton Raphson method, which is an iterative gradient descent, having the following updating rule by which we can have ˆw(t+1) at the (t+1)-th iteration, using ˆw(t) of the t-th iteration:  (cid:10)  ˆw(t+1)= ˆw(t)   (cid:11) 1 where Hessian matrix H(w) (=  2l/ w w(cid:4) (=  l/ w) can be given in the following: U(w)=X  H(w)   (cid:4) a(w),  w= ˆw(t)  U(w)   w= ˆw(t) ,  (3)  ) and gradient vector U(w)  Finding three-way interactions from transcript and genotype data  Table 1.
Log-likelihoods and LLR by Newton Raphson  Figure 1  (a) (b) (c) (d)  l(ˆw01)  196.4  1.86  83.5  197.8  l(ˆw0)  195.5  0.42  1.52  197.4  l(ˆw)  194.4  2.36  6.00  126.4  LLR (P-value)  2.23 (0.45)  3.87 (1.00)  8.97 (1.00) 142.12 (0.00)  where X =diag(X,X) (block diagonal matrix of X), a(w)=(a1(w) where aj(w)=y(j) pj(w) and pj(w)=(pj(x1 w),...,pj(xN w)) (cid:4) R(w)X  ,  H(w)=  =X  (cid:12)  (cid:13)  (cid:4) (cid:4)  (cid:4) (cid:4)  (cid:4)  R11(w)X X R21(w)X X  R12(w)X R22(w)X  X X  (cid:4),a2(w) (j=1,2).
(cid:4)  (cid:4)  )  where N N matrix Rjk(w)(j,k=1,2) is given by Rjj(w)=diag pj(w)(cid:9) (pj(w) 1)  and Rjk(w)=diag pj(w)(cid:9)pk(w) (j(cid:10)= k).
Finally, the updating rule of the Newton Raphson method for logistic  regression can be rewritten in the following:  ˆw(t+1)= ˆw(t)  X  (cid:4) R(ˆw(t))X   1X  (cid:4) a(ˆw(t)).
(4) In practise, we start with some initial values ˆw(0) and update ˆw(t+1) according to Equation (4) until the following equation is satisﬁed:  (cid:11)ˆw(t+1)  ˆw(t)(cid:11)2  2Kδ,  (5)  where δ is set at a certain value.
(cid:4)  3.2.3 Interaction test We then examine the signiﬁcance of the interaction in expression between two genes in terms of classes of another gene.
Let xi1 and xi2 be expression values of the corresponding two genes for input i.
The interaction term is xi1xi2, meaning that our purpose is to ﬁnd the case that the logistic model is well ﬁtted to the data when this term is added.
We then let xi =(1,xi1,xi2,xi1xi2) , and the logistic model with the interaction term is given as follows: pc(x w) p3(x w)  and w=(w10,w11,w12,w13,w20,w21,w22,w23)  = wc0+wc1xi1+wc2xi2+wc3xi1xi2 (c=1,2)  If wc3=0, the model does not have the interaction term, meaning that the null hypothesis and w0 are given as follows: H0 : w13=0 and w23=0 w0 = (w10,w11,w12,0,w20,w21,w22,0)  log  (6)  (cid:4).
(cid:4)  Then the test statistic, LLR and its asymptotic distribution can be given:   2logλ=2 l(ˆw) l(ˆw0)    χ2  2(αi),  (7) where χ2 2(αi) is the χ2 distribution with the df of two, meaning that interacting genes can be obtained as those which have lower P-values under this distribution than the input signiﬁcance level αi.
We run interaction test 100 times over four examples in Figure 1, and Table 1 shows the average results over the 100 runs.
This table clearly shows that the P-value is very large for Figure 1a c, while that is zero for Figure 1d, indicating that intraction test can detect our target sample correctly.
Figure 2 shows a pseudocode of interaction test.
We can write interaction test by function Interaction_test(e1, e2, q, αi), which outputs one if given example (e1,e2,q) has the three-way interaction  otherwise zero.
A signiﬁcant drawback of interaction test is computational inefﬁciency.
In fact, Equation (6) shows K =8, meaning that Newton Raphson needs to compute an 8 8 inverse-matrix at each of its iteration procedure.
3.3 Key idea for speeding-up interaction ﬁnding A basic idea for accelerating the ﬁnding of a three-way interactions is to prune some combinations, to which interaction test does not have to be applied.
2737  [11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2737 2735 2743   M.Kayano et al.
Input: X (e1,e2,q): Input three vectors of genes e1,e2 and SNP q.  αi: Signiﬁcance level for interaction test  Output: One if e1 and e2 are interacting with each other under q  otherwise  zero.
Update w0, according to the iterative rule of Eq.
(4)  Update w, according to the iterative rule of Eq.
(4)  Interaction_test(e1, e2, q, αi) 1: w0  some initial value.
2: repeat 3: 4: until Eq.
(5) is satisﬁed 5: w  some initial value.
6: repeat 7: 8: until Eq.
(5) is satisﬁed 9: if -2 l(ˆw) l( ˆw0)    χ2 10: 11: else 12: 13: end if  return 0  return 1  2(αi) then  Fig.
2.
Pseudocode of interaction test.
Fig.
3.
LLR and its components.
From Equation (7), we can see that the interacting genes should have a larger LLR.
Figure 3 shows a schematic ﬁgure, in which we plot the log-likelihood without the interaction term in the left-hand side and with the interaction term in the right-hand side.
We note that the range of the log-likelihood can be limited, because the maximum log-likelihood is zero and the minimum log-likelihood can be given by the case of the uniform distribution for pi(x).
The LLR in question can be then given by the distance being shown by a dotted line in Figure 3.
Thus, two interacting genes should have a long dotted line, meaning that the point in the left-hand side should be lower and that in the right-hand side should be higher.
This observation indicates that we can prune the following two cases: (I) a large likelihood can be obtained without the interaction term, and (II) only a small likelihood can be obtained even if we use the interaction term.
These (I) and (II) correspond to areas I and II, respectively, in Figure 3.
We then attempt to efﬁciently detect examples in areas I and II by assuming the normality on data distribution.
3.4 Linear discriminant analysis Area I in Figure 3 contains examples in which expressions can be easily separated into three classes without the interaction term, as shown in Figure 1b and c. Thus, in this case, we can consider a simpler, easily computable estimation method for parameters of the logistic regression model without the interaction term, and if the likelihood for a given  2738  Table 2.
MANOVA, Box s M test and Means-Covariances (MC) test on four examples in Figure 1  Examples in Figure 1  (a) (b) (c) (d)  MANOVA  Box s M test  MC test  0.53 (0.28) 0.00 (0.00) 0.00 (0.00) 0.94 (0.09)  0.70 (0.25) 0.68 (0.25) 0.71 (0.25) 0.00 (0.00)  0.60 (0.30) 0.00 (0.00) 0.00 (0.00) 0.00 (0.00)  combination by that model is high enough, this combination can be pruned.
For the simpler estimation method, we use linear discriminant analysis (LDA), which assumes that x follows the normal distribution N(µ, ) with the same covariance   for all three classes (Hastie et al., 2001).
We skip the detail of this method due to space limitations because in our experiment only a small part of all given examples can be pruned by LDA.
Interested readers should refer the Supplementary Material.
We can write LDA by function LDA(e1, e2, q, αi) [or LDA(e, q, αi)], which outputs one if given example (e1,e2,q) [or (e,q)] should be pruned  otherwise zero.
3.5 Randomness test Area II in Figure 3 contains an example for which the maximum likelihood with the interaction term is very low, implying that expression values are almost randomly distributed in terms of classes, as shown in Figure 1a.
To detect the randomness of expression values, if we use a faster hypothesis test for randomness than Newton Raphson, we can speed up the procedure for ﬁnding the three-way interaction.
We assume that expression values follow the K-dimensional normal distribution for each class of genotypes, and under this assumption, we present our approach, which combines multivariate ANOVA (MANOVA) and Box s M test (Mardia et al., 1979).
We can set K =2 for our test, meaning that the largest matrix size is 2 2, making the computation very efﬁcient.
3.5.1 MANOVA MANOVA considers the following null hypotheses over the means:  H0 : µ1= µ2=   = µC, H1 : µi (cid:10)= µj for some pair of i and j  For testing H0 against H1, we use LLR,  2logλ (=2((cid:2)  0)).
By replacing  c in Equation (1) with   and using the maximum likelihood estimators  xc and S for µk and  , respectively, we have the following:   (cid:2)   1  (cid:12)  (cid:13)  (cid:2)   1  =  N 2  log det  2π N  W    NK 2  .
(8)  On the other hand, for the log-likelihood under null hypothesis, we can use the maximum likelihood estimators  x and ST for µk and  , respectively, and we have the following: (cid:2)   (cid:12)  (cid:13)  .
log det  (9)  2π N  T    NK 2  =  N 2  0  2  Thus, the statistic can be given as follows:  2logλ= N log det(W) further see that q is KC+ K(K+1)  and r is K+ K(K+1)  .
det(T) .
We can  We conducted MANOVA over four samples in Figure 1, and Table 2 shows the resultant average over 100 runs with SDs in parentheses.
The P-value of MANOVA for (a) was high (0.53), whereas that for (b) [and (c)] was zero, meaning that MANOVA can discriminate (a) from (b) [and (c)].
However, the P-value of (d) was also high (0.94), meaning that MANOVA could not separate (a) from (d).
Thus, we need another hypothesis test, which can distinguish (a) from (d).
2  [11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2738 2735 2743   Input: X (e1,e2,q): Input three vectors of genes e1,e2 and SNP q.
Input: X : Input dataset  Finding three-way interactions from transcript and genotype data  αm: Signiﬁcance level for MC test  Output: One if two genes e1 and e2 are randomly generated in terms of  SNP q  otherwise zero.
0 according to Eq.
(9).
1 according to Eq.
(10).
MC_test(e1, e2, q, αm) 1: Compute (cid:2)  2: Compute (cid:2)  3: Compute  2logλ according to Eq.
(11).
4: if  2logλ   χ2 5: 6: else 7: 8: end if  2(αm) then  return 1  return 0  Fig.
4.
Pseudocode of MC test.
3.5.2 Box s M test We then consider the following hypotheses over the covariance:  Here, (cid:2)  1 can be obtained by using maximum likelihood estimators  xk and Sk for µk and  k, respectively, in Equation (1).
H0 :  1=  2=   =  C, H1 :  i (cid:10)=  j for some pair of i and j 0 can be given by (cid:2)  1 of MANOVA [i.e.
Equation (8)], and (cid:2)  =  C(cid:2)  (cid:2)   Nc 2  log det(2πSc)  NK 2 c S).
Here, q is KC+  1  C c=1 Nc log det(S  (10)  1  Thus, the statistic is  2logλ=(cid:1)  c=1  and r is KC+ K(K+1)  .
KC(K+1)  2  2 We run Box s M test over four samples in Figure 1, and Table 2 shows the results.
This result shows that the P-value of (a) was high (0.70), whereas that of (d) was zero, meaning that M-test separated (a) from (d).
However, this time, this test could not discriminate (a) from (b) [and (c)], since the P-value of (b) [and (c)] was also high.
Thus, this result showed that Box s M test can be a complement of MANOVA, implying that we can combine these two tests for detecting random distributions such as Figure 1a.
3.5.3 MC test (MANOVA + M Test) We ﬁnally consider the following hypotheses over both the means and covariances:  H0 : µ1= µ2=   = µC and  1=  2=   =  C H1 : µi (cid:10)= µj or  i (cid:10)=  j for some pair of i and j  We emphasize that this test suits our purpose the most, although this is an unpopular statistic and not named.
We then call this test as MC test.
Interestingly, (cid:2)  0 of MANOVA, i.e.
Equation (9) and (cid:2)  1 of M test, i.e.
Equation (10).
Thus, the statistic of MC test is given as follows:  0 of this test is given by (cid:2)   1 is given by (cid:2)    2logλ = C(cid:2)  c=1  Nc log det(S   1 c ST ) ,  (11)  2  and r= K+ K(K+1)  N T = ST .
Here, q= KC+ KC(K+1)  since 1 , meaning that df is 10 in our case.
Figure 4 shows a pseudocode of MC test.
We can write MC test by function MC_test(e1, e2, q, αm), having signiﬁcance level αm as an input which removes given combination (e1,e2,q) if its P-value is larger than αm, meaning that a larger number of combinations can be removed if αm is smaller.
This function outputs one if (e1,e2,q) should be pruned  otherwise zero.
2  We checked the performance of MC test using synthetic four samples of Figure 1.
Table 2 shows that all P-values are zero, except (a) with the P-value of 0.60, indicating that MC test can successfully detect (a) out of the four examples and is expected to work on real data as well.
3.6 Proposed procedure Figure 5 shows a pseudocode of our entire procedure.
We can ﬁrst check each pair of a gene and a SNP by LDA, and if the log-likelihood is high,  αi: Signiﬁcance level for interaction test, αm: Signiﬁcance level for MC test  F  F (e,q)  if (e1,q) / F and (e2,q) / F then  // Pruning by MC test if MC_test(e1,e2,q,αm) == 1 then  // Pruning by LDA: One gene and a SNP if LDA(e, q, αi) == 1 then  Output: I: Interacting gene pairs with the corresponding SNPs Proposed_procedure(X , αi, αm) 1: for each pair of gene e  E and SNP q  Q do 2: 3: 4: end if 5: 6: end for 7: for each combination of genes e1  E,e2  E and SNP q  Q do 8: 9: 10: 11: 12: 13: 14: 15: 16: 17: 18: 19: 20: 21: 22: 23: end for  end if // Interaction test for unpruned combinations if Interaction_test(e1, e2, q, αi) == 1 then  end if // Pruning by LDA: Two genes and a SNP if LDA(e1,e2,q, αi) == 1 then  This combination should be in Area II.
go to Pruned  This combination should be in Area I. go to Pruned  I I (e1,e2,q)  end if Pruned  end if  Fig.
5.
Pseudocode of our entire procedure: FTGI.
this pair is stored to be pruned.
We then generate all possible combinations of two genes and a SNP out of given data.
For each of these combinations, it is ﬁrst pruned if it contains the stored gene SNP pair.
Then, LDA and MC test are run in sequence for pruning, and ﬁnally interaction test is applied to the remaining.
Hereafter, we call our proposed procedure FTGI, standing for Fast ﬁnding Three-way Gene Interactions, whereas we call the approach of running Interaction Test Only over all possible combinations as ITO.
More details of our proposed method is shown in the Supplementary Material.
4 EXPERIMENTS 4.1 Data We used the human brain-derived dataset of Myers et al.
(2007), which originally has 193 rows (individuals) and 14 078 numerical columns (corresponding to gene expressions) and 366 140 categorical columns (corresponding to SNPs).
We ﬁrst removed the columns containing missing values and the columns which have a genotype to which only less than 10 individuals are assigned.
Our purpose is to ﬁnd three-way gene interactions, and so we further removed SNPs which are neither in coding regions nor in introns, by specifying genes on sequences using the FTP site of NCBI Mapviewer for Homo sapiens.
Finally, we obtained 5269 numerical vectors (in expression of genes) and 13 411 categorical vectors (in genotypes of SNPs) for 193 individuals, which we call the Source dataset.
Myers et al.
(2007) collected the original dataset from human brains, and so we focused on neurodegenerative diseases [including Alzheimer s disease (AD) and Parkinson s disease, etc.]
out of ﬁve disease pathways in the KEGG disease database (Kanehisa et al., 2008), resulting in 142 genes which we call Neuro.
All experiments were run on a machine with Dual-Core  2739  [11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2739 2735 2743   M.Kayano et al.
AMD Opteron 2222 SE (3.0 GHz) and 18 GB RAM.
Throughout Section 4, each P-value is shown by log10(P-value).
4.2 Results and discussion 4.2.1 Speeding-up ﬁnding three-way interactions and pruning accuracy We examined the improvement in time efﬁciency by FTGI over ITO.
Figure 6 shows the real computation time of ITO and FTGI, when we changed the number of combinations randomly chosen from the source dataset.
We here focused on Area II of Figure 3 only, since we found that in the Source dataset of Area I had only a small number of examples, which do not affect the efﬁciency greatly.
This ﬁgure clearly shows that as αm decreased, the amount of running time of FTGI became smaller for any size of inputs, by pruning a larger number of them.
In particular, at αm of 0.001, FTGI runs approximately 10 times faster than ITO, resulting in only  2 h for 107 combinations, being a sizable improvement.
This means that for 5 1010 (= 50 000 SNPs   1000 genes   1000 genes) combinations, FTGI just needs only a couple of days with 100 CPUs, while ITO needs more than a month.
The αm controls the number of pruned combinations, and Table 3 shows the pruning rate, i.e.
the ratio of pruned combinations to all  5 0 + e 1  3 0 + e 1  1 0 + e 1  ITO FTGI (a FTGI (a FTGI (a  m=0.05) m=0.01) m=0.001)  ) s d n o c e S  i  (   e m T n o i t a     t  u p m o C  1e+04  1e+05  1e+06  1e+07  # Input Combinations  Fig.
6.
Computation time improvement by reducing αm.
input combinations, with varying αm for 107 input combinations.
We further checked the pruning accuracy, which can be deﬁned as the overlap between the resultant top K (set at 100) combinations by P-values of ITO and those of FTGI.
Table 3 shows that for αm of 0.05, FTGI can prune around  70% of input combinations with pruning accuracy of almost 100%.
If αm is reduced to 0.001,  94% inputs can be pruned, keeping the pruning accuracy of  85%.
This high pruning rate effects the time efﬁciency of FTGI.
We note that all results in this section were averaged over three  runs at each corresponding setting.
4.2.2 Detecting three-way interactions We then generated all combinations from the Source dataset, focusing on the genes in Neuro, meaning that we had totally 3 108 combinations (= 13 411 SNPs  142 genes  142 genes).
We then run FTGI with αm of 0.001 over these combinations.
Figure 7 shows the gene expressions of the resultant top 10 combinations in terms of P-values.
We note that these P-values of interaction test were computed by the procedure in Section 3.2.
Each of Figure 7 is a 2D diagram on which expression values of the corresponding two genes are plotted with Contour lines for each genotype.
This ﬁgure shows that the topographical distribution of different genotypes are clearly crossed in all cases, meaning that in each of all the top 10 combinations, genes are interacting in expression, being controlled by genotypes, as shown in Figure 1d.
Table 4 shows the detail (Gene name for one SNP and the name with GeneID, the deﬁnition and the pathway for each of two  Table 3.
Pruning rates and pruning accuracies (top 100) at three αm values of FTGI for 107 combinations  αm  0.05  0.01  0.001  Pruning rate Pruning accuracy (top 100)  0.7095 0.9967  0.8611 0.9567  0.9354 0.8467  (a)    Topranked  (b)    Ranked 2nd  (c)    Ranked 3rd  (d)    Ranked 4th  (e)    Ranked 5th  2     e n e G  2  .
3  0  .
3  8  .
2  6  .
2  4  .
2  2     e n e G  0  .
3  8  .
2  6  .
2  4 2  .
2  .
2  0  .
2  2     e n e G  6  .
3  2 3  .
8  .
2  4  .
2  2     e n e G  0  .
3  8  .
2  6  .
2  4  .
2  2  .
2  8 2  .
6  .
2  4 2  .
2  .
2     2 e n e G  3.2  3.4  3.6  3.8  Gene 1  3.0  3.1  3.2 Gene 1  3.3  3.4  2.2  2.6  3.0  3.4  3.1 3.2 3.3 3.4 3.5 3.6  2.4  2.5  2.6  2.7  2.8  Gene 1  Gene 1  (f)    Ranked 6th  9  (g)    Ranked 7th  (h)    Ranked 8th  (i)    Ranked 9th  2     e n e G  .
2  8  .
2  7 2  .
6  .
2  5  .
2  4  .
2  2.4  2.6  2.8 Gene 1  2     e n e G  4  .
3  2 3  .
0  .
3  6  .
3  4  .
3  2 3  .
0  .
3  2     e n e G  3.0  3.2  2.6 2.8 3.0 3.2 3.4  3.1 3.2 3.3 3.4 3.5 3.6  2     e n e G  2 3  .
0  .
3  8  .
2  6  .
2  4  .
2  Gene 1  Gene 1  Gene 1  3.2  3.4  3.6  3.8  2.3  2.5  2.7 Gene 1  2.9  Gene 1 (j)    Ranked 10th  9 3  .
8  .
3  7  .
3  6  .
3  2     e n e G  Fig.
7.
Expressions of two genes under three genotypes of another gene for top 10 (a j) ranked three-way interactions out of 3 108 combinations.
2740  [11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2740 2735 2743   Finding three-way interactions from transcript and genotype data  Table 4.
Details of the top 10 three-way interactions in Figure 7  P-value  SNP (GeneID and name)   8.91108  8.4901  8.10611  8.06076  8.02645   8.02495   8.0149  1  2  3  4  5  6  7  8   7.86801  7.84081 9 10  7.73205  rs7487429  (113251, LARP4)  rs13086670  (80163, FLJ11827)  rs2175200  (439992, RPS3AP5)  rs2797425  (55227, LRRC1)  rs7116710 (440031, LOC440031)  rs2058619 (728730, LOC728730)  rs1893261  (25833, POU2F3)  rs1571176  (9044, BTAF1)  rs12425705  (91012, LASS5)  rs12698191 (393078, tcag7.1023)  Name (GeneID)  COX6C (1345)  RERE  (473) ATP5D (513) ATP5G1 (516) NCSTN  (23385)  NDUFA8 (4702)  ALS2  (57679)  ATP5G1 (516) COX6C (1345)  NDUFA10  (4705)  Gene 1  Deﬁnition  Cytochrome c oxidase subunit VIc  (EC:1.9.3.1)  Name (GeneID)  UBA1  (7317)  Gene 2  Deﬁnition  Ubiquitin-like modiﬁer activating enzyme 1  (EC:6.3.2.19)  Arginine-glutamic acid dipeptide (RE) repeats  TNFRSF1A  Tumor necrosis factor receptor superfamily,  ATP synthase, H+ transporting, mitochondrial  F1 complex, δ subunit (EC:3.6.1.14)  ATP synthase, H+ transporting, mitochondrial  F0 complex, subunit C1 (subunit 9)  Nicastrin  NADH dehydrogenase (ubiquinone) 1 α  subcomplex, 8, 19 kDa (EC:1.6.5.3 1.6.99.3)  Amyotrophic lateral sclerosis 2 (juvenile)  ATP synthase, H+ transporting, mitochondrial  F0 complex, subunit C1 (subunit 9)  Cytochrome c oxidase subunit VIc  (EC:1.9.3.1)  NADH dehydrogenase (ubiquinone) 1 α  subcomplex, 10, 42kDa (EC:1.6.5.3 1.6.99.3)  (7132)  ITCH  (83737)  ATP5H  (10476)  HSPA5  (3309)  NDUFA6 (4700)  SLC25A6  (293)  ATP5J (522) UBA1  (7317)  COX4  (1327)  member 1A  ITCHY E3 ubiquitin protein ligase homolog  (mouse)  ATP synthase, H+ transporting, mitochondrial  F0 complex, subunit d (EC:3.6.1.14)  Heat shock 70kDa protein 5  (glucose-regulated protein, 78kDa)  NADH dehydrogenase (ubiquinone) 1 α  subcomplex, 6, 14kDa  Solute carrier family 25 (mitochondrial  carrier  adenine nucleotide translocator), member 6  ATP synthase, H+ transporting, mitochondrial  F0 complex, subunit F6 (EC:3.6.1.14)  Ubiquitin-like modiﬁer activating enzyme 1  (EC:6.3.2.19)  Cytochrome c oxidase subunit IV isoform 1  (EC:1.9.3.1)  interacting genes in expression) of the 10 three-way interactions in Figure 7, all information in this table being retrieved from KEGG.2 For example, the ﬁrst interaction of Table 4 shows the switching mechanism of two genes, COX6C and UBA1, being controlled by a SNP in LARP4.
4.2.3 Validating detected interactions with permutations To conﬁrm the statistical signiﬁcance of the detected three-way interactions, we conducted permutations by measuring P-values of  null data , generated in the following three manners, and comparing them with those of the interactions we detected.
Null data 1: we randomly chose 10 000 combinations out of all combinations using the Source dataset (13 411 SNPs   5269 genes   5269 genes) and randomly permuted the genotypes of these combinations 100 times.
Totally, we had one million null examples.
Null data 2: we randomly chose 10 000 combinations out of all combinations using the Neuro dataset (13 411 SNPs   142 genes   142 genes) and randomly permuted the genotypes of these combinations 100 times.
Totally, we had one million null examples.
Null data 3: we permuted the genotypes of each of the detected top 10 interactions in Figure 7 one million times, resulting in one million null examples for each combination.
We ﬁrst show the results of permutation tests when we use Null data 1 and 2.
Figure 8 shows the distribution of P-values of null examples, being located in the right side, for Null data 1 and 2.
In this ﬁgure, the distribution of P-values for the top 10 000 interactions detected  2The Supplementary Material shows annotations by Reactome (Vastrik et al., 2007) for interacting genes.
(a)  y c n e u q e r F  0 0 0 2  0 0 5 1  0 0 0 1  0 0 5  0  (b)  y c n e u q e r F  0 0 0 0 5  0 0 0 0 4  0 0 0 0 3  0 0 0 0 2  0 0 0 0 1  0 0 0 2  0 0 5 1  0 0 0 1  0 0 5  0  0  0 0 0 0 5  0 0 0 0 4  0 0 0 0 3  0 0 0 0 2  0 0 0 0 1  0   8   4   6 log10(p value)   2  0   8   4   6 log10(p value)   2  0  Fig.
8.
Distributions (left side) of P-values of the top 10 000 interactions detected by FTGI, with those (right side) of Null data (a) 1 and (b) 2.  by FTGI is located in the left side.
This ﬁgure shows that the red- colored distribution is clearly separated from the black-colored one, meaning that the detected three-way interactions have signiﬁcantly small P-values.
For Null data 3, we show the result, focusing on two cases (the top and the 10th interactions), since the trend of results was kept the same for all 10 interactions in Table 4.
Figure 9 shows the distribution of P-values of null examples generated from the top interaction (or the 10th), with the P-value of the top (or the 10th) interaction by an arrow.
This ﬁgure indicates that the P-value of the top (or the 10th) interaction is clearly distant from the P-value distribution of null examples, implying that P-values of the detected interactions are statistically signiﬁcant.
4.2.4 Validating detected interactions with GEO To conﬁrm the reliability of the interactions in Table 4, we tried to ﬁnd, for each gene pair, the switching mechanism in expression which can be controlled by some experimental condition of gene expression.
This is because  2741  [11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2741 2735 2743   M.Kayano et al.
Table 5.
Results of interaction test over the datasets from GEO  Rank Gene pair  #datasets GDS from GEO  P- value #ex.
#ex.
Annotation  class 1 class 2  1 2 3 4 5 6 7 8 9 10  117  COX6C,UBA1  284  RERE,TNFRSF1A  324  ATP5D,ITCH  392  ATP5G1,ATP5H   NCSTN,HSPA5  102  NDUFA8,NDUFA6  142  ALS2,SLC25A6  108 418  ATP5G1,ATP5J  117  COX6C,UBA1   NDUFA10,COX4  232  GDS2960_1  3.9532 60 GDS2736_25  5.9049 19 GDS1875_3  5.1235 27 GDS2733_1  7.9996 17 GDS2545_5  6.4398 63 GDS2733_4  4.7027 17 GDS1627_2  3.2808 16 GDS2960_1  3.1628 60 GDS2960_1  3.9532 60 GDS2643_9  6.2133 13  41 15 24 17 25 16 15 41 41 12  Marfan syndrome: cultured skin ﬁbroblasts Malignant ﬁbrous histiocytoma and various soft tissue sarcomas Host cell response to HIV-1 Vpr-induced cell cycle arrest Cytosine arabinoside effect on Ewing s sarcoma cell line Metastatic prostate cancer (HG-U95A) Cytosine arabinoside effect on Ewing s sarcoma cell line Breast cancer cell lines response to chemotherapeutic drugs Marfan syndrome: cultured skin ﬁbroblasts Marfan syndrome: cultured skin ﬁbroblasts Waldenstrom s macroglobulinemia: B lymphocytes and plasma cells  For each gene pair of 10 interactions in Table 4, the number of datasets obtained from GEO, the GDS which gave the smallest P-value, the P-value, the number of examples (ex.)
in two classes of the GDS and the annotation of the GDS are shown.
(a)  y c n e u q e r F  0 0 0 0 5  0 0 0 0 4  0 0 0 0 3  0 0 0 0 2  0 0 0 0 1  0  0(b)  0 0 0 5  y c n e u q e r F  0 0 0 0 4  0 0 0 0 3  0 0 0 0 2  0 0 0 0 1  0   8   4   6 log10(p value)   2  0   8   4   6 log10(p value)   2  0  Fig.
9.
The P-values of the (a) top and (b) 10th interactions (shown by arrows) and the distributions of P-values of the corresponding null examples generated.
if found, this directly means that the corresponding gene pair can be controlled by another categorical factor, such as genotypes of another gene.
For this purpose, we used GEO (version of June 1, 2009  Barrett et al., 2007), from which we found 2089 GDSs (gene datasets) which are annotated.
Out of the 2089 datasets, we selected datasets which satisfy all the following four conditions for each gene pair in Table 4: (i) expression values of the corresponding gene pair are contained  (ii) the total number of experiments is  50  (iii) experimental conditions can be divided into two or more classes  and (iv) each class has 10 or more experiments.
We then obtained 36 datasets.3 For each gene pair of the top 10 list, we conducted interaction test by using pairwise (binary) classes in each dataset and ranked them according to P-values of interaction test.
Table 5 shows a list of datasets, each giving the lowest P-value for each gene pair of the 10 interactions in Table 4.
For example, for COX6C and UBA1, the gene pair of the ﬁrst interaction of Table 4, we found a switching mechanism in GDS2960_1 with the P-value of  3.9532, showing the statistical signiﬁcance of this mechanism.
This directly indicates that there must exist a switching mechanism in expression between  3In each GDS, if it has more than two classes or replicated experiments, we consider all possible pairwise combinations of them.
We then name generated multiple datasets from one GDS (e.g.
GDS2960) those like GDS2960_1, GDS2960_2, etc.
This results in that the number of datasets we used could be  36.
The actual number of datasets for each gene pair is shown in Table 5.
2742  these two genes under the alteration of experimental conditions which is speciﬁed by the annotation of GDS2960_1.
In fact, Table 5 indicates that the switching mechanism happens between patients of Marfan syndrome and controls.
This type of explanation is possible for all 10 GDSs in Table 5 by using annotations in this table.
As well all P-values shown in Table 5 are small enough,4 supporting the reliability of the three-way interactions in Table 4 which our method detected.
Furthermore, Figure 10 shows the real expression values of two genes, being categorized into two classes, for each GDS of Table 5.
These orthogonal Contour plots also assist the reliability of three-way interactions that we detected in Table 4.
We further brieﬂy checked the genes having SNPs in the ﬁrst and the third interactions in Table 4: (i) the ﬁrst interaction in Table 4 has two genes, COX6C and UBA1, which is controlled by a SNP in LARP4, i.e.
La ribonucleoprotein domain family member 4.
This gene was already known as an important gene in both AD and aging, being already pointed out that LARP4 increases expression with increasing AD progression and normal aging (Miller et al., 2008).
As our focus was on 142 genes on neurodegenerative diseases including AD, the known function on LAPR4 is consistent enough with the interaction with COX6C and UBA1, being possibly in the switching mechanism.
(ii) The gene with the SNP in the second interactions in Table 4 was a hypothetical one, but the third interaction has two genes, ATP5D and ITCH, being controlled by a SNP in RPS3AP5, which is a pseudogene of RPS3A, i.e.
ribosomal protein S3A.
This gene is known to be downregulated in the same manner as some genes in oxidative phosphorylation pathway (Welle et al., 2003), which includes ATP5D.
Thus, these observations reveal the possibility that the third interaction also may exist as the switching mechanism in expression of two genes, i.e.
ATP5D and ITCH.
Overall our extensive analysis has implied that the detected three- way interactions can exist.
These results show the potential of our approach to explicate complex biological systems appearing in modern biology and medical sciences.
4For each gene pair, not only the dataset giving the top P-value but also 10 datasets providing the top 10 P-values are shown in the Supplementary Material.
All P-values in the Supplement Material are small, showing the statistical signiﬁcance of the switching mechanism of each gene pair.
[11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2742 2735 2743   Finding three-way interactions from transcript and genotype data  (a)  GDS2960_1 for top  (b)  GDS2736_25 for 2nd  (c)  GDS1875_3 for 3rd  (d)  GDS2733_1 for 4th  (e)  GDS2545_5 for 5th  1 A B U  3 2  .
2 2  .
1 2  .
0 2  .
9 1  .
A 1 F S R F N T  8 2  .
6 2  .
4 2  .
2 2  .
H C T  I  6 0  .
2 0  .
.
2 0    0 0 4  .
H 5 P T A  0 9  .
3  0 8 3  .
6 3  .
4  .
3  2 3  .
0 3  .
8 2  .
6 2  .
5 A P S H  1.6  1.7  1.9  1.8 COX6C  2.0  2.4  2.6  2.8 RERE  3.0  3.2  0.0  0.5 ATP5D  1.0  2.8 2.9 3.0 3.1 3.2 3.3  2.8  2.9  3.0  3.1  3.2  ATP5G1  NCSTN  (f)  GDS2733_4 for 6th  (g)  GDS1627_2 for 7th  (h)  GDS2960_1 for 8th  (i)  GDS2960_1 for 9th  (j)  GDS2643_9 for 10th  6 A F U D N  3 3  .
1 3  .
9 2  .
7 2  .
6 A 5 2 C L S  0 1  .
5 0  .
.
5 0    .
5 1    J 5 P T A  2 3  .
1  .
3  0 3  .
9 2  .
1 A B U  3 2  .
2 2  .
1 2  .
0  .
2  9 1  .
3.1  3.3  3.5  3.7   1.5   0.5  0.5  1.5  3.05  3.15  NDUFA8  ALS2  3.25 ATP5G1  3.35  1.6  1.7  1.9  1.8 COX6C  2.0  .
5 1 1  .
0 1 1  .
5 0 1  I  1 4 X O C  .
0 0 1  5.5  6.0  7.0  6.5 NDUFA10  7.5  8.0  Fig.
10.
(a j) Expressions of two genes which give the smallest P-value of interaction test in the corresponding GDS of GEO.
5 CONCLUDING REMARKS We have presented a fast method for ﬁnding three-way gene interactions from transcript-and genotype-data and showed experimental results obtained by applying this method to  3 108 human brain samples.
In our experiments, we conﬁrmed the three- way interactions that we found in various manners.
Possible future work would be to apply our approach to various types of transcript- and genotype-data further to uncover three-way gene interactions, i.e.
biological switches by genotypes.
ACKNOWLEDGEMENTS The authors would like to thank anonymous reviewers for their helpful comments and advice.
Funding: Grant-in-Aid for Young Scientists 20700134, 20700269, 21680025 from Ministry of Education, Culture, Sports, Science and Technology (MEXT, in parts)  the Functional RNA Project of New Energy and Industrial Technology Development Organization (NEDO, in parts).
Conﬂict of Interest: none declared.
REFERENCES Ayer,D.E.
and Eisenman,R.N.
(1993) A switch from myc:max to mad:max heterocomplexes accompanies monocyte/macrophage differentiation.
Genes Dev., 7, 2110 2119.
Aylor,D.L.
and Zeng,Z.-B.
(2008) From classical genetics to quantitative genetics to  systems biolog: modern epistasis.
PLoS Genet., 4, e1000029.
Balding,D.J.
(2006) A tutorial on statistical methods for population association studies.
Nat.
Genet., 7, 781 791.
Barrett,T.
et al.
(2007) NCBI GEO: mining tens of millions of expression  proﬁles.database and tools update.
Nucleic Acids Res., 35, D760 D765.
Cordell,H.J.
(2002) Epistasis: what it means, what it doesn t mean, and statistical  methods to detect it in humans.
Hum.
Mol.
Genet., 11, 2463 2468.
Dixon,A.L.
et al.
(2007) A genome-wide association study of global gene expression.
Nat.
Genet., 39, 1202 1207.
Hastie,T.
et al.
(2001) The Elements of Statistical Learning: Data Mining, Inference,  and Prediction.
Springer, New York.
Kanehisa,M.
et al.
(2008) KEGG for linking genomes to life and the environment.
Nucleic Acids Res., 36, D480 D484.
Li,K.-C. et al.
(2004) A system for enhancing genome-wide coexpression dynamics  study.
Proc.
Natl Acad.
Sci.
USA, 101, 15561 15566.
Lo,S.-H. et al.
(2008) Discovering interactions among brca1 and other candidate genes associated with sporadic breast cancer.
Proc.
Natl Acad.
Sci.
USA, 105, 12387 12392.
Marchini,J.
et al.
(2005) Genome-wide strategies for detecting multiple loci that  inﬂuence complex diseases.
Nat.
Genet., 37, 413 417.
Mardia,K.V.
et al.
(1979) Multivariate Analysis.
Academic Press, New York.
McCarthy,M.I.
and Hirschhorn,J.N.
(2008) Genome-wide association studies: Past,  present and future.
Hum.
Mol.
Genet., 17 (Review Issue 2), R100 R101.
McCullagh,P.
and Nelder,J.
(1989) Generalized Linear Models.
2nd edn.
Chapman &  Hall CRC, Boca, Raton.
Miller,J.A.
et al.
(2008) A systems level analysis of transcriptional changes in  Alzheimer s disease and normal aging.
J.
Neurosci., 28, 1410 1420.
Myers,A.J.
et al.
(2007) A survey of genetic human cortical gene expression.
Nat.
Genet., 39, 1494 1499.
Nica,A.C.
and Dermitzakis,E.T.
(2008) Using gene expression to investigate the genetic basis of complex disorders.
Hum.
Mol.
Genet., 17 (Review Issue 2), R129 R134.
Schadt,E.E.
et al.
(2008) Mapping the genetic architecture of gene expression in human  liver.
PLoS Biol., 6, e107.
Vastrik,I.
et al.
(2007) Reactome: a knowledge base of biologic pathways and processes.
Genome Biol., 8, R39.
Welle,S.
et al.
(2003) Gene expression proﬁle of aging in human muscle.
Physiol.
Genomics, 14, 149 159.
Zhang,J.
et al.
(2007) Extracting three-way gene interactions from microarray data.
Bioinformatics, 23, 2903 2909.
[11:08 22/10/2009 Bioinformatics-btp531.tex]  Page: 2743 2735 2743  2743
