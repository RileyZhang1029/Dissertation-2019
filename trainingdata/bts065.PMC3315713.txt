Motivation: A reconstruction of full-length transcripts observed by next-generation sequencer or tiling arrays is an essential technique to know all phenomena of transcriptomes.
Several techniques of the reconstruction have been developed.
However, problems of highlevel noises and biases still remain and interrupt the reconstruction.
A method is required that is robust against noise and bias and correctly reconstructs transcripts regardless of equipment used.
Results: We propose a completely new statistical method that reconstructs full-length transcripts and can be applied on both next-generation sequencers and tiling arrays.
The method called ARTADE2 analyzes positional correlation, meaning correlations of expression values for every combination on genomic positions of multiple transcriptional data.
ARTADE2 then reconstructs full-length transcripts using a logistic model based on the positional correlation and the Markov model.
ARTADE2 elucidated 17 591 full-length transcripts from 55 transcriptome datasets and showed notable performance compared with other recent prediction methods.
Moreover, 1489 novel transcripts were discovered.
We experimentally tested 16 novel transcripts, among which 14 were confirmed by reverse transcriptionpolymerase chain reaction and sequence mapping.
The method also showed notable performance for reconstructing of mRNA observed by a next-generation sequencer.
Moreover, the positional correlation and factor analysis embedded in ARTADE2 successfully detected regions at which alternative isoforms may exist, and thus are expected to be applied for discovering transcript biomarkers for a wide range of disciplines including preemptive medicine.
Availability: http://matome.base.riken.jp Contact: toyoda@base.riken.jp Supplementary information: Supplementary data are available at Bioinformatics online.
Received on July 4, 2011; revised on January 25, 2012; accepted on January 30, 2012 To whom correspondence should be addressed.
Present Address: Center for Plant Cell Biology, Department of Botany and Plant Sciences, University of California, Riverside, 3119A IIGB, Riverside, CA 92521, USA.
1 INTRODUCTION Every cell of every organism has a signature set of RNA molecules with certain fractions, called the transcriptome.
The transcriptome carries out specialized cell activities.
To know all about the transcriptome is an essential step for understanding life.
Several technologies are developed therefore to observe the transcriptome.
Hybridization-based methods with genome tiling arrays have been used to approach all phenomena in the transcriptome for species such as humans, mice or Arabidiopsis thaliana whose genome sequences have been read with high quality (Shoemaker et al., 2001; Yamada et al., 2003).
On the other hand, high-throughput sequencers, typically called next-generation sequencers (NGS), are emerging as a major equipment to acquire information about transcriptomes by the method called mRNA-Seq, because they can be applied not only for well-studied organisms but also for other exotic organisms (Mizrachi et al., 2010; Xu et al., 2011).
Using either method, a reconstruction of the shape of fulllength RNA/transcripts from observation results is still a critical step in the study, because both genome tiling array probes and NGS reads are short (<100 nt) and represent partial observations of original molecules whose lengths are 1000 nt and more.
There are several computational programs that address this issue.
We have also developed ARTADE1, an abbreviation for ARabidopsis Tiling-Array-based Detection of Exonsthe previous version of ARTADE, to reconstruct the shape of mRNA molecules based on genome information and mRNA expression profiles from genome tiling arrays (Toyoda and Shinozaki, 2005).
Cufflinks is one of the major programs applied for mRNASeq results (Trapnell et al., 2010).
However tiling array and mRNA-Seq results often contain high levels of noise, which may come from observation machinery and biological fractions (Roberts et al., 2011a; Royce et al., 2005, 2007).
This makes the reconstruction of full-length transcripts more difficult if the dynamic range of expression values is low.
Besides, it is known that amplification, hybridization and sequencing biases cause bad effects on observations.
Almost all recent methods try to reconstruct fulllength transcripts by only using transcriptome on a single condition.
We think, however, there is a theoretical limit to the extent these methods can remove noise and bias.
The Author(s) 2012.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
toyoda@base.riken.jp Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [12:32 12/3/2012 Bioinformatics-bts065.tex] Page: 930 929937 S.Kawaguchi et al.ARTADE2 takes a novel approach to these problems named positional correlations that are correlations of expression values for every combination of genomic positions in multiple conditions (Fig.1).
The approach is based on the principle that the correlation coefficient of expression values derived from the same RNA molecule must be 1 for every pair of positions corresponding to the RNA molecule.
Positional correlation also has robustness even if expression values suffer from sequence bias, amplification and noise (details are described in Section 2.1).
The concept of correlations is common to tiling arrays and next-generation sequencing.
We established this idea with our new statistical method termed ARTADE2.
ARTADE2 and the positional correlation information allow us to treat multiple sets of transcriptomes and obtain more reliable full-length transcripts.
With this article, we show that ARTADE2 certainly improves reconstruction of RNA molecules shapes.
ARTADE2 inherits some ideas from ARTADE1 about the statistical model for transcription and genome sequence information.
ARTADE1 used the expression values themselves to elucidate the exon structure genome sequence under the assumptions of the Markov model, but did not take correlation into account (Toyoda and Shinozaki, 2005).
ARTADE2 in contrast also can be applied to all species whose genome have been read and can treat NGS data.
ARTADE2s positional correlation approach also has good performance in detecting mRNA regions that may have alternative splicing, transcript starts and polyadenylation sites.
If RNA molecules of alternative isoforms are observed under some conditions, positional correlations between the isoform region and another exon region must be not 1, because fractions of expression values for these regions are different in some conditions.
In this article, we propose a method for dissecting the difference of positional correlations based on factor analysis.
We demonstrate that ARTADE2 can detect and visualize alternative isoforms from multiple transcriptomes.
2 METHODS 2.1 Reconstruction of full-length transcripts from positional correlations with a mathematical model The full-length transcript structure was predicted using a mathematical model based on positional correlation that checks every possible combination of tiling arrays or tags of mRNA-Seq under multiple conditions (Fig.1).
Ideally, expression values of the k-th condition (k =1...,K) derived from the same RNA molecule have the same value vk in all positions of its exon regions.
Let p={p1,...,pt} be set of exon positions and vpl ={v1pl ,...,vKpl } be expression values of position pl.
Obviously, r(vm,vn)=1 for every position pair (m,n) in p, where r represents Pearsons correlation, because vkm =vk regardless of position m. The correlation also has robustness of bias and amplification attributed independently to each probe.
The correlation r(vm,vn) is still 1 even if the expression value of position m is changed by bias and amplification i.e.vkm =Amvk +Bm, where Am is the amplified coefficient and Bm is bias by sequences around position m, respectively.
If noise is added, for example vkm =Amvk +Bm +(0,2m), where (0,2m) is Gaussian noise of mean 0 and variance 2m(<) and independent with all others, unfortunately an expectation of r(vm,vn) is vmvn/2vm +2m 2vn +2n <1, where 2vm is variance of vm.
Even if this is the case, variances 2vm and 2 vn increase when including multiple conditions which have variety of expression values in contrast to fixed 2m and 2 n. The influence of noise therefore is reduced with an increase of condition variations.
Moreover, if there are no observations derived from RNA molecules at position m i.e.vkm =Bm +(0,2m) for all Fig.1.
Positional correlation of transcriptomes mapped on a 2D omic-space plane (Toyoda and Wada, 2004).
Positional correlations are calculated from every possible combination of 18 conditional (55 experiments) tiling arrays.
Prediction of exon structure using only one measurement is difficult because each fragment is influenced by bias and noise.
Exon structure is clearly shown, however, by using positional correlations of tiling array probes.
As a result, ARTADE2 could predict two transcripts in the region including a novel transcript (chromosome 1 Plus 11616183..11617412).
The novel transcript was also evaluated by reverse transcriptionpolymerase chain reaction (RTPCR) and cDNA sequencing.
(find OMAT1P011320 on Fig.6 and Supplementary Table S5.)
k, an expectation of r(vm,vn) is 0 for every n. As a result, the structure of the transcript emerges by taking positional correlations of genomic positions under multiple conditions (Fig.1).
We named the reconstruction method as ARTADE2.
The ARTADE2 algorithm is illustrated in Figure 2.
In this algorithm, we use the positional correlation matrix score (PCS) to measure consistency between the predicted transcript and its positional correlations using threshold of correlation coefficient (the calculation procedure for PCS is described in Supplementary Fig.S1).
PCS is high if many positional correlations have higher values than for pairs of positions both of which belong to exons of the same transcript, while positional correlations have smaller 930 Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [12:32 12/3/2012 Bioinformatics-bts065.tex] Page: 931 929937 Positional correlation analysis of transcriptomes Fig.2.
ARTADE2 algorithm.
A region in which positional correlations are high is selected as a candidate for predicted transcripts.
Then estimations of threshold parameter and exon structure are alternately iterated while PCS increases.
Finally, a transcript is obtained if the PCS value of the transcript exceeds 0.5. values than for the pairs of other combinations of positions; i.e.exon intron, intronintron, exonintergenic region or exons of different transcripts.
PCS becomes, therefore, a criterion for determining whether the predicted transcript should be recorded.
ARTADE2 predicts transcript s by a logistic model based on Markovian nucleotide transitions of genome x and the PCS of positional correlations R formulated as P(S=s|x,R,)= exp{MTS(s,x)+CMS(s,R,)+IS(s)+ES(s)} Z(S) , (1) where Z(S) is the normalized constant.
There are four scores in Equation (1).
Markov transition score (MTS) is obtained from the probability of Markov transitions for states of transcripts and genome sequences.
Correlation matrix score (CMS) is proportional to transcript length and PCS.
Exon score (ES) and intron score (IS) are calculated from probabilistic distributions of exon and intron lengths of predicted structure.
Exons and introns of the transcript are iteratively estimated by maximizing Equation 1) and optimizing threshold parameter.
Hyperparameters , and were previously estimated by training with 2813 RIKEN Arabidopsis full-length (RAFL) cDNAs on the plus strand of Chromosome 1.
A mathematical description of the method is described in Supplementary Material: ARTADE2 Mathematics.
We then record the transcript when the final estimated transcript has a PCS value >0.5.
The prediction is continued until the entire genome has been scanned.
2.2 Preparing for comparison targets This article describes our use of the original ARTADE model (Toyoda and Shinozaki, 2005), which we namedARTADE1, for performance comparisons with our present method.
ARTADE1 predicts transcripts from one sample tiling arrays and sequences of nucleotides through the Markov model (Supplementary Fig.S2).
Transcripts with P <1108 for their structures were independently predicted under 18 different conditions by ARTADE1.
We chose a representative transcript by selecting the predicted transcript with the lowest P-value among the 18 conditions.
The method can be downloaded from www.sourceforge.net (the present version is 1.2.2.2).
We also performed Cufflinks and Cuffmerge (Roberts et al., 2011b; Trapnell et al., 2010) to reconstruct transcripts based on NGS data, which were used as comparison targets.
Initially, we performed Cufflinks on each mapping result, and then we merged the predicted sets with Cuffmerge.
For the transcript set for Cufflinks, we selected the longest predicted model as the representative transcript if there are more than two predicted models in the same locus.
Fig.3.
Calculation procedure of match rate used in Tables 1 and 2.
The size of each region used for the match rate is measured at single nucleotide resolution.
2.3 Evaluation of predicted transcripts We compared predicted full-length transcripts with references to assess a performance ofARTADE2.
The set of predicted transcripts must be expressed under some conditions.
Besides this, most of predicted transcript structures must correspond to known transcript structures of Arabidopsis, because the full-length cDNAs of Arabidopsis have been significantly researched as a model for plant species.
We therefore compared predicted transcripts with 39 361 TAIR9 (The Arabidopsis Information Resource version 9) gene models (http://www.arabidopsis.org).
The TAIR8 genome is used for mapping of tiling arrays and mRNA-Seq data.
We therefore transferred the TAIR9 gene models according to the TAIR8 genome.
We paired predicted transcripts with the TAIR9 reference if they had at least 30% overlap in the region.
If more than two transcripts fit, we selected the best-fit transcript pair by comparison among them.
The judgment boundary about correctness of 5 and 3 ends was set at a 300 bp distance between the prediction and TAIR9 ends.
The match rate of the predicted transcript was calculated from a correspondence as shown in Figure 3.
For Figure 5, Supplementary Figs S6 and S7, we calculated precision and recall of the predicted transcript models on references with a way modified from the match rate, because some prediction methods used for the comparison provide multiple transcript models for a single locus.
Locations outside the transcripts (O) and introns (I) were treated as the same in calculations of precision and recall.
We also allowed correspondences between multiple predicted transcripts and multiple reference transcripts.
When a position had inconsistency in multiple transcripts of prediction or annotation, such as exon and intron or exon and outside, the position was considered as an exon.
2.4 Implementation of factor analysis The factor analysis method embedded in ARTADE2 is based on a maximum likelihood (ML) method.
The first and second factors obtained by ML method are rotated obliquely using the criterion of promax rotation (Hendrickson and White, 1964) after an orthogonal varimax rotation (Kaiser, 1958).
From the obtained first and second major factor loadings, we checked availability of separation for the predicted transcript.
If different factors were found, we re-predicted the transcript by dividing the region at the edge of two factors.
The same techniques were also applied to exons of the transcript predicted by ARTADE2 for the detection of alternative isoforms.
The detected region consists of a cluster of high factor loading probes.
For the detection, the number of factors was estimated by using minimum average partial method (Velicer et al., 2000).
We here define a discreteness value given to each cluster.
The discreteness value measures a density of high factor loadings in cluster.
Detail for the cluster detection algorithm and a definition of the discreteness is described in Supplementary Material (sections: Use of factor analysis to remove concatenation of different transcripts and and Factor Analysis for detection of regions having alternative isoforms).
931 Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [12:32 12/3/2012 Bioinformatics-bts065.tex] Page: 932 929937 S.Kawaguchi et al.2.5 Dataset We used tiling arrays for 55 experiments with A.thaliana observed under 18 conditions (Supplementary Table S1).
The GeneChip Arabidopsis tiling arrays set (1.0F Array and 1.0R Array, Affymetrix) was used.
Details of RNA sample preparation were described previously (Matsui et al., 2008; Okamoto et al., 2010).
Probe sequences of the tilling array set were mapped to genome of Arabidopsis TAIR8.
The tiling array has intensity of perfectly matching (PM) probes and mismatch (MM) probes.
We calculated expression signals from PM, MM values with MAS5 algorithm.
Pre-processing of tiling array data were described earlier (Iida et al., 2011).
All data are available at Gene Expression Omnibus (http://www.ncbi.nlm.nih.gov/geo/info/linking.html) under accession numbers GSE9646, GSE15700 and GSE26074.
We also used mRNA-Seq dataset with SOLiD3 Plus system (Applied Biosystems) for 16 libraries from 7 conditions (Supplementary Table S1), which are a subset of samples used for tiling array experiments.
We mapped mRNA-Seq tags to the A.thaliana genome (TAIR8) with TopHat (Trapnell et al., 2009).
We normalized mRNA-Seq data into each library having 1 GB of tags (i.e.20 million reads); see Supplementary Table S2.
3 RESULTS AND DISCUSSION 3.1 Full-length transcript structures predicted with ARTADE2 significantly validated by
