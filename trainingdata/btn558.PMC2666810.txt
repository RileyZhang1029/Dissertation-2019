BIOINFORMATICS ORIGINAL PAPER Vol.
25 no.
8 2009, pages 1033 1039  doi:10.1093/bioinformatics/btn558  Genetics and population analysis Bayesian robust analysis for genetic architecture of quantitative traits Runqing Yang1,2, , , Xin Wang1, , Jian Li2 and Hongwen Deng2,  1School of Agriculture and Biology, Shanghai Jiaotong University, Shanghai 200240, People s Republic of China and 2School of Medicine, University of Missouri Kansas City, Kansas City, MO 64108, USA Received on May 14, 2008  revised on October 11, 2008  accepted on October 24, 2008 Advance Access publication October 30, 2008 Associate Editor: Alex Bateman  In most quantitative trait  ABSTRACT Motivation: locus (QTL) mapping studies, phenotypes are assumed to follow normal distributions.
Deviations from this assumption may affect the accuracy of QTL detection and lead to detection of spurious QTLs.
To improve the robustness of QTL mapping methods, we replaced the normal distribution for residuals in multiple interacting QTL models with the normal/independent distributions that are a class of symmetric and long-tailed distributions and are able to accommodate residual outliers.
Subsequently, we developed a Bayesian robust analysis strategy for dissecting genetic architecture of quantitative traits and for mapping genome-wide interacting QTLs in line crosses.
Results: Through computer simulations, we showed that our strategy had a similar power for QTL detection compared with traditional methods assuming normal-distributed traits, but had a substantially increased power for non-normal phenotypes.
When this strategy was applied to a group of traits associated with physical/chemical characteristics and quality in rice, more main and epistatic QTLs were detected than traditional Bayesian model analyses under the normal assumption.
Contact: runqingyang@sjtu.edu.cn  dengh@umkc.edu Supplementary information: Supplementary data are available at Bioinformatics online.
fall  into one of  locus (QTL)  1 INTRODUCTION In experimental line crosses, most parametric methods for mapping quantitative trait three types of approaches, least-squares, maximum likelihood or Bayesian approach.
A common characteristic of these methods is that they all assume normally distributed phenotypes.
However, many traits do not follow normal distributions, this may arise by non-normal traits, such survival time, and others may be the result of human measurement error.
This deviation from the normality assumption by phenotypes can render many QTL mapping approaches inappropriate, in senses of less accuracy and effectiveness in QTL detection (Coppieters et al., 1998), and unstable results due to outliers (Pinheiro et al., 2001).
To whom correspondence should be addressed.
The authors wish to be known that, in their opinion, the ﬁrst two authors should be regarded as joint First Authors.
To improve the robustness, various approaches have been developed to deal with non-normal phenotypes in QTL mapping.
A simple approach is to adopt parametric methods known for their robustness.
However, their robustness for non-normal phenotypes is difﬁcult to establish (e.g.
Coppieters et al., 1998  Hackett, 1997  Jansen, 1992  Rebaï, 1997).
A second approach is to convert non-normal traits into approximately normal variables through mathematical transformation (Sokal and Rohlf, 1995  Yang et al., 2006).
Distribution-free non-parametric methods were also developed for mapping non-normal traits for various population structures (Coppieters et al., 1998  Elsen et al., 1999  Kruglyak and Lander, 1995  Zou et al., 2003).
Yet another approach is to replace the normal assumption about the data with other distributions to better ﬁt the trait data (Diao et al., 2004  Feenstra and Skovgaard, 2004  Jansen, 1992  Symons et al., 2002).
When the data is non-normal, assuming that the distributions of random effects and of residuals of Gaussian distributions makes inferences vulnerable to the presence of outliers (Pinheiro et al., 2001).
To accommodate these outliers, some symmetric and long- tailed distributions, such as the Student s-t distribution (Dempster et al., 1980  Lange et al., 1989  Rogers and Tukey, 1972), have been suggested for robust estimation.
The normal/independent distributions (Andrews and Mallows, 1974  Lange and Sinsheimer, 1993) are a class of symmetric and long-tailed distributions and are used in linear regression models, within a Bayesian framework (Liu, 1996).
Fernandez and Steel (1998) applied the method of inverse scaling of the probability density function on the left and on the right side of a non-normal distribution to a symmetric heavy- tailed distribution and have simultaneously captured heavy tails and skewness.
Rohr and Hoeschele (2002) have incorporated the Fernandez and Steel s approach into a Bayesian QTL mapping, developing a robust Bayesian QTL mapping method, which allows for non-normal, continuous distributions of phenotypes within QTL genotypes in single QTL models.
The genetic architecture of quantitative traits includes the number and locations of QTL and their main and epistatic effects.
In particular, the unknown number of QTL and possible huge epistatic effects make the dissection for genetic architecture of quantitative traits extremely complex.
Fortunately, with a computationally efﬁcient Markov Chain Monte Carlo (MCMC) algorithm, Bayesian model selection frameworks have been developed for identifying epistatic QTL for complex traits (Yi et al., 2005, 2007).
However, normal distributions were assumed for these approaches.
2008 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1033  1033 1039   R.Yang et al.
The effects of deviation from this assumption have not been fully addressed.
In this article, we developed a Bayesian robust analysis strategy for studying the genetic architecture of quantitative trait, by combining the ﬂexibility of Bayesian approach in modeling multiple QTL and their interactions and the better phenotypic ﬁtting of symmetric and long-tailed distributions in characterizing non- normal traits.
We investigated the robustness of the proposed method by a series of simulations, and applied it to a real dataset in rice.
Our method showed an improved power in mapping QTLs with non-normal phenotypes.
2 METHOD 2.1 Genetic model For simplicity, we consider a mapping population with only two segregating genotypes, e.g., a backcross, double haploid lines (DHLs) or recombinant inbred lines (RILs).
However, the method can be applied to other experimental designs, such as F2 design.
The phenotypes and molecular marker data were collected on n individuals.
Assuming that there are q QTLs responsible for a trait of interest, the phenotypic value yi of individual i can be then described by the following multiple interacting QTL model:  yi = µ+ q(cid:1)  γjxijαj+ q(cid:1)  q(cid:1)  γjkzijk δjk+εi  k j  j=1  j=1  (1) where µ is the population mean  αj for j=1, 2,...q is the additive effect of the j-th QTL  δjk is the epistatic effect between j-th QTL and k-th QTL for j=1, 2,... ,q  k= j+1,j+2,...,q.
Variable xij is a genotype indicator variable for individual i at locus j and is deﬁned as 1 for one genotype and  1 for the other genotype, and zijk = xijxik  γ  is a binary variable for each genetic effect (additive or epistatic), indicating whether the corresponding effect is included (γ =1) or excluded (γ = 0) from model (1).
Through inferring the γ , we shall adopt Bayesian model selection to MCMC sampling in a reduced model space  and εi is a random environmental error.
To cover outliers from non-normal distributed phenotypes, we introduce the normal/independent distributions to describe random environmental errors, denoted by εi = ei/ wi, where ei   N(0, σ 2) and wi is a positive random variable with density p(w df ) with df being a scalar parameter.
The type of normal/independent distributions depends on the distribution of w. For instance, if w is taken to be Gamma(df /2, df /2), the normal/independent distribution becomes a t-distribution  p(w df )= dfwdf 1 results in a (cid:2) slash distribution (Lange and Sinsheimer, 1993  Rogers and Tukey, 1972)  and the contaminated normal distribution arises when p(w df )= with 0  v  1 and 0   τ  1, where vand τ are scalar 1 ν parameters (Little, 1988).
These three distributions are the most common long-tailed distributions for robust inference.
Apparently, the normal model is a special case by taking wi =1, for all i.  if w= τ if w=1  ν  2.2 Likelihood function The probability distribution of the phenotype data conditional on all parameters is called the likelihood.
Based on model (1), the conditional density of all phenotypes, given the parameters, is  2  (cid:6)    n 2  (σ 2)  (cid:3) (cid:5) 1 p(y w,x,z,λ,µ,γ ,β,σ 2)  n(cid:4) γjxijαj  q(cid:7)   q(cid:7) q(cid:7) i=1 Where y= yi , λ=(cid:11) , γ =(cid:11) ,β=(cid:11) (cid:12) (cid:12) j=1 j=1 2,...,n, j=1, 2,...,q and k= j+1, j+2,...,q.  αj δjk  exp  wi  k j  λj    1 2σ 2  γjkzijk δjk  γj γjk  n(cid:7) (cid:9)(cid:10) i=1 (cid:12)  (cid:8)  yi µ  wi  and w= wi , for i=1,     2.3 Prior distribution As described by Yi et al.
(2005), we take L, the maximal number of QTLs as l0+3 The binary indicator γ has an independent prior p(γ )=(cid:4) l0, where l0 is the prior expected number of all QTLs including main- effect and epistatic QTLs that is determined based on traditional methods.
p γ  (1 p )(1 γ ), where p is the prior inclusion probability for a certain QTL effect and equals to a predetermined hyper-parameter pm for main effect or pe for epistatic effect.
The population mean µ is assumed to have a prior p(µ)  constant.
A hierarchical mixture model is proposed as the prior distribution for each  1σ 2) for n i=1 wix2 genetic effect, denoted by αj ij)  1σ 2) for the additive effects and δjk epistatic effects, where c takes a value such that the prior variance of each QTL effect stays approximately the same as n increases.
Here, we let c= n. A scaled inverse-χ 2 distribution with hyper-parameters ve and se will be  (cid:13)(cid:13)(γj,σ 2,x j)   N(0,γjc( (cid:13)(cid:13)(γjk ,σ 2,z jk)   N(0,γjkc( (cid:7)  (cid:7) n i=1 wiz2  ijk)  adopted as prior for σ 2, i.e.
(cid:14)  (cid:8)  ve,  vese  (cid:16)  (cid:15) 1  .
σ 2 ve,se   IC for scalar parameter df  The prior of normal/independent distributions for speciﬁcation of the prior is given in Appendix A.  is speciﬁed based on the type residual error.
The detailed The prior for position of the j-th QTL is p(λj)=1/dj, where dj is the length of the marker or adjoining QTLs interval where the j-th QTL resides.
2.4 Posterior distribution and MCMC sampling The joint posterior density of all unknown parameters is then:  p(w,x,z,λ,µ,γ ,β,σ 2 y,m )= (cid:13)(cid:13)γj,σ 2,x j )p(δjk  p(y w,x,z,λ,µ,γ ,β,σ 2)p(df )p(w df )p(λ)  p(x λ,m )p(z λ,m )p(µ)p(γ )p(σ 2 ve,se )  p(αj where m is the known marker information  forj=1, 2,...,q.
(cid:13)(cid:13)γjk ,σ 2,z jk )  (2)  In order to implement Bayesian estimation via the MCMC, the marginal posterior distributions of all parameters need to be derived from the above joint posterior density (2) by ﬁxing other parameters.
For convenience, we ﬁrst let  q(cid:1)  γjkzijk δjk .
k j  j=1  Gi = µ+ q(cid:1) (cid:8)  γjxijαj+ q(cid:1) (cid:15) yi Gi+µ other all  j=1  on  wi  , and varianceˆσ 2 parameters, the  0  (cid:3)  The fully conditional posterior density of the population mean µ, given all other parameters, can be shown to be a normal distribution with mean ˆµ=  (cid:5) 1 n(cid:7)  (cid:5) 1  =  wi  σ 2.  n(cid:7) i=1  wi  i=1  (cid:3) n(cid:7) i=1  j  (  of  In  the   1  and  ˆσ 2  wix2 ij)  variance  n(cid:7) i=1  independent.
Conditionally  posterior wix2 ij)  the QTL effects density is  wixijk(yi Gi+zijk δjk) and variance ˆσ 2  particular, distribution of αj wixij(yi Gi+xijαj),  are mutually fully n(cid:7) normal with mean conditional ˆαj = c = c n(cid:7) c+1 ( c+1 i=1  1σ 2, for j=1,2,...,q.
Likewise, the conditional posterior distri- i=1 bution of δjk corresponds to the normal with mean ˆδjk = c  1 n(cid:7) c+1 ( ijk)  1σ 2, for j=1, i=1 2,...,q and k= j+1, j+2,...,q. the corresponding fully conditional n(cid:7) distribution is a scaled inverse χ 2 with parameters ve+n and (ve+n)se+ i=1  For wi(yi Gi)2.
So far, we note that wi can be interpreted as a  weight .
The speciﬁc forms of the posterior for wi depend on the normal/independent distribution adopted, and the posterior for degree of freedom df depend on the form of corresponding prior distribution (detailed in Appendix B).
the residual variance σ 2,  n(cid:7) i=1  n(cid:7) i=1  = c  c+1 (  wix2  wiz2  ijk)  jk  1034  [10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1034  1033 1039   The marginal posterior distribution of γ  is Bernoulli with a probability  p(γ =1)= (cid:3) (cid:17) (cid:17) c c+1 exp  p R  (cid:5)  (1 p )+p R   ˆα2 (cid:3) 2ˆσ 2   ˆδ2 2ˆσ 2  j  j  jk  jk  c c+1 exp  (cid:5) (j=1, 2,...,q) for the additive where, p = pm and R= (j=1, 2,...,q  k= j+1,j+ and R= effect  p = pe 2,...,q) for the epistatic effect.
If γ  is sampled to be zero, corresponding α or δ=0.
Otherwise, α or δ is drawn from its conditional posterior.
Only the position of QTL, where corresponding γ =1 for either main or epistatic effect, will be sampled.
Since the genotype of QTL (x) depends on the QTL position (λ), we decide to sample jointly as a block but proceed with the sampling wit one locus at a time.
Each locus is sampled from a variable interval (Wang et al., 2005  Zhang and Xu, 2005) whose boundaries are the positions of adjoining QTLs.
The prior distribution of λj can be written as  λj,xj  (cid:11)  (cid:12)  p(λj)= U(λj λj 1,λj+1)=1/dj =1/(λj+1 λj 1),  where λj 1 and λj+1 are the positions of the left and the right QTL.
Let λ(t) =[ x1j ... xnj]T be j be the current position of the locus of interest and x(t) j the genotype array of all individuals at the locus.
We ﬁrst sample a new = λj+δ, position for the QTL called the proposed position and denoted by λ  where δ is sampled from U( s,s) and s is a small positive number (tuning parameter), such as 1 cM.
For the new position, we simulate the genotypes for   all individuals, denoted by x j .
We then use the M H rule to decide whether λ  j should be accepted or not.
If λ  j is accepted, we update both the position and the genotype using λ(t+1) j and x(t+1) = λ  = x   j .
Otherwise, the old values of λj and xj are carried over so that λ(t+1) and x(t+1) = λ(t) .
Detailed formula of the M H acceptance rule can be found in (Wang et al., 2005) and Zhang and Xu (2005).
= x(t)  j  j  j  j  j  j  j  Genotypes of missing markers were generated randomly in each iteration on the basis of the probability inferred jointly from the nearest non- missing ﬂanking markers and the phenotype.
The probability from the markers is treated as the prior probability.
After incorporation of the marker (QTL) effects through the phenotype, the probability becomes the posterior probability, which is used to generate the missing marker genotype.
See, Wang et al.
(2005) for details.
In summary, the MCMC process is described in the following steps:  (1) Initialize all variables with some legal values or values sampled from  their prior distributions.
(2) Update population mean µ.
(3) Update the binary indicators γ .
(4) Update the additive QTL effects αj corresponding that γj =1.
(5) Update the epistatic QTL effects δjk corresponding that γjk =1.
(6) Update the residual variance σ 2 .
(7) Update the degree of freedom df (8) Update the  weight  wi (i=1,2,...,n).
(9) Update the QTL position λj corresponding that γ =1 and the  distribution, or v in the contaminated normal distribution.
in the t-distribution or Slash  genotypes for those QTLs.
(10) Impute the genotypes of missing markers.
(11) Repeat steps (2) (10) until the Markov chain reaches a desirable  length.
2.5 Post-MCMC analysis The posterior sample can be used to infer the genetic architecture of a quantitative trait.
Prior to doing this, we need to monitor the mixing behavior and convergence rates of MCMC algorithms by visually inspecting trace plots of the sample values of scalar quantities of interest or by using formal  Bayesian robust mapping analysis  diagnostic methods provided in the package R/coda (Plummer et al., 2004).
Model averaging accounts for model uncertainty and provides more robust inference compared with a single optimal model approach (Ball, 2001  Raftery et al., 1997  Sillanpää and Corander, 2002).
Therefore, we employ the model averaging to assess characteristics of the genetic architecture by averaging over possible models weighted by their posterior probabilities.
We can use various methods to graphically and numerically summarize and interpret the posterior samples.
The posterior inclusion probability for each locus is estimated as its frequency in the posterior samples.
Taking the prior probability into consideration, we use Bayes factors (BFs) to show evidence for inclusion against exclusion of each locus or effect.
The BF for a locus or effect is deﬁned as the ratio of the posterior odds to the prior odds for inclusion against exclusion of the locus or effect within each chromosomal interval of 1 2 cM (Kass and Raftery, 1995).
Generally, a threshold of BF is empirically determined as 3, or 2logBF=2.1, for declaring statistical signiﬁcance for each locus or effect (Kass and Raftery, 1995).
3 SIMULATION STUDIES For convenience of programming, we simulated 61 equally spaced co-dominant markers on a single large chromosome of a length 500 cM for a backcross population with sample sizes of 150 and 300.
We simulated the four QTLs, two pairs of which are assumed to mutually interact.
The total genetic variance contributed by all main-effect and epistatic QTLs was 45.06, where the proportion of phenotypic variance contributed by an individual QTL ranged from 0.95% to 11.63%.
The population mean and the residual variance were set at µ=5.0 and σ 2=3.0.
We use non-Bayesian and Bayesian methods to analyze the simulated data.
Non-Bayesian mapping is implemented with EM algorithm through two dimensional scan.
Detected QTL effects are estimated using multiple QTL imputation.
The critical values at signiﬁcance level of 5% are 3.9 for main effect and 6.7 for epistatic effect, which are obtained with 1000 permutations.
In all Bayesian mapping analysis, we set the prior number of main-effect QTL at three and the prior expected number of epistatic QTL at three, then the upper bound of the number of QTL, L=   6+3 6=13.
The actual values for the hyper-parameters take ve=0 and se=1  a=1 and b=0.01.
The initial values of all variables are sampled from their prior distributions.
The MCMC is run for 6000 cycles as burn-in period (deleted) and then for additional 100 000 cycles after the burn-in.
Note that here the length of the burn-in is judged by visually inspecting the plots of some posterior samples across rounds.
The chain is then thinned to reduce serial correlation by saving one observation in every 40 cycles.
The posterior sample contains 2500 observations for the post-MCMC analysis.
Considering each simulation is more time consuming, the simulation experiment was replicated 50 times for statistical power evaluation.
In order to demonstrate the ﬂexibility of the Bayesian robust mapping proposed here, we use residual errors drawn from t-distribution with df =3 to generate the two samples of different size, according to model (1).
Those data were analyzed by adopting the Bayesian robust mapping with a t-distribution, slash distribution and contaminated normal distribution for residuals, traditional Bayesian and non-Bayesian mapping procedures with normal residuals, respectively.
The statistical powers of all the methods for QTL detection are given in Table 1.
In general, Bayesian robust mapping has higher statistical powers for QTL detection than traditional Bayesian and non-Bayesian mapping if the residual error  1035  [10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1035  1033 1039   R.Yang et al.
is subject to heavy-tailed distribution.
The estimates for positions and effects of QTL detected by all methods are fairly close to true parameter values.
As expected, the model is more robust with  Table 1.
Statistical power of QTL detection (%) and type I error rate (%, in the last column) obtained by various mapping methods  Sample size  Distribution  QTL no.
150  300  1  2  70 62 60 36 16 100 96 76 50 44  100 92 80 74 28 100 100 100 90 70  3  48 26 30 8 0 82 74 42 36 30  4  92 90 84 80 32 100 100 100 80 78  5  56 20 20 6 4 84 84 36 20 20  6  36 20 16 2 0 64 54 34 30 18  2 4 4 6 6 0 2 2 4 4  t Slash Contaminated Normal Non-Bayesian t Slash Contaminated Normal Non-Bayesian  increased heritability and sample size (Tables 2 and 3).
Statistical power of QTL detection increases as sample size and genetic contribution proportion increase.
The type I error rates of all methods are  6%.
On the whole, as statistical power rises, error rate falls.
We further generated normally distributed phenotypes by sampling residuals from normal distribution and analyzed them with both the Bayesian robust mapping and traditional Bayesian mapping.
Results (provided in Section 1 of Supplementary Material) indicated that applying the Bayesian Robust analysis for data being normally distributed had similar powers as using traditional Bayesian mapping methods.
4 REAL DATA ANALYSIS A 162 F10 RILs derived from the hybrids of Dasanbyeo (a Korean tongil type rice)   TR22183 (a Chinese japonica variety) had been designed for mapping QTL for traits associated with physical/chemical characteristics and quality of rice.
On the basis of the population, we have constructed the framework linkage map of 1437.5 cM long using 208 SSR and STS markers.
This map consists of the 16 linkage groups (LGs) for each parental map.
We analyzed the data with the Bayesian robust mapping with different  Table 2.
Mean estimates and SDs (in parentheses) of QTL positions detected by various mapping methods  Sample size  Distribution  QTL no.
150  300  1  2  3  4  True position t Slash Contaminated Normal Non-Bayesian t Slash Contaminated Normal Non-Bayesian  56 55.3 (5.1) 54.2 (4.8) 56.2 (5.9) 52.6 (4.2) 55.7 (6.9) 57.6 (2.9) 55.9 (3.1) 56.0 (3.5) 57.4 (3.9) 57.1 (4.1)  148 148.9 (2.4) 148.4 (3.4) 147.9 (4.3) 148.1 (4.9) 150.2 (5.4) 148.3 (3.1) 149.4 (2.5) 146.4 (2.9) 147.9 (2.4) 149.5 (3.3)  267 268.2 (5.6) 268.4 (3.0) 269.0 (7.5) 258.0 (9.8)   266.4 (3.5) 266.3 (4.6) 264.3 (3.5) 264.0 (6.1) 266.1 (7.3)  359 358.9 (3.5) 358.7 (4.9) 359.8 (3.9) 359.4 (3.6) 361.3 (5.8) 357.5 (2.7) 357.9 (2.4) 357.8 (3.0) 359.4 (3.2) 359.0 (3.4)  5 56  267 57.8 (11.0) 267.9 (8.8) 58.1 (8.9) 265.7 (9.2) 57 (13.3) 263.8 (12.7) 56.1 (13.0) 264.6 (15.2) 61.2 (15.1) 268.6 (18.4) 58.4 (5.3) 265.4 (7.8) 57.4 (3.8) 266.2 (7.3) 57.7 (8.8) 269.0 (9.9) 52.4 (10.1) 270.5 (10.5) 54.4 (13.6) 268.2 (10.1)  6 148 359 151.3 (7.7) 356.9 (6.3) 150.1 (7.0) 358.2 (7.7) 148.0 (6.8) 360.9 (9.2) 143.0 ( ) 360.0 ( ))   149.8 (4.5) 359.3 (3.9) 150.6 (4.8) 359.0 (5.1) 149.0 (3.5) 359.2 (5.4) 145.0 (8.0) 358.4 (8.1) 151.7 (9.1) 360.8 (7.4)  Table 3.
Mean estimates and SDs (in parentheses) of QTL effects detected by various mapping methods  Sample size  Distribution  QTL no.
1  2  3  4  5  6  True Effect t Slash Contaminated Normal Non-Bayesian t Slash Contaminated Normal Non-Bayesian  0.45 0.50 (0.09) 0.51 (0.10) 0.51 (0.12) 0.56 (0.20) 0.81 (0.52) 0.46 (0.07) 0.45 (0.09) 0.45 (0.09) 0.52 (0.19) 0.78 (0.41)  0.70 0.73 (0.10) 0.77 (0.13) 0.76 (0.14) 0.74 (0.22) 1.04 (0.44) 0.70 (0.08) 0.72 (0.09) 0.70 (0.12) 0.72 (0.14) 0.89 (0.30)  0.30 0.35 (0.06) 0.38 (0.04) 0.39 (0.17) 0.46 (0.29)   0.33 (0.13) 0.35 (0.07) 0.39 (0.18) 0.41 (0.28) 0.58 (0.38)  0.55 0.57 (0.14) 0.54 (0.09) 0.62 (0.10) 0.63 (0.14) 0.87 (0.43) 0.57 (0.08) 0.56 (0.08) 0.60 (0.14) 0.61 (0.18) 0.83 (0.35)  0.30 0.25 (0.09) 0.23 (0.10) 0.37 (0.12) 0.39 (0.20) 0.68 (0.48) 0.26 (0.07) 0.25 (0.09) 0.35 (0.09) 0.36 (0.18) 0.64 (0.42)  0.20 0.23 (0.10) 0.27 (0.13) 0.26 (0.14) 0.31 ( )   0.23 (0.08) 0.25 (0.09) 0.25 (0.12) 0.28 (0.17) 0.51 (0.29)  150  300  1036  [10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1036  1033 1039   Bayesian robust mapping analysis  type of distributions and traditional Bayesian mapping procedure with normal residuals, respectively.
In all Bayesian analyses, based on results from the interval non- epistatic mapping (Lander and Botstein, 1989) and two-dimensional genome scan, the prior number of main-effect QTL was set at lm=3 and the prior expected number of all QTL (l0) was taken to be lm+5.
The upper bound of the number of QTL, L, was then 16.
The initial value of each unknown parameter took the same one as in simulation study.
The MCMC was run for 200 000 cycles after the burn-in of 6000 cycles.
It was found that the mapping results from 13 of 21 traits of interest support the Bayesian robust mapping procedure.
Herein, we take the peak viscosity (PKV) as an example trait to compare the mapping results based on different residual distributions.
The estimates for positions and genetics effects of QTL detected with the Bayesian robust mapping and the traditional bayesian mapping method are listed in Tables 4 and 5, respectively.
Apparently, the results from different distributions are comparable: three main-effect QTLs and seven pairs of epistatic QTLs, covering all QTL detected by other methods, are identiﬁed with Bayesian robust mapping with a t-distribution, and followed by one main- effect QTL and four pairs of epistatic QTLs with slash distribution for residuals, one main-effect QTL and three with contaminated  normal distribution for residuals and one main-effect QTL and two pairs of epistatic QTL with normal distribution for residuals, whereas only one main effect QTL on seventh LG with non-Bayesian method.
This implies that Bayesian robust analysis has higher power than traditional Bayesian model selection and non-Bayesian method.
Most of the main-effect and epistatic QTLs increase the PKV in rice, except for a third main-effect QTL and ninth pair of QTLs.
All three different cases of two QTLs that involve the epistatic effects are found: (1) both QTLs are the main, as fourth and eighth pairs of QTL  (2) both QTLs are not the main, as seventh pair of QTL and the rest are that only one QTL is the main.
Figures 1 and 2 (in Section 2 of supplementary data) plot the one-dimensional proﬁles of BFs for main effects and two-dimensional proﬁles of BFs for epistatic effects obtained from Bayesian robust mapping with a t-distribution for residuals, respectively.
They intuitively illustrate the results from Bayesian robust analysis for genetic architecture of quantitative traits.
5 DISCUSSION Within the framework of Bayesian model selection for mapping genome-wide interacting QTLs, we develop a Bayesian robust mapping strategy for analyzing continuous non-normal quantitative  Table 4.
Estimated QTL positions (LG-position) obtained from Bayesian robust mapping with different distribution for residual on PKV in rice  QTL no.
Distribution  1 2 3 4 5 6 7 8 9 10  t  Slash  Contaminated  Normal  1-438.7 7-327.6 16-164.5 (1-435.9) (16-162.8) (1-309.4) (12-11.5) (1-443.2) (6-23.8) (1-65.6) (1-253.2) (7-327.6) (16-164.5) (4-24.8) ( 16-160.8) (9-27.3) (16-168.7)    7-320.9   (1-440.8) 16-183.6) (1-302.1) (12-13.2) (1-447.5) (6-33.2)       (9-25.9) (16-175.1)    7-326.2   (1-439.2) (16-175.2)   (1-436.2) (6-32.6)     (4-28.3) ( 16-162.1)      7-322.7       (1-450.8) (6-30.7)       (9-28.4) (16-162.1)  Table 5.
Estimated QTL effects obtained from Bayesian robust mapping with different distribution for residual on PKV in rice  QTL no.
QTL type  Distribution  1 2 3 4 5 6 7 8 9 10  Main Effect Main Effect Main Effect Epistatic Epistatic Epistatic Epistatic Epistatic Epistatic Epistatic  The numbers in parentheses are the 2logBF values.
t  0.46(1.96) 10.05(5.65)  4.77(2.77) 13.46(9.03) 9.00(5.13) 7.07(4.29) 8.06(3.17) 2.73(3.45)  5.46(3.18) 3.04(2.55)  Slash    9.54(4.38)   13.98(7.56) 10.36(6.13) 7.45(5.82)       3.95(2.41)  Contaminated    9.82(5.13)   12.95(8.78)   7.56(5.13)      4.98(3.89)    Normal    9.61(2.46)       7.31(4.69)       2.59(4.02)  1037  [10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1037  1033 1039   R.Yang et al.
traits, by replacing the normal distribution for residuals in multiple QTL model with the normal/independent distributions.
Compared with Bayesian mapping for normal data, the Bayesian robust mapping strategy additionally sample  weight Wi and the robustness parameter df with the Gibbs sampler or Metropolis/Hastings algorithm in the MCMC process.
Although computations for the robust models may be more than for their normal counterparts, the ﬂexibility of the Bayesian robust mapping for either non-normal or normal data is enough to compensate for the cost.
Of course, if the robustness parameter is assumed to be known, e.g.
simply ﬁxed at a small value (Gelman et al., 1995), the implementation of the Bayesian robust mapping will be even easier.
In practice, however, unless there is a strong reason to believe in the adequacy of the normality assumption for residuals, it may be safer to use a robust model (Rosa et al., 2003, 2004).
Except for the three common normal/independent distributions discussed in this study, other distributions can also be considered, such as the Laplace and the double exponential distributions.
Which distribution is optimal for ﬁtting residuals depends on peculiarities of the dataset, such as the proportion of outliers and how far these are from the  center  of the distribution.
The t-distribution is the most commonly used thick-tailed distribution for robust inference, and is often a good alternative to a normal distribution.
The contaminated normal distribution is the most ﬂexible among the three robust distributions, but at the expense of an additional parameter.
The slash distribution, although not often encountered in the literature, is the easiest one to implement in hierarchical modeling, because all conditional posterior distributions have closed forms.
Rohr and Hoeschele (2000) ﬁrst implemented a robust Bayesian method for mapping QTL.
Their study was different from ours in that: (1) their mapping analysis aimed at outbred population whereas ours at linecross  (2) their proposed method was based on a single QTL model whereas ours was based on a multiple QTL model  and (3) they used skewed Student s t-distributions to describe phenotypic residuals in the analysis whereas we adopted a student s t-distribution.
In the single QTL model, it may be reasonable to assume that residuals follow skewed Student s t-distributions, because the  skewness  may absorb the effects of other QTLs on phenotypes.
However, no  skewness  is necessary for the multiple QTL model.
A complete Bayesian mapping requires the sampling of genotypes for QTL and missing markers and aggravates the computational cost of Bayesian robust analyses.
To alleviate this problem, we evenly partition the entire genome into small intervals by a number of points and restrict putative QTL to these ﬁxed points, as proposed by (Yi et al., 2005).
This strategy greatly reduces computational time by estimating all expected values of indicator variables for putative QTL by using conditional probability of their genotypes on two ﬂanking markers before the MCMC procedure starts.
Other ways to improve the efﬁciency of analyzing many QTL effects with Bayesian model selection include specifying prior inclusion probability for epistasis and using Metropolis/Hastings algorithm to perform fast sampling for binary indicator (Yi et al., 2007).
Funding: National Institutes of Health (R01 AR050496-01, R21 AG027110, R01 AG026564, and P50 AR055081, partial)  Dickson/Missouri Endowment (to H.W.D.)
the Chinese National Natural Science Foundation (Grant 30471236 to R.Y.)
Conﬂict of Interest: none declared.
1038  REFERENCES Andrews,D.F.
and Mallows,C.L.
(1974) Scale mixtures of normal distributions.
J. R.  Stat.
Soc.
Ser.
B, 36, 99 102.
Ball,R.D.
(2001) Bayesian methods for quantitative trait loci mapping based on model selection: approximate analysis using the Bayesian information criterion.
Genetics, 159, 1351 1364.
Coppieters,W.
et al.
(1998) A rank-based nonparametric method for mapping quantitative trait loci in outbred half-sib pedigrees: Application to milk production in a granddaughter design.
Genetics, 149, 1547 1555.
Dempster,A.P.
et al.
(1980) Iteratively reweighted least squares for linear regression (ed.)
In Krishnaiah,P.R.
when errors are normal/independent distributed.
Multivariate Analysis.
North-Holland, Amsterdam.
Diao,G.
et al.
(2004) Mapping quantitative trait loci with censored observations.
Genetics, 168, 1689 1698.
Elsen,J.M.
et al.
(1999) Alternative models for QTL detection in livestock.
I.
General  introduction.
Genet.
Sel.
Evol., 31, 213 224.
Feenstra,B.
and Skovgaard,I.M.
(2004) A quantitative trait locus mixture model that  avoids spurious LOD score peaks.
Genetics, 167, 959 965.
Fernandez,C.
and Steel,M.
(1998) On Bayesian modeling of fat tails and skewness.
J.
Am.
Statist.
Assoc., 93, 359 371.
Gelman,A.
et al.
(1995) Bayesian Data Analysis.
Chapman & Hall, New York.
Hackett,C.A.
(1997) Model diagnostics for ﬁtting QTL models to trait and marker data  by interval mapping.
Heredity, 79, 319 328.
Jansen,R.C.
(1992) A general mixture model for mapping quantitative trait loci by using  molecular markers.
Theor.
Appl.
Genet., 85, 252 260.
Kass,R.E.
and Raftery,A.E.
(1995) Bayes factors.
J.
Am.
Stat.
Assoc., 90, 773 795.
Kruglyak,L.
and Lander,E.S.
(1995) A nonparametric approach for mapping quantitative  trait loci.
Genetics, 139, 1421 1428.
Lander,E.S.
and Botstein,D.
(1989) Mapping Mendelian factors underlying quantitative  traits using RFLP linkage maps.
Genetics, 121, 185 199.
Lange,K.
and Sinsheimer,J.S.
(1993) Normal/independent distributions and their  applications in robust regression.
J.
Am.
Stat.
Assoc., 2, 175 198.
Lange,K.L.
et al.
(1989) Robust statistical modelling using the t-distribution.
J.
Am.
Stat.
Assoc., 84, 881 896.
Liu,C.
(1996) Bayesian robust multivariate linear regression with incomplete data.
J.
Am.
Stat.
Assoc., 435, 1219 1227.
Little,R.J.A.
(1988) Robust estimation of the mean and covariance matrix from data  with missing values.
Applied Statistical, 37, 23 39.
Pinheiro,J.C.
et al.
(2001) Efﬁcient algorithms for robust estimation in linear mixed- effects models using the multivariate t distribution.
J. Comput.
Graph.
Stat., 10, 249 276.
Plummer,M.N.
et al.
(2004) Output analysis and diagnostics for MCMC, v. 0.9 5.
Available at http://www-ﬁs.iarc.fr/coda/ (last accessed date March 2006).
Raftery,A.E.
et al.
(1997) Bayesian model averaging for linear regression models.
J.
Am.
Stat.
Assoc., 92, 179 191.
Rebaï,A.
(1997) Comparison of methods for regression interval mapping in QTL  analysis with non-normal traits.
Genet.
Res., 69, 69 74.
Ripley,B.
(1987) Stochastic Simulation.
Wiley, New York.
Rogers,W.H.
and Tukey,J.W.
(1972) Understanding some long-tailed distributions.
Stat.
Neerl., 26, 211 226.
Rohr,P.V.
and Hoeschele,I.
(2002) Bayesian QTL mapping using skewed Student-t  distributions.
Genet.
Sel.
Evol., 34, 1 21.
Rosa,G.J.M.
et al.
(2003) Robust linear mixed models with Normal/Independent  distributions and Bayesian MCMC implementation.
Biom.
J., 5, 573 590.
Rosa,G.J.M.
et al.
(2004) Bayesian longitudinal data analysis with mixed models and  thick-tailed distributions using MCMC.
J. Appl.
Stat., 7, 855 873.
Sillanpää,M.J.
and Corander,J.
(2002) Model choice in gene mapping: what and why.
Trends Genet.
18, 301 307.
Sokal,R.R.
and Rohlf,F.J.
(1995) Biometry: The Principles and Practice of Statistics in  Biological Research.
W.H.
Freeman and Company, New York.
Symons,R.C.
et al.
(2002) Multiple genetic loci modify susceptibility to plasmacytoma- related morbidity in Eµ-v-abl transgenic mice.
Proc.
Natl Acad.
Sci.
USA, 99, 11299 11304.
Wang,H.
et al.
(2005) Bayesian shrinkage estimation of quantitative trait  loci  parameters.
Genetics, 170, 465 480.
Yang,R.
et al.
(2006) Box Cox transformation for QTL mapping.
Genetica, 128,  133 143.
Yi,N.
et al.
(2005) Bayesian model selection for genome-wide epistatic quantitative  trait loci analysis.
Genetics, 170, 1333 1344.
Yi,N.
et al.
(2007) Bayesian mapping of genomewide interacting quantitative trait loci  for ordinal traits.
Genetics, 176, 1855 1864.
[10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1038  1033 1039   Bayesian robust mapping analysis  Zhang,Y.M.
and Xu,S.
(2005) Advanced statistical methods for detecting multiple  quantitative trait loci.
Recent Res.
Devel.
Genet.
Breed., 2, 1 23.
Zou,F.
et al.
(2003) Rank-based statistical methodologies for quantitative trait locus  mapping.
Genetics, 165, 1599 1605.  freedom df  for degree of  APPENDIX A in normal/ Speciﬁcation of prior independent distributions  1, yielding In the t-distribution, we adopt a ﬂat prior for df as df  2 (Liu, 1996)  A Gamma(a, b) distribution with small p(df )  df positive values of a and b (b(cid:6) a)can be adopted as a prior for df in the slash distribution  and the prior for df of contaminated normal distribution involves two parameters, i.e.
df =(v τ ).
Herein, a Uniform (0, 1) distribution is used as a prior for τ and an independent Beta (a, b) is adopted as prior a for v.  APPENDIX B Forms of posteriors normal/independent distributions  for w and degree of  freedom df  in  For a t-distribution, the fully conditional posterior density for each and  (cid:18) element of w is a Gamma distribution with parameters 1+df  2  (cid:10) 1  2  (yi µ  q(cid:7) j=1 (cid:5)(cid:19) n (cid:3) posterior density of df is  n(cid:7) df + 1 i=1 (cid:6) (cid:15)  (cid:8)  df 2    σ 2  p  df  2  df 2  xijbj)2  , corresponding conditional  ndf 2  df   2exp  (cid:18)  (cid:8)  n(cid:1) i=1    df 2  wi lnwi  (cid:15)(cid:10)  n 2  (cid:8)  (cid:8)  (cid:15)(cid:16)  (cid:15)T(cid:8)  which does not have an explicit form but a Metropolis/Hastings or rejection sampling step (Ripley, 1987) can be embedded in the MCMC scheme to obtain draws for df.
For slash distribution, (cid:15) a+n, b (cid:7) +df , 1 wi Truncated Gamma df  Gamma (cid:16) For contaminated normal distribution, (cid:15) (cid:8) posterior density for wi 1 wi (1 v) 1 τ wn/2 m(cid:7) v i a+ 1 v Beta 1 τ i=1  (cid:14) i=1lnwi n (cid:20) the fully conditional is also non-closed form: p(wi)  wi τ   wi 1 τ with 2σ 2 (1 wi), b+ 1 1 τ  (cid:15)T(cid:8) (cid:10) yi Gi (wi τ )  yi Gi (cid:15)(cid:21)  yi Gi m(cid:7) i=1  yi Gi   exp  with  (cid:18)  2σ 2 e  (cid:8)  (cid:14)  .
.
[10:16 3/4/2009 Bioinformatics-btn558.tex]  Page: 1039  1033 1039  1039
