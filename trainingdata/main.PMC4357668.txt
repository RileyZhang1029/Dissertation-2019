Genomics Proteomics Bioinformatics 11 (2013) 72 75  Genomics Proteomics Bioinformatics  www.elsevier.com/locate/gpb  www.sciencedirect.com  APPLICATION NOTE  MeRIP-PF: An Easy-to-use Pipeline for High-resolution Peak-ﬁnding in MeRIP-Seq Data  Yuli Li 1,3,#, Shuhui Song 2,#, Cuiping Li 2, Jun Yu 1,*  1 CAS Key Laboratory of Genome Sciences and Information, Beijing Institute of Genomics, Chinese Academy of Sciences,  Beijing 100101, China  2 Core Genomic Facility, Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing 100101, China 3 University of Chinese Academy of Sciences, Beijing 100049, China  Received 21 December 2012  revised 9 January 2013  accepted 11 January 2013 Available online 20 January 2013  KEYWORDS  RNA modiﬁcation  m6A  Peak ﬁnding  MeRIP-Seq  Abstract RNA modiﬁcations, especially methylation of the N6 position of adenosine (A)  m6A, rep- resent an emerging research frontier in RNA biology.
With the rapid development of high-throughput sequencing technology, in-depth study of m6A distribution and function relevance becomes feasible.
However, a robust method to effectively identify m6A-modiﬁed regions has not been available yet.
Here, we present a novel high-efﬁciency and user-friendly analysis pipeline called MeRIP-PF for the signal identiﬁcation of MeRIP-Seq data in reference to controls.
MeRIP-PF provides a statistical P-value for each identiﬁed m6A region based on the difference of read distribution when compared to the con- trols and also calculates false discovery rate (FDR) as a cut off to differentiate reliable m6A regions from the background.
Furthermore, MeRIP-PF also achieves gene annotation of m6A signals or peaks and produce outputs in both XLS and graphical format, which are useful for further study.
MeRIP-PF is implemented in Perl and is freely available at http://software.big.ac.cn/MeRIP-PF.html.
Introduction  Multiple layers of epigenetic regulation including modiﬁcation of DNA, RNA and proteins have been intensively explored.
One of the major RNA modiﬁcations, m6A  methylation of the N6 position of adenosine (A)  represents an emerging re- search frontier in RNA biology and medicine [1].
Post transcrip-  # Equal contribution.
* Corresponding author.
E-mail: junyu@big.ac.cn (Yu J).
Peer review under responsibility of Beijing Institute of Genomics, Chinese Academy of Sciences and Genetics Society of China.
Production and hosting by Elsevier  tionally added, m6A is an enzymatic modiﬁcation of RNAs and the most common form found in the internal sequences of mRNAs in eukaryotes, as well as RNAs in nuclear-replicating viruses [2].
Unlike A-to-I RNA editing, m6A is nonstoichiomet- ric and does not alter the coding capacity of transcripts [3,4] and may play roles in regulating RNA expression [1].
Along with the development of analytical and detection meth- ods, such as MeRIP-Seq or m6A-seq [4,5], researchers are now able to carry out in-depth studies on m6A distribution and function of related genes.
Next-generation sequencing (NGS) technologies render the identiﬁcation of m6A-speciﬁc methylation of mRNAs possible through target enrichment, including immunoprecipita- tion [4,5].
As this strategy becomes popular, challenges are yet to be met for efﬁcient data analysis, especially in peak ﬁnding.
Due to fundamental technical differences of experimental protocols and the nature of the raw data, the existing peak-ﬁnding software packages, such as MACS [6] for ChIP-Seq and PARalyzer [7] for  1672-0229/$ - see front matter ª 2013 Beijing Institute of Genomics, Chinese Academy of Sciences and Genetics Society of China.
Published by Elsevier Ltd and Science Press.
All rights reserved.
http://dx.doi.org/10.1016/j.gpb.2013.01.002   Li Y et al / MeRIP-PF: Peak-ﬁnding in MeRIP-Seq Data  73  PAR-CLIP, are not suitable for MeRIP-Seq peak-ﬁnding.
More importantly, there have not been tools or algorithms publically available for MeRIP-Seq data analysis yet.
Here, we present a highly-efﬁcient and easy-to-use analysis pipeline, named MeRIP-PF (MeRIP-Seq data peak ﬁnding), which is a publicly-available tool and specially developed for the peak-calling of MeRIP-Seq data.
MeRIP-PF has a powerful graphical display and can be readily used for the identiﬁcation of m6A-modiﬁed regions and gene annotation.
Method  Formulation  If an mRNA contains m6A modiﬁcation sites, the RNA frag- ment containing the sites can be pulled down by the anti-m6A  antibody and sequenced subsequently.
The m6A modiﬁed re- gions can be identiﬁed by mapping the sequencing reads to the reference sequence of a genome through comparison of read counts between the sample and the control (Figure 1A).
Input data  The pipeline requires two Fastq-formatted data.
One is sequencing reads from m6A-containing RNA immunoprecipi- tated (MeRIP) sample, and the other is the corresponding reads from non-IP transcriptome, which serves as the back- ground control.
Additionally, users also need to prepare the genome reference sequence of the species and several anno- tated BED ﬁles with gene structure information, which we rec- ommend downloading from the UCSC database (http:// genome.ucsc.edu/cgi-bin/hgTables) directly.
Figure 1 MeRIP-Seq, MeRIP-PF and result processing A. Schematic of MeRIP-Seq and MeRIP-PF pipelines (red dots indicate m6A sites).
B.
Distribution of m6A peaks in different regions of transcripts.
Pie chart showing the percentage of m6A peaks within distinct regions of RNA.
NP, non-protein-coding genes  PR, protein- coding genes.
C. Distribution of m6A peaks along mRNAs.
50 UTRs, CDSs and 30 UTRs of every transcript are separately binned into regions spanning 1% of their total lengths.
Y-coordinates represent percentage of m6A peaks located in every bin.
D. An example of transcripts in wig plot.
Y-coordinates show the read coverage of every position in transcripts.
NM_009484 was taken as an example.
Different regions of transcripts are color coded with UTR indicated in blue and CDS in pink, and intronic regions are indicated with blank space.
Red triangle indicates the position of m6A peaks.
74  Processing  Genomics Proteomics Bioinformatics 11 (2013) 72 75  Figure 1A shows the process of MeRIP-Seq and the method for detecting m6A peaks (see detailed steps in Figure S1).
We integrated four modules, including mapping, testing, annotat- ing and plotting, into one command program to complete the analysis.
The ﬁrst module, i.e., sequence mapping, speciﬁcally yields two datasets in SAM-format, one from the MeRIP sam- ple and the other from the control, by using the BWA software [8].
The uniquely-mapped reads (MAPQ P 20) are converted into BED ﬁles using SAMtools [9] and BEDTools [10].
The second module identiﬁes m6A-modiﬁed regions in high resolu- tion in reference to read coverage.
The m6A signal peaks are deﬁned based on comparison of read counts between the MeR- IP data and the control data with a ﬁxed 25-bp window across the genome.
Based on one-tailed Fisher s exact test and Benja- mini Hochberg method [11], both P-value and adjusted P-va- lue (FDR) for each 25-bp window are calculated continuously to deﬁne signiﬁcant sequence windows (FDR 6 0.05).
The sig- niﬁcant and adjacent (no gaps present) windows are concate- nated, while only those with appropriate sizes are considered as reliable and real peaks.
The third module is used to annotate each peak in terms of peaks and genes (see Tables S1 and S2 where we just presented partial results derived from the pub- lished data [5]), and an enrichment score for each peak is also calculated.
The fourth module is used to analyze m6A peak dis- tribution at transcriptomic level and display read distribution along transcripts graphically.
The peak counts are based on non-protein-coding and protein-coding genes, which are fur- ther divided into coding sequences (CDSs), introns, and untranslated regions (UTRs).
Output  MeRIP-PF generates 4 output ﬁles that contain the complete information of m6A modiﬁcation proﬁle.
Reads_Over- view.txt   ﬁle supplies the basic status of the two sequencing datasets    Peak_All.xls   ﬁle provides the absolute positions of m6A peaks in genome and mRNA regions    Gene_List.xls   ﬁle presents the annotating information of m6A peaks at the gene level  and   Plot_Fig.pdf   ﬁle shows read distribution in the control and peak distribution in the MeRIP sample (Figure 1B), the distribution of m6A peaks along mRNAs (Figure 1C), and wig plots for transcripts with m6A peaks (Figure 1D).
Implementation  The pipeline program is written in Perl and runs in a Linux machine cluster with each node consisting of 8 cores with  2.00 GHz processor and 16G RAM.
MeRIP-PF requires the installation of Perl and R language program, BWA, SAMtools and BEDTools.
MeRIP-PF, along with an implementation ﬁle of the described method and Demo Datasets can be down- loaded from the project website http://software.big.ac.cn/ MeRIP-PF.html.
The package requires the programming envi- ronment R. The R software is available at the website   The R Project for Statistical Computing   (http://www.r-project.org/).
Results and discussion  We tested MeRIP-PF performance using published adult mouse brains data (GSM854223 and GSM854224) with more than 30 millions reads for each sample [5].
By MeRIP-PF, we caught all high-conﬁdence peaks in the previous study [5], which we named as   HC peaks  , but there are some differ- ences between these two reports, which were shown in Table 1.
We classiﬁed all peaks into four groups according to the frac- tion of peak region overlapping.
In group A, 9555 peaks were   identical   between MeRIP-PF and   HC peaks  , which showed more than 75% overlap for each peak region.
In group B, 3719 peaks were   similar  , which had 50 75% overlap for each peak region.
In group C, 1772 peaks of MeRIP-PF had 0 50% overlap with 147 peaks in   HC peaks  , and we deﬁned this group as   different  .
In group D, there were 5153 peaks that had no overlap with   HC peaks   and we deﬁned this group as   new  .
We detected all the high-conﬁdence peaks in the previous report [5], but there remained some differences in some peak regions in group A, B and C. Since the two methods were sim- ilar, the peak region differences might be due to the following two reasons: (1) although we both used default parameters of BWA software for reads mapping, use of different versions may contribute to difference of mapping results (we used bwa-0.6.2)  (2) although uniquely-mapped reads were taken for further peaks calling in both reports, we regarded reads with MAPQ (mapping quality) P 20 as uniquely-mapped, while their criterion of ﬁltering was not very clear.
The differ- ences of total uniquely-mapped read count and read number falling in each 25-bp window resulted in shift of peak regions.
About those   new   peaks in group D, besides the aforemen- tioned explanations, more importantly, they used multiple rep- licates samples to improve the conﬁdence of m6A peaks [5].
We only used one replicate for analysis, so the   new   peaks are probably the low-conﬁdence peaks.
The distribution of time spent on processing GSM854223 and GSM854224 datasets is presented in Table 2.
Apparently, the total time required de- pends much on mapping procedure which is closely related to sequencing quantity.
Table 1 Peak-ﬁnding performance of MeRIP-PF  Methods  No.
of peaks  Group A  Group B  Group C  Group D  Identical peaks (overlap P 75%)  Ref.
[5] MeRIP-PF  13,471 20,199  9555 9555  Similar peaks (50% 6 overlap   75%) 3719 3719  Diﬀerent peaks (overlap   50%)  197 1772  New peaks (overlap = 0%) n 5153  Note: The   overlap   we mean is reciprocal for peak M and peak N. In other words, if   overlap   is more than 75%, it requires that peak N overlaps at least 75% of peak M and that peak M also overlaps at least 75% of peak N.   Li Y et al / MeRIP-PF: Peak-ﬁnding in MeRIP-Seq Data  75  Table 2 Time spent on processing GSM854223/GSM854224 datasets  Supplementary material  Process  Mapping Statistical test Annotation Plotting  Conclusion  Timing (min)  200  15  10  10  As the ﬁrst speciﬁc and easy-to-use pipeline for MeRIP-Seq data, MeRIP-PF provides outputs in both XLS and graphical format, which are important for deep analysis of m6A modiﬁ- cation.
We integrated four modules, including mapping, test- ing, annotating and plotting, into one command program to complete the analysis.
The pipeline applies to MeRIP-Seq data with corresponding control samples.
Authors  contributions  YL drafted the manuscript and developed the software.
CL par- ticipated in the software design.
SS proposed the idea of the soft- ware and revised the manuscript.
JY revised the manuscript.
All authors have read and approved the ﬁnal manuscript.
Competing interests  The authors have no competing interests to declare.
Acknowledgements  We would like to thank all the members of Genome and Bio- informatics platform in Beijing Institute of Genomics for their assistance during the pipeline development.
This work was supported by Grants from the Ministry of Science and Tech- nology of China (Grant No.
2011CB944100) to JY, the Natu- ral Science Foundation (Grant No.
30900831 and 31271372) and Beijing Nova Program (Grant No.
Z121105002512060) to SS.
Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.gpb.2013.
01.002.
References  [1] He C. Grand challenge commentary: RNA epigenetics  Nat Chem  Biol 2010 6:863 5.
[2] Bokar JA.
In: Grosjean H, editor.
Fine-tuning of RNA functions  by modiﬁcation and editing, vol.
12.
Springer  2005. p. 141 77.
[3] Dai Q, Fong R, Saikia M, Stephenson D, Yu YT, Pan T, et al.
Identiﬁcation of recognition residues for ligation-based detection and quantitation of pseudouridine and N6-methyladenosine.
Nucleic Acids Res 2007 35:6322 9.
[4] Dominissini D, Moshitch-Moshkovitz S, Schwartz S, Salmon- Divon M, Ungar L, Osenberg S, et al.
Topology of the human and mouse m6A RNA methylomes revealed by m6A-seq.
Nature 2012 485:201 6.
[5] Meyer KD, Saletore Y, Zumbo P, Elemento O, Mason CE, Jaffrey SR. Comprehensive analysis of mRNA methylation reveals enrichment in 30 UTRs and near stop codons.
Cell 2012 149:1635 46.
[6] Zhang Y, Liu T, Meyer CA, Eeckhoute J, Johnson DS, Bernstein BE, et al.
Model-based analysis of ChIP-Seq (MACS).
Genome Biol 2008 9:R137.
[7] Corcoran DL, Georgiev S, Mukherjee N, Gottwein E, Skalsky RL, Keene JD, et al.
PARalyzer: deﬁnition of RNA binding sites from PAR-CLIP short-read sequence data.
Genome Biol 2011 12:R79.
[8] Li H, Durbin R. Fast and accurate short read alignment with  Burrows Wheeler transform.
Bioinformatics 2009 25:1754 60.
[9] Li H, Handsaker B, Wysoker A, Fennell T, Ruan J, Homer N, et al.
The sequence alignment/map format and SAMtools.
Bioinformatics 2009 25:2078 9.
[10] Quinlan AR, Hall IM.
BEDTools: a ﬂexible suite of utilities for  comparing genomic features.
Bioinformatics 2010 26:841 2.
[11] Benjamini Y, Hochberg Y.
Controlling the false discovery rate: a practical and powerful approach to multiple testing.
J R Stat Soc B 1995 57:289 300.
