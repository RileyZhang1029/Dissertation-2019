BIOINFORMATICS  Vol.
26 ECCB 2010, pages i589 i595 doi:10.1093/bioinformatics/btq389  Bayesian experts in exploring reaction kinetics of transcription circuits Ryo Yoshida , Masaya M. Saito, Hiromichi Nagao and Tomoyuki Higuchi  The Institute of Statistical Mathematics, Research Organization of Information and Systems, 10-3 Midori-cho, Tachikawa, Tokyo, 190-8562, Japan  ABSTRACT Motivation Biochemical reactions in cells are made of several types of biological circuits.
In current systems biology, making differential equation (DE) models simulatable in silico has been an appealing, general approach to uncover a complex world of biochemical reaction dynamics.
Despite of a need for simulation- aided studies, our research ﬁeld has yet provided no clear answers: how to specify kinetic values in models that are difﬁcult to measure from experimental/theoretical analyses on biochemical kinetics.
Results: We present a novel non-parametric Bayesian approach to this problem.
The key idea lies in the development of a Dirichlet process (DP) prior distribution, called Bayesian experts, which reﬂects substantive knowledge on reaction mechanisms inherent in given models and experimentally observable kinetic evidences to the subsequent parameter search.
The DP prior identiﬁes signiﬁcant local regions of unknown parameter space before proceeding to the posterior analyses.
This article reports that a Bayesian expert-inducing stochastic search can effectively explore unknown parameters of in silico transcription circuits such that solutions of DEs reproduce transcriptomic time course proﬁles.
Availability: A sample source code is available at http://daweb.ism.ac.jp/ yoshidar/lisdas/ Contact: yoshidar@ism.ac.jp  the URL  1 INTRODUCTION Cells can sense many different environmental signals, and respond to extraneous stimuli by switching activation/inactivation of speciﬁc molecules, such as transcription factors, via several types of biological circuits.
Kinetic biochemical modelling of such reaction circuits (often called biochemical reaction networks) using DEs realizes experiments in silico to enhance our understanding of the complex dynamic systems (Alon, 2006  Chen et al., 2004  Wilkinson, 2006).
It enables us to test a plausibility of current knowledge and hypothetical models on biological circuits and to create new further models when inconsistencies arise in simulation, domain knowledge and experimentally observed quantitative data (Yoshida et al., 2008).
Despite of a growing need for simulation-aided studies on bio-pathways, some fundamental issues prevent us from drawing their full potentials.
One critical issue addressed here is related to uncertainty in speciﬁed kinetic parameters of models: in many cases, we have no clear answer on how to specify kinetic values and initial conditions on simulations because biochemical reaction kinetics differ depending on a cell-by-cell     To whom correspondence should be addressed.
basis and intra-/extracellular environments such as temperatures, presence/absence of biochemical components in speciﬁc tissues.
With the aim to explore kinetic parameters in in silico biological circuits that make solutions of DEs ﬁt experimental data, a range of advanced technologies have appeared in the last several years of computational systems biology, involving genetic algorithm (GA  Kikuchi et al., 2003  Kimura et al., 2004  Koh et al., 2006), sequential Monte Carlo (SMC  Nagasaki et al., 2006  Nakamura et al., 2009), MCMC-driven parameter search methods (Finkenstädt et al., 2008) and also gradient descent algorithms (Cao et al., 2008  Fujarewicz et al., 2007  Yoshida et al., 2008).
Quantitative data, such as transcriptomic proﬁles and protein expression values, are usually measured over times.
In general, a Bayesian statistical method involves all the preceding methods as a uniﬁed framework: any estimation tasks are treated as evaluations of posterior distributions in which prior distributions embodying our prior belief on reaction kinetics are adapted to experimental data using likelihood functions.
As demonstrated later, however, the practical relevance of the existing approaches remains far below what practical analyses require.
Our view on this is that such a low performance depends highly on the lack of effective biochemical kinetic priors.
This article presents a previously unexplored class of prior distributions, called Bayesian experts on biochemical reaction kinetics.
The key notion of our approach can be found in the construction of Dirichlet process (DP) prior distribution (Blei et al., 2005  Escobar et al., 1995  MacEachern et al., 1998) whose base measure G0(θ) is modelled by a mixture of m Gibbs distributions:  G0(θ)= m(cid:1)  i=1  (cid:2)  (cid:3)  αi Zi  exp    φi(θ) T  (1)  with mixing rates αi (i=1, ..., m), temperature T  0 and partition functions Zi.
The m potential functions φi(θ) deﬁned on unknown parameters θ reﬂect substantive knowledge on reaction kinetics for a given model such that regions of interest in the parameter space are prescribed prior to a posterior analysis.
In many applications, we are able to collect several kinetic evidences on such local regions by observing temporal patterns of experimental data.
For instance, rates of increasing and/or decreasing to which DE solutions have to match can be guessed in advance by observing steepness of relevant local patterns of given time course data.
Alternatively, maximum and minimum levels of gene expression data provide a helpful clue to determinations of steady-state levels to which a transcription circuit model reaches in equilibrium.
The Gibbsian mixture distribution, enabling Bayesian expert system in kinetic explorations, aggregates such m constraint conditions on the kinetic parameters that are induced automatically in light of experimental data and reaction speeds inherent in given models.
The Author(s) 2010.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i589 i589 i595   R.Yoshida et al.
This article describes our Bayesian experts, focusing on key examples of speciﬁc types of in silico transcription circuits.
Transcription factor activities are modelled on Hill functions and mass action kinetics (Alon, 2006  Wilkinson, 2006) as described in Section 2.
To emphasize the ability of the Bayesian expert prior, we explore unknown parameters using a simpliﬁed stochastic search algorithm without using more advanced computational techniques.
The DP prior with additional technical details is introduced in Section 3.
Experimental results appear in Section 4, demonstrating drastic efﬁciency gains from uses of the Bayesian experts and a benchmark on computational times.
Section 5 concludes with more generalization of our approach.
Supplementary Material and a sample program called LiSDAS (Life Science Data Assimilation Systems) are accessible at the Supplementary web site.
LiSDAS features some basic functions to explore kinetic parameter values for given data and a model.
The user can develop biological circuit models with the LiSDAS model construction ﬁle in place.
2 MODEL AND INVERSION ANALYSIS 2.1 Transcription regulatory circuits The proposed Bayesian method will be derived and described, in later sections, with examples on analyses of transcriptional reaction kinetics.
Before that, we brieﬂy summarize speciﬁc forms of the DEs making up elements of the transcription circuit models.
2.1.1 Transcription Control of transcription factor-inducing gene expressions is a key regulatory mechanism in cells.
Transcription factors can sense external stimuli of cells by mediations of signal transduction pathways.
A transcription factor activated by the transmitted signals acts as either activator or repressor in transcription processes of speciﬁc target genes with many recruited enzymatic activities at the promoter regions.
One commonly used DE for describing the transcriptional process is Hill function which is in theory derived by considering an equilibrium binding of a transcription factor to its target site on the promoter (see Appendix of Alon, 2006).
The time evolution of mRNA concentration [X] is modelled as  = ψrd[X]+ψtc  ha([Pi] Ki,σi)  hr([Pi] Ki,σi)  d[X] dt  (cid:4) i R  (cid:4) i A  where the mRNA decay rate and the maximal rate of transcription are denoted by ψrd and ψtc.
In addition to this, some studies commonly include a baseline ψb (e.g.
Cantone et al., 2009).
The Hill functions involving the transcriptional activators A and repressors R are  ha([Pi] Ki,σi) = hr([Pi] Ki,σi) =  1  1+(Ki/[Pi])σi 1+([Pi]/Ki)σi  1    I([Pi]   Ki),   I([Pi]   Ki).
(2)  (3)  The unknown kinetic parameters σi and Ki control, respectively, location and steepness of each Hill function.
As σi gets larger, the Hill function becomes steeper and looks more like the indicator function I( ), taking the value one if argument is true, otherwise zero.
The multiple set of the Hill functions totally deﬁnes the AND gate that describes an abrupt increasing/decreasing of mRNA transcript level in response to excess concentrations of the regulatory proteins in A and R.  i590  2.1.2 Mass action law Multimeric molecules can make up a transcription factor complex in any of transcription regulatory circuits.
In modelling, we need to build a DE describing molecular binding reactions, such as protein protein binding or one or more proteins interacting with small molecules.
Instantaneous rate of a binding reaction is described here by mass action kinetics  d[C] dt  = ψcd[C]+ψcb  [Pi]τi .
(4)  d(cid:4) i=1  In the formation of a complex C, the binding efﬁciency among d molecules, Pi (i=1, ..., d), is determined on the afﬁnity proportional to the active masses with the binding rate constant ψcb and powers τi.
2.1.3 Translation An mRNA transcribed at level [X] proceeds to its translation process.
The model that we employ describes a production of protein P simply as  d[P] dt  = ψpd[P]+ψtl[X] ψcb  [Pi]τi .
(5)  d(cid:4) i=1  Instantaneous rate of translation is represented by the linear functions in the ﬁrst two terms with the rates of degradation ψpd and translation ψtl, respectively.
The last term involving (4) appears in (5) when the protein P binds to the other d 1 molecules  Pi Pi(cid:5)= P,i=1, ..., d  in system.
Note that we omit dissociation processes of the protein protein complex C, relying on the assumption that molecular stability of C is much higher and reaction kinetics involved in the dissociation is negligible in the entire system.
2.2 State space model is modelled as a set of DEs dxi(t)/dt= A biological circuit fi(pai(x),ψ) deﬁning rates of change in evolving concentrations of the p biological entities, x(t)=(xi(t))1 i p, over continuous times t  T .
In the above context, each endogenous variable involved in a bio-pathway makes up a state variable xi(t).
The i-th state variable is regulated by the parent variables pai(x) a subset of the state variables appearing in the right-hand side of each DE with the rate equation fi deﬁned by the kinetic parameters ψ. Conduction of quantitative experiments along times enables us to measure changes of the unknown state variables, x(t), directly or indirectly via observed data y(t)=(yi(t))1 i p  R p+ at discrete time points t  N   T .
Here, to cope with partially observed systems where data of the state variables are in part missing, it is helpful to deﬁne a set of observable variables, i  S   1, ..., p .
For instance, in transcriptomic experiments using DNA microarrays, it is the case that amounts of protein expression levels are unobservable.
To proceed with an inversion analysis, the DEs are related to the  experimental data using a state space model:  yi(t)= xi(t)+wi(t) for t  N and i  S dxi(t)  = fi(pai(x),ψ)  dt  (6)  (7)  where wi(t) denotes measurement error independently and identically distributed.
The processes Y = yi(t) t  N ,i  S  and X = x(t) t  T   follow (6) and (7) with initial state variables x(0) having a certain prior distribution x(0)  p(x(0)).
Bayesian inversion  [11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i590 i589 i595   Bayesian experts in exploring reaction kinetics of transcription circuits  analysis explores all the unknown parameters in the model  initial states x(0) and kinetic parameters ψ based on the posterior distribution P(x(0),ψ Y ,Pa) under which a circuit structure Pa= pai(x) 1 i p a collection of parent variable sets  is speciﬁed and a priori knowledge on reaction kinetics is expressed via a prior distribution P(ψ).
Rather than P(x(0),ψ Y ,Pa), in many cases, it is of more interest to evaluate the augmented posterior distribution P(x(0),ψ,Pa Y) where a circuit structure is unknown or unreliable.
In what follows, we focus on the estimation of ψ with a given circuit structure.
LiSDAS, however, has a pre-mature function for structural search of reaction circuits.
In usual, an analytical  2.3 Learning reaction kinetics and relevant methods All the unknown parameters relevant to an analysis are expressed by θ, i.e.
θ= ψ,x(0)  or augmented parameters involving circuit the posterior structures Pa. distribution P(θ Y)  P(Y θ)P(θ) is unavailable due to non-linearity of DEs, thereby driving a need for efﬁcient posterior approximation techniques in solving the inversion problems search for posterior means or modes.
The recent systems biology has explored parallel developments of SMC, MCMC-driven posterior explorations and gradient descent methods.
However, with a view to scaling to larger numbers of unknown parameters, efﬁcient and effective computation remains a challenge.
form of  Our study started from Nagasaki et al.
(2006) that applied a simplest SMC to the stochastic search for transcriptional reaction kinetics.
The use of SMC algorithm had been suggested also by Quach et al.
(2007) whereas they actually applied the unscented Kalman ﬁlter as a variant of conventional SMC.
A key notion of the SMC and MCMC-driven search a more efﬁcient counterpart of SMC is that the posterior distribution is approximately evaluated on a ﬁnite number of Monte Carlo samples called particles such that the empirical distributions are ensured to reach the true posterior distribution as the number of particles approaches to inﬁnity.
Whenever following such an approach, however, a quite huge number of particles are needed to draw as raising the number of unknown parameters.
Nagasaki et al.
(2006) and Yoshida et al.
(2008) reported that the practical relevance of the SMC was limited by estimations of only a few parameters.
Some early studies focused on GA (Kikuchi et al., 2003  Kimura et al., 2004  Koh et al., 2006) that explores values of parameters by alternating crossover and mutation of initially generated seeds for the parameters.
With no loss of generality, any optimization problems for which GA aims to solve can be converted to posterior mode searches in Bayesian context.
The key for success in GA is whether or not an initial set of candidate parameters lies in the region close to the posterior mode.
According to Higuchi (1997), the intrinsic nature of GA is essentially the same to the SMC.
Hence, the low practical relevance of the SMC (Nagasaki et al., 2006  Yoshida et al., 2008) can be a rule of thumb for a performance of GA.
The substantial merit of Bayesian kinetic inference is in the use of prior distributions, P(θ), for conducting effective regularization in the inversion analysis.
To the best of our knowledge, however, no one has addressed this fundamental issue while the range of cutting- edge computational technologies have appeared over the last several years.
The Bayesian expert system that we present is the ﬁrst attempt  to make a class of prior distributions aiming to enhance the power of previously explored class of kinetic search methods.
3 BAYESIAN EXPERTS ON KINETIC LEARNING 3.1 Dirichlet process A prior distribution P(θ) on the unknown parameters is modelled by a DP written as  G DP(G γ,G0) and θ G  G  The distribution G that θ follows is treated as an inﬁnite dimensional  random variable distributed according to the DP DP(G γ,G0).
The DP is deﬁned by the two parameter: base measure G0 and concentration parameter γ  0.
The G0 is a distribution function  deﬁned on the support same as G. The smaller γ is, the more G looks like the G0, and vice verse as larger γ.
A key notion of DP is in a discrete representation of probability measure  G is decomposable via the sum of the Dirac measures δθi ( ) at the inﬁnite as the inﬁnite mixture G(θ)=(cid:5)  set of atoms θi  G0 (i=1, ..., ).
The explicit form is hence given πiδθi (θ) with the mixing rates, πi=1.
The inﬁnite sequence of θi can be made πi 0 and by successively conducting stick breaking construction or Chinese restaurant process (Blei et al., 2005  Escobar et al., 1995).
(cid:5)  i=1  i=1  3.2 Base measure construction by a mixture of experts Of the base measure with the Gibbsian mixture (1), the m potential functions represent a set of implicit functions φi(θ) 0 (i=1, ..., m) that speciﬁes regions of interest in the kinetic parameters.
We here describe a simple idea on how to make such potentials with an example of the transcription regulatory models in Section 2.1.
In many 3.2.1 Experts on maximal/minimal production rates applications, maximal or minimal level of each observable variable can be a helpful kinetic evidence to prescribe steady-state conditions on which each variable should reach in simulation.
We illustrate some examples on how to make such prior distributions.
The transcriptional process shown in Section 2.1 with each Hill curve varying sigmoidally between 0 and 1 deﬁnes the maximal production rate as  d[X] dt  = ψrd[X]+ψtc+ψb  where the AND gate opens.
The equilibrium condition d[X]/dt=0 induces the steady-state level of [X] the maximal level of the ODE solution as the ratio of the production and dilution rates [X]max= (ψtc+ψb)/ψrd.
If time course proﬁles are available on the mRNA,  we are able to evaluate, in some ways, the maximal expression level of each mRNA, ymax.
Then, all possible conﬁgurations of  ψtc,ψrd ,ψb  such that ymax(cid:12)(ψtc+ψb)/ψrd can be eliminated in advance by making an arbitral potential function.
For instance, we will use, in later, φmax=(λymax (ψtc+ψb)/ψrd)2 with a given discount factor λ [1, ).
Solutions with the parameters satisfying φmax 0 yield trajectories saturated around at ymax when λ=1.
The speciﬁed λ=1 is to express the prior belief that the observed maximal level results in an equilibrium state to which the underlying dynamic system reaches.
The restriction can be weaken/strengthen by the control of the temperature parameter T. By analogy, the minimal expression level ymin can also be associated  [11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i591 i589 i595  i591   R.Yoshida et al.
Fig.
1.
Schematic expression on making Bayesian experts for (i) (ii) maximal/minimal production levels, and (iii) local reaction speeds.
with the minimal production rate on the model with the closed  AND gate,  ψrd[X]+ψb=0, which derives a potential function φmin =(λymin ψb/ψrd)2.
Relevant to the mass action kinetics (4) and the translation process (5) that involve protein-level reactions, we can often specify the maximal/minimal expression level of protein in data-driven ways or empirical bases.
Conventional DNA microarray experiments measure transcript levels of mRNA molecules in arbitrary units, and hence any kinetic parameters in a ﬁtted model result in unit free as well as quantities of regulatory proteins.
A natural way to cope with such cases is to put an arbitrary chosen maximal/minimal value to the solutions for (4) and (5).
The DE (5) attains the maximal speed of translation when the maximal level of mRNA,  [X]max=(ψtc+ψb)/ψrd, is speciﬁed:  d[P] dt  = ψpd[P]+ψtl[X]max ψcb[P]  [Pi]τi  min  .
(cid:4) Pi(cid:5)=P  (cid:6) Pi(cid:5)=P  where the minimal protein concentrations [Pi]min are speciﬁed arbitrary in the rest of d 1 reactants.
Given this, a maximal level pmax is then related to the equilibrium state ψtl[X]max/(ψpd + [Pi]min), which makes a potential function φmax= ψcb (λpmax ψtl[X]max/(ψpd +ψcb min))2 with a discount factor λ.
By analogy, the solution of (4) describing a complex (cid:6) formation attains at rate of production with [Pi]max (i=1, ..., d).
The steady-state condition induces an expert φmax=(λcmax ψcb i=1 d max/ψcd)2 with an arbitrary speciﬁed maximum value of the complex, cmax.
the maximal [Pi]τi  (cid:6) Pi(cid:5)=P  [Pi]τi  3.2.2 Experts on reaction speeds As well as the maximal and minimal levels of production, experimental data provide us a further clue to what temporal patterns reaction speeds DEs must exhibit in simulation.
Suppose that a temporal proﬁle of mRNA is observed as shown in Figure 1, showing increasing and decreasing trends alternatively.
Gradients of any ﬁtted DE models should reproduce the observed steepness during each trend.
Of many possible ways to develop such experts, we present a practically useful, simple procedure that is implemented on LiSDAS.
The ﬁrst task to be addressed is a decomposition of an entire time interval into active and inactive durations according to observed gene expression proﬁles, and values of gradients or steepness in  i592  each of the identiﬁed phases.
The proposed procedure starts with ﬁtting a non-parametric regressor, fi(t)= µi+wT i g(t)+vi(t), to the i-th mRNA proﬁle, yi(t) (t  N ), where µi and vi(t) are intercept and residual, respectively.
The J basis functions placed at equally- spaced grids in T are aggregated to g(t)  RJ , and wi  RJ is a vector of coefﬁcients.
LiSDAS ﬁts the Gaussian radial functions by using (cid:11)2 regression scheme.
A value of bandwidth common to all basis functions and a shrinkage parameter in the (cid:11)2 regression are prescribed by users.
The ﬁtted curve ˆfi(t)= ˆµi+ ˆwT i g(t) offers a gradient function over time, ˆwT i (dg(t)/dt).
Let Don and Doff be duration times of increasing and decreasing trends that are identiﬁed as subsets of the entire time interval.
Each duration keeps a same sign of the evaluated gradients during the consecutive times.
The key idea here is to derive a set of experts such that each potential function reﬂects a reaction speed of increasing or decreasing during each of the identiﬁed local times.
e  ψrd  ψb ψrd  ψrd +   ψrdt  [X]=  (open gate)  (closed gate)     (cid:10)   ψtc+ψb  (cid:10) + [X]0  ψb  (cid:11) [X]0  ψtc+ψb ψrd  ψrdt e  The Hill curve transcription dynamics in Section 2.1 are locally linear where the concentration levels of all the transcription factors rise much above or fall much below the relevant Kis.
At the reaction speeds of transcriptional process with open/closed AND gates, we have the solutions:  (cid:11) where [X]0 is an initial condition.
Denote the start and end times of each identiﬁed duration by (ton ,toff ,ton end) for Don and (toff end) for Doff , respectively.
Of start start interest here is to identify regions of the parameter spaces such that the simulations instantaneously reproduce the observed reaction speeds ˆfi(t), respectively, for t [ton ].
,toff Specify ˆfi(ton start) and ˆfi(ton end) to [X] and [X]0 in the former ODE end solution corresponding to the active duration where t is set to the  ton length of the duration, ton = ton start.
An expert on reaction speed (cid:10)ˆfi(ton (cid:12)ˆfi(ton is then made of the potential function: start)  ψtc+ψb end)  ψtc+ψb φon =  ] or t [toff   ψrdton  (cid:13)2  ,ton end  (cid:11)     start  start  end  e  .
ψrd  ψrd  By analogy, the implicit function relevant to the latter solution  induces the expert on speed in the inactive duration with toff =  [11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i592 i589 i595   Bayesian experts in exploring reaction kinetics of transcription circuits     (cid:11)  toff end   toff start: φoff =  (cid:10)ˆfi(ton start)  ψb ψrd  (cid:12)ˆfi(toff end)  ψb ψrd These two potential functions form elements of a Gibbsian distribution in various ways, for instance  exp( φoff  φon/T).
Alternatively, we would develop an expert based on either   exp( φoff /T) or  exp( φon/T).
In advance to the posterior   ψrdtoff  (cid:13)2  exploration, LiSDAS generates many experts for all the identiﬁed duration times by joining/dissociating φon and φoff at random.
e  .
3.2.3 Summary Figure 1 summarizes all the potential functions that we use in later and a schematic view on the idea.
It is important to see that the preceding potential functions constitute, with their combination, a single potential function in (1).
For instance, the potential functions relevant to each mRNA φmax, φmin, φon and φoff  are deﬁned on the transcriptional parameters (ψrd ,ψtc,ψb), while the other potentials involve only the kinetics relevant to protein regulations.
LiSDAS draws at random potential functions and conventional Gaussian priors (the user can specify in the model construction ﬁle) for each set of kinetic parameters.
Each φi in (1) is then constructed by aggregating the extracted component prior distribution corresponding to different types of kinetic parameters.
3.3 Computational algorithm mixture P(θ   )=(cid:5)  DP is discrete with probability one, and represented as an inﬁnite πiδθi (θ) conditional on inﬁnite number of the atoms,   = θi i=1, ...,   following G0.
Hence, the time  i=1  course data also follow the inﬁnite mixture  Of interest in the subsequent posterior analysis is to realize random sample from the posterior distribution of   , a posteriori, and also the mixing rates πi, conditional on Y.
The Bayesian model in total forms a DP mixture (DPM) with the key hierarchical structure: (i) G DP(G γ,G0), (ii) θ G  G and (iii) Y θ  p(Y θ).
In statistical science, there have been several excellent reviews, providing technical details on DPM (Blei et al., 2005  Escobar et al., 1995  MacEachern et al., 1998).
We therefore present only a speciﬁc computational algorithm.
The procedure is computationally very straightforward.
Sample from the posterior is constructed in a recursive way as a conventional sampling algorithm does (e.g.
Escobar et al., 1995).
Suppose that,  in a current distinct parameter set,  k = θi i=1, ..., k  with the θi.
The total sample size is Nk =(cid:5) realized values being all distinct, there are ni occurrences of each i=1 ni.
Then, the (k+1)-th case is newly generated by the conditional posterior (θk+1  k ,Y) given P(θk+1  k ,Y)   k(cid:1)  ωjδθj (θk+1)+ωk+1P(θk+1 G0,Y),  as the mixture  k  j=1  with the mixing rates given by P(Y θj) (cid:14) P(Y θ)dG0(θ)  ωj         nj γ+Nk γ+Nk  γ  for j=1, ..., k, for j= k+1  .
The ﬁrst k component distributions consist of the Dirac measures δθj (θk+1) placed at the preceding sample points, with the mixing rates involving the frequency of sampling nj and the likelihood P(Y θj).
The last component represents the conditional posterior P(θk+1 G0,Y)  P(Y θk+1)G0(θk+1), and the normalizing constant cannot be evaluated analytically.
If a sample θk+1 is drawn from one of the preceding samples, the occurrence rate is updated, nj   nj+1.
Given a new θ  coming from the (k+1)-th distribution, the current set such that  k+1=  k+ θ   and nk+1=1.
Random draws having the higher likelihood P(Y θ) appear more frequently and result in an approximation of the posterior distribution P(θ Y) as the sampling process proceeds iteratively until convergence.
we increment  αiZ  i=1 m   1 i  exp( T  The remaining task to be addressed is to make a sample from  is very straightforward: (i) conduct the second-order approximation  here provide a simple Monte Carlo technique using importance sampling (IS).
One difﬁculty is relevant to making a sample from the  P(θk+1 G0,Y), and evaluation of its normalizing constant.
We Gibbsian mixture G0 (cid:5)  1φi(θ)).
Our approach of each potential function φi(θ)  φi( θi)+(θ  θi)T i( θi)(θ  θi) around  θi=argmaxφi(θ) with  i(θ) the Hessian matrix of φi, and (ii) the proposal distribution of IS is then deﬁned as the Gaussian distribution Qi(θ)= N(θ  θi,T  ( θi)  1) with the covariance Q(θ)=(cid:5) matrix given by the inverse of Hessian matrix times T. Let αiQi(θ) be the Gaussian mixture proposal distribution.
Assuming that we have a realization of k samples from the Q and the importance weights βi= G0(θi)/Q(θi) (i=1, ..., k), then the normalization constant appearing in the mixing rate of the (k+1)-th βjP(Y θj).
j=1 k component can be approximated by ( The approximated mixing rates are then proportional to  (cid:5)  (cid:5)  j=1 k  i=1 m   1  βj)          (cid:5) (cid:5)  nj (γ+Nk) (γ+Nk)  γ  βjP(Y θj) (cid:5) i=1 k  βiP(Y θi)  k i=1  βi  k i=1  βi  for j=1, ..., k, for j= k+1  .
One of the previously obtained k samples is replicated if a sampling process draws a component coincident to one of  1, ..., k .
If not, we add a new case θk+1= θ  from Q, and then assign the likelihood P(Y θk+1) and the IS weight βk+1.
All the cases, whether new or old, are independently distributed according to the Q, thereby ensuring the statistical consistency of the Monte Carlo approximation of ˆω.
4 APPLICATION An example in kinetic search of a circadian clock transcriptional circuit illustrates the practical relevance of the Bayesian expert systems, and we make a comparison to the non-expert approach using a conventional SMC (Nagasaki et al., 2006  Nakamura et al., 2009).
Our model considered here is an extended version of the gene regulatory model developed in Matsuno et al.
(2000) where among several studies used in evaluating relevance of various parameter search algorithms (Nagasaki et al., 2006  Nakamura et al., 2009  Yoshida et al., 2008).
The original model describes a reaction circuit of 12 endogenous variables, involving ﬁve mRNAs, ﬁve translated proteins and two protein complexes, which constitute an interlock of several types of positive and negative feedback loops.
We here added, to the previous model, seven clock-related variables and their regulatory mechanisms, reﬂecting in part the recent discoveries (Baggs et al., 2009  Ueda et al., 2005).
The newly constructed DE  i593   (cid:1) i=1  P(Y   )=  πiP(Y θi).
ˆωj    [11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i593 i589 i595   R.Yoshida et al.
A  B  Fig.
2.
Results of analysis of reaction kinetics.
(A) Petri net diagram for in silico circadian clock transcriptional circuit involving 19 endogenous variables and 116 unknown parameters.
(B) Simulation trajectories of the 19 variables with the estimated parameters (red  Bayesian expert, blue  non-expert SMC).
The black circles in the panels corresponding to the seven mRNAs denote the experimental data at the 12 time points.
The error bars (vertical red lines) indicate the maximum and minimum values among 20 simulated trajectories with different sets of the parameters that were estimated by repeating the Bayesian expert search independently.
model its mathematical form is available in the Supplementary Material contains 116 unknown parameters in total, consisting of 97 kinetic parameters and 19 initial conditions on x(0).
The search methods were applied to time course gene expression indices from GeneChip mouse genome microrrays (Ueda et al., 2002).
Of the 19 variables, temporal expression changes of the seven mRNAs were measured along 12 time points equally spaced on 44 h (http://sirius.cdb.riken.jp/MouseSCN/ MouseSCNCCG(020707).html).
A much detailed information on the speciﬁed prior distributions values for γ, temperature and conventional Gaussian priors used in combinations is accessible from the Supplementary web site, as well as the LiSDAS code that can reproduce the subsequent numerical analyses with a default conﬁguration ﬁle.
Figure 2 displays simulation trajectories of the 19 endogenous variables, where the identiﬁed kinetic parameters and initial state variables were deﬁned as the θi exhibiting the best ﬁt in terms of P(Y θi).
The DEs were solved using the Euler discretization with 700 time steps equally spaced on the entire time interval.
CPU time required for the execution of LiSDAS was  40 min (Intel Core2 Quad processor, 2.66 GHz) for the particles of size k=5 105.
Compared with the very poor results of the non-expert SMC method using only the conventional Gaussian priors, the LiSDAS could capture the underlying circadian rhythm inherent in the observed data with much better degree of ﬁtness.
Note that the applied search procedure is almost the same as a random search.
The particles were all drawn from G0, and then the best ﬁt value was merely chosen.
Therefore, the good performance arose from only the added Bayesian expert system.
To the best of our knowledge, the methods being able to estimate such many parameters have never appeared in the related research ﬁeld, while so far, our previous study (Yoshida et al., 2008) and the GA of Koh et al.
(2006) could draw reasonably good performances in analyses of a transcription model and in  i594  silico signal transduction pathway, containing, 44 and 84 unknown parameters respectively.
5 CONCLUDING REMARKS This brief article has described the new idea on data-driven parameter search for bio-pathway DE models.
The key contributions lie in the novel Bayesian expert systems induced by the base measure of DP prior.
The expert systems rely on the Gibbsian potential functions that reﬂect automatically recognized model-speciﬁc contexts reaction speeds, equilibrium states to the subsequent search process so as to prune insigniﬁcant parameter spaces.
The ability to aid in improving efﬁciency has been demonstrated in the example on transcriptional regulatory models.
The practical beneﬁt was surprisingly signiﬁcant  the applied simple search algorithm could draw fairly good performances only by a plug-in of the expert systems.
is made of  transductions and metabolic reactions other  With a view to general versatility of the current approach, developments of more practically relevant expert systems remain a challenge yet.
A biological circuit several types of biochemical reactions phosphorylation cascade-mediated signal than the transcriptional processes we studied.
In many cases, these reactions are modelled by more complex equations, being either stochastic or non-stochastic, than the Hill functions used in this article.
Though it would be straightforward, even for more complex DE systems, to relate observed maximal/minimal production levels to steady- state conditions, some difﬁculties arise in evaluations of experts on reaction speeds with a given more complex model due to unavailability of the analytical expression for the reaction speeds.
We then need to explore some numerical techniques for making expert system priors.
[11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i594 i589 i595   Bayesian experts in exploring reaction kinetics of transcription circuits  Making further variants in expert construction is possible, and will then be inherently context speciﬁc.
In view of biochemical kinetics, it would be more helpful to incorporate, to further prior modelling, differences of time scales on each reaction speed, such as difference in molecular stability of different proteins and mRNAs.
Signal transduction pathways usually change in transcription factor activities on subsecond time scales.
Binding of transcription factor to its target promoter reaches equilibrium in seconds.
Transcription and translation of genes take many minutes in reaching steady state.
We need to explore ways of reﬂecting these time scales to subjective prior distributions expressing a biologically signiﬁcant subspace of kinetic parameters.
Another important issue is unreliability of model.
In silico circuits embody currently obtained knowledge on many pairs of interacting molecules.
In many applications, such a circuit structure is totally unreliable because of environmental dependency and diversity of cells.
Very often, simulations fail to reproduce experimental data irrelevant to which kinetic parameters are speciﬁed.
The inconsistency indicates presence or absence of some regulatory mechanisms to be reﬂected into model reconstruction.
Recent systems biology therefore has explored a structural learning of reactions circuits in data-driven ways (Cantone et al., 2009  Cao et al., 2008  Porreca et al., 2010).
LiSDAS with the procedure speciﬁcation ﬁle in place can explore the most plausible circuit with the highest degree of ﬁt as well as kinetic values by adding/deleting edges completely at random.
However, with a view to larger scale models, the ability of such a low-level search method reaches a performance limit due to a huge space of possible edge conﬁgurations.
Our next challenge is the development of Bayesian experts in exploring circuit structure.
Conﬂict of Interest: none declared.
REFERENCES Alon,U.
(2006) An Introduction to Systems Biology.
Chapman and Hall, London, UK.
Baggs,J.E.
et al.
(2009) Network features of the mammalian circadian clock.
PLoS  Biol., 7, e1000052.
Blei,D.M.
et al.
(2005) Variational inference for Dirichlet process mixtures.
Bayesian  Anal., 16, 121 144.
Cantone,I.
et al.
(2009) A yeast synthetic network for in vivo assessment of reverse-  engineering and modeling approaches.
Cell, 137, 172 181.
Cao,J.
et al.
(2008) Estimating dynamic models for gene regulation networks.
Bioinformatics, 24, 1619 1624.
Chen,K.C.
et al.
(2004) Integrative analysis of cell cycle control in budding yeast.
Mol.
Biol.
Cell., 15, 3841 3862.
Escobar,M.D.
et al.
(1995) Bayesian density estimation and inference using mixtures.
J.
Am.
Stat.
Assoc., 90, 577 588.
Koh,G.
et al.
(2006) A decompositional approach to parameter estimation in pathway modeling: a case study of the Akt and MAPK pathways and their crosstalk.
Bioinformatics, 22, e271 e280.
Finkenstädt,B.
et al.
(2008) Reconstruction of transcriptional dynamics from gene  reporter data using differential equations.
Bioinformatics, 24, 2901 2907.
Fujarewicz,K.
et al.
(2007) Adjoint systems for models of cell sinaling pathways and their applications to parameter ﬁtting.
IEEE/ACM Trans.
Comput.
Biol.
Bioinformatics, 4, 322 335.
Higuchi,T.
(1997) Monte Carlo ﬁlter using the genetic algorithm operators.
J. Stat.
Comput.
Simul., 59, 1 23.
Kikuchi,S.
et al.
(2003) Dynamic modeling of genetic networks using genetic algorithm  and S-system.
Bioinformatics, 19, 643 650.
Kimura,S.
et al.
(2004) Inference of S-system models of genetic networks using a  cooperative coevolutionary algorithm.
Bioinformatics, 21, 1154 1163.
MacEachern,S.N.
et al.
(1998) Estimating mixture of Dirichlet process models.
J. Comput.
Graph.
Stat., 7, 223 238.
Matsuno,H.
et al.
(2000) Hybrid Petri net representation of gene regulatory network.
Pac.
Symp.
Biocomput., 5, 341 352.
Nagasaki,M.
et al.
(2006) Genomic data assimilation for estimating hybrid functional  petri net from time-course gene expression data.
Genome Inform., 17, 46 61.
Nakamura,K.
et al.
(2009) Parameter estimation of in silico biological pathways with particle ﬁltering towards a petascale computing.
Pac.
Symp.
Biocomput., 14, 227 238.
Perrin,B.E.
et al.
(2003) Inference of gene regulatory network using dynamic Bayesian  networks.
Bioinformatics, 19, ii138 ii148.
Porreca,R.
et al.
(2010) Identiﬁcation of genetic network dynamics with unate structure.
Bioinformatics, 26, 1239 1245.
Quach,M.
et al.
(2007) Estimating parameters and hidden variables in non-linear state- space models based on ODEs for biological networks inference.
Bioinformatics, 23, 3209 3216.
Ueda,H.R.
et al.
(2002) A transcription factor response element for gene expression  during circadian night.
Nature, 418, 534 539.
Ueda,H.R.
et al.
(2005) System-level identiﬁcation of transcriptional circuits underlying  mammalian circadian clocks.
Nat.
Genet., 37, 187 192.
Wilkinson,D.J.
(2006) Stochastic Modelling for Systems Biology.
Chapman and Hall,  London, UK.
Yoshida,R.
et al.
(2008) Bayesian learning of biological pathways on genomic data  assimilation.
Bioinformatics, 24, 2592 2601.
[11:05 28/8/2010 Bioinformatics-btq389.tex]  Page: i595 i589 i595  i595
