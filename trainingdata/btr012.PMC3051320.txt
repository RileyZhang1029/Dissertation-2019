ABSTRACT Summary: We present an R based pipeline, ArrayExpressHTS, for pre-processing, expression estimation and data quality assessment of high-throughput sequencing transcriptional profiling (RNA-seq) datasets.
The pipeline starts from raw sequence files and produces standard Bioconductor R objects containing gene or transcript measurements for downstream analysis along with web reports for data quality assessment.
It may be run locally on a users own computer or remotely on a distributed R-cloud farm at the European Bioinformatics Institute.
It can be used to analyse users own datasets or public RNA-seq datasets from the ArrayExpress Archive.
Availability: The R package is available at www.ebi.ac.uk/tools/ rcloud with online documentation at www.ebi.ac.uk/Tools/rwiki/, also available as supplementary material.
Contact: angela.goncalves@ebi.ac.uk Supplementary information: Supplementary data are available at Bioinformatics online.
Received on November 4, 2010; revised on December 17, 2010; accepted on January 4, 2011 1 INTRODUCTION Deep sequencing of cDNA molecules (RNA-seq) is becoming the tool of choice for gene expression studies, often replacing microarrays to estimate gene expression levels, and rapidly superseding exon arrays in alternative splicing analysis (Wang et al., 2008) or tilling arrays in the identification of previously unknown transcribed regions (Guttman et al., 2010; Trapnell et al., 2010).
In fact RNA-seq allows researchers to study phenomena that were previously beyond the reach of microarrays, such as allele specific expression (Montgomery et al., 2010).
The popularity of the new sequencing methods for gene expression is attested by the numerous recent publications and by the increasing number of submissions to public data repositories such as ArrayExpress (AE) (Parkinson et al., 2008).
Many methods have been developed recently to tackle different aspects of RNA-seq data analysis, but combining them into a robust analysis pipeline is an inherently study-specific task and poses ongoing challenges.
The configuration options used for each tool affect the others used downstream, making it necessary for bioinformaticians to have a thorough knowledge of each one of them and its internal workings.
Furthermore, RNA-seq methods routinely generate tens of millions of raw sequence reads corresponding to hundreds of gigabytes of data, the analysis of which requires intensive computational processing steps that render the analysis To whom correspondence should be addressed.
impossible without the use of powerful servers.
The gap between experimental throughput and processing speed is widening (Schatz et al., 2010), with the analysis component falling behind.
In light of these considerations we have developed ArrayExpressHTS, an automated R/Bioconductor-based pipeline for pre-processing, expression estimation and data quality assessment of RNA-seq datasets.
Starting from the raw read files it produces standard R objects containing expression levels for downstream analysis, and graphical HTML reports for data quality assessment.
The pipeline has a choice of analysis methods and guides their configuration.
Flexibility is provided for power users to adjust all aspects of the pipeline within the well-known and powerful R language.
2 METHODS 2.1 The analysis pipeline Running ArrayExpressHTS within R with default options is straightforward, with a simple call to function ArrayExpressHTS.
Data analysis begins by obtaining the input raw read files and the corresponding experimental metadata.
This experimental metadata serves to create a set of options used to configure the analysis and includes experimental protocol information such as the retaining of strand information and the insert size in paired-end reads; experiment design information including the links between files and sample properties (e.g.disease states); and machine-related information, such as the instrument used and quality scale (Fig.1).
Further options passed to the processing methods are documented in the pipeline and a set of reasonable options provided as default.
Once the necessary data is gathered, an HTML report is created, providing the investigator with diagnostics plots.
Plots built upon the ones in the ShortRead (Morgan,M.
et al., 2009) package are provided for individual samples, while additional ones are available for between-sample comparisons.
Fig.1.
The ArrayExpressHTS analysis pipeline.
The Author(s) 2011.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[10:30 19/2/2011 Bioinformatics-btr012.tex] Page: 868 867869 A.Goncalves et al.The analysis proceeds by mapping reads to a reference sequence (a genome or a transcriptome), with one of the available aligners: Bowtie (Langmead et al., 2009), TopHat (Trapnell et al., 2009) or BWA (Li and Durbin, 2009).
The alignments are saved in the standard SAM format, converted to the BAM format (loadable into R) and sorted seamlessly with SAMtools (Li et al., 2009).
