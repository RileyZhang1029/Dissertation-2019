BIOINFORMATICS APPLICATIONS NOTE Vol.
24 no.
22 2008, pages 2630 2631  doi:10.1093/bioinformatics/btn504  Sequence analysis Proﬁle Comparer: a program for scoring and aligning proﬁle hidden Markov models Martin Madera   Department of Computer Science, University of Bristol, Bristol, UK Received on August 8, 2008  revised on September 11, 2008  accepted on September 19, 2008 Advance Access publication October 9, 2008 Associate Editor: Alex Bateman  ABSTRACT Summary: Proﬁle Comparer (PRC) is a stand-alone program for scoring and aligning proﬁle hidden Markov models (HMMs) of protein families.
PRC can read models produced by SAM and HMMER, two popular proﬁle HMM packages, as well as PSI-BLAST checkpoint ﬁles.
This application note provides a brief description of the proﬁle  proﬁle algorithm used by PRC.
Availability: The C source code licensed under the GNU General Public Licence and Linux and Mac OS X binaries can be downloaded from http://supfam.org/PRC.
Contact: martin.madera@gmail.com Supplementary information: Supplementary data are available at Bioinformatics online.
1 INTRODUCTION Proﬁle Comparer (PRC) is a program for scoring and aligning a proﬁle hidden Markov model (HMM) of a protein family against other proﬁle HMMs.
Proﬁles are tables that give a score for a particular amino acid to be found at a particular position in an alignment of a protein family.
The best known proﬁle method is probably PSI-BLAST (Altschul et al., 1997).
Proﬁle HMMs are similar to proﬁles, but replace scores with probabilities, and introduce additional probabilities for insertions and deletions at each position in the proﬁle (Durbin et al., 1998  Eddy, 1998).
All probabilities are placed within a single statistical framework, an HMM.
In this note, we shall count proﬁle HMMs among proﬁle methods.
It is now well established that proﬁle proﬁle methods detect more distant homologies than proﬁle sequence methods, which in turn are more powerful than sequence sequence methods (see e.g.
Sadreyev and Grishin, 2008  Soding, 2005).
Proﬁle proﬁle methods also generate the most accurate alignments  in fact, proﬁle proﬁle methods were ﬁrst used in progressive multiple sequence alignment and only later for homology recognition.
Out of proﬁle sequence methods, the SAM and HMMER proﬁle HMM programs (Eddy, 1998  Hughey and Krogh, 1996) are believed to be the best (Fig.
1).
In addition to insertion and deletion probabilities that vary along the proﬁle, the improvement over, e.g.
PSI-BLAST comes from a number of other innovations, including use of the forward algorithm instead of Viterbi (Durbin et al.,     To whom correspondence should be addressed.
1998) and a better algorithm for estimating a proﬁle from a given alignment.
The goal of PRC is to apply lessons learned from development of SAM and HMMER to the proﬁle proﬁle case.
PRC was ﬁrst publicly released in 2002 and has been used by Pfam since 2005.
Recently PRC has performed well in benchmarks (Sadreyev and Grishin, 2008  Soding, 2006) carried out by the authors of the two main alternative proﬁle proﬁle methods, COMPASS (Sadreyev and Grishin, 2008) and HHsearch (Soding, 2005).
Here, we provide an overview of the PRC algorithm (version 1.5.5) and explain how to use the program.
2 THE PRC ALGORITHM When scoring a proﬁle HMM against a library of proﬁle HMMs, PRC reports E-values, which give an estimate of how signiﬁcant the matches are.
In order to calculate E-values, PRC ﬁrst calculates three other scores: co-emission, simple and reverse.
Each score builds upon the previous one, until ﬁnally reverse scores are converted into E-values.
The co-emission score Sco-em is a generalization of the log-odds  score Slog-odds calculated by SAM and HMMER,  Slog-odds=log  to the HMM HMM case:  (cid:1)  (cid:2)=log  Sco-em  1,2  (cid:1)  (cid:3)  P  σ  (cid:1)  P P  (cid:2) σ HMM (cid:2) , (cid:1) σ null (cid:1) (cid:2) P σ null  σ HMM1 (cid:1) P  (1)  (2)  (cid:2)  .
σ HMM2 (cid:2)  (cid:2)  (cid:1)  σ HMM  The sum is over all possible amino acid sequences σ , and the probability P that the proﬁle HMM emits a sequence σ is calculated using the forward algorithm (Durbin et al., 1998).
(cid:2)=1 if When one of the HMMs is extremely  narrow , e.g.
it only emits a single sequence τ with a non-zero probability (P σ = τ , 0 otherwise), the co-emission score tends to the proﬁle HMM log-odds score for τ .
The null model emits random sequences with background amino acid frequencies and a geometric distribution of lengths.
σ HMM  (cid:1)  The simple score Ssimple is the same as the co-emission score Sco-em, but both proﬁle HMMs are restricted to regions of signiﬁcant similarity.
The regions are found by an iterative procedure that picks a new end point as the maximum of the forward score in the dynamic programming matrix, and a start point as the maximum of the backward score.
2008 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
e g a r e v o c  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  PRC 1.5.5 SAM 3.4 PSI-BLAST  2.2.18 BLAST 2.2.18  0.001  0.01  0.1  1  10  errors per query  Fig.
1.
A SCOP domain benchmark (Madera and Gough, 2002) of PRC, illustrating the improvement over standard methods.
The SCOP seed sequences were ﬁltered to  25% sequence identity.
PRC and SAM (Hughey and Krogh, 1996) used SUPERFAMILY proﬁle HMMs (Gough et al., 2001).
PSI-BLAST (Altschul et al., 1997) checkpoint ﬁles used in the benchmark were derived from SUPERFAMILY proﬁle HMMs and use identical probabilities for the proﬁle part.
For a comparison of PRC to competing proﬁle proﬁle methods, the reader is referred to Soding (2006) and Sadreyev and Grishin (2008).
The reverse score Srev for two proﬁle HMMs 1 and 2 is deﬁned  as  (cid:1)  (cid:2)= Ssimple  (cid:1)  1,2  (cid:2) Ssimple  (cid:1)  1,2  Srev  (cid:2)  ,  rev1,2  Proﬁle Comparer  3 USING PRC PRC can read SAM3 (ASCII and binary) and HMMER2 model ﬁles, and PSI-BLAST checkpoint ﬁles.
The same internal proﬁle HMM is used for scoring all three.
For PSI-BLAST checkpoint ﬁles, the proﬁle part is taken from the checkpoint ﬁle and the insertion and deletion probabilities are set to default values, constant throughout the model.
For best performance, users should build a full proﬁle HMM using the SAM w0.5 script.
For accurate E-values, the library should contain at least 1000 proﬁle HMMs.
For libraries of sufﬁcient size, E   0.003 can be  5 as a strong match.
taken as indicative of homology and E   10 When a large library is not available, Equation (5) with λ= 0.8, κ = 0 can be used as a conservative guide.
Starting with version 1.5.5, the PRC source code also includes a simple Perl script, merge_aligns.pl.
Given two HMM sequence alignments in the SAM a2m format, and a PRC alignment between the two HMMs, the script will output a pairwise alignment between the two sequences.
Users who would like to visualize their HMM  HMM alignments are referred to the pairwise HMM logos server (Schuster-Bockler and Bateman, 2005).
Funding: M.M.
s Internal Graduate Studentship from Trinity College, Cambridge, UK  the UK Medical Research Council and the Laboratory of Molecular Biology, Cambridge, UK (Cyrus Chothia s group)  the European Bioinformatics Institute (Nick Goldman s group)  Kevin Karplus s National Institutes of Health grant R01 GM068570  Julian Gough s European Union Framework Programme 7 IMPACT grant.
(3)  Conﬂict of Interest: none declared.
where the reverse HMM is deﬁned as follows:  for every σ, P  (cid:1)  σ revHMM  (cid:1)  (cid:2)= P  revσ HMM  (cid:2)  .
(4)  REFERENCES Altschul,S.F.
et al.
(1997) Gapped BLAST and PSI-BLAST: a new generation of protein  Here, rev is a reverse operator that maps residue or model segment i (1  i  L) onto residue L i+1.
This is a generalization of the reverse sequence null model used by SAM (Karplus et al., 2005).
Finally, for library runs the reverse score Srev is turned into an E-value by ﬁtting the following function to the observed distribution of reverse scores:  (cid:1)  E  Srev   x  (cid:2)=  nunrel  (cid:1)  1+exp  λx+κ  (cid:2) .
(5)  The E-value E is the expected number of random matches with a reverse score better than x, and nunrel is the number of proﬁle HMMs in the library that are unrelated to the query.
The formula is a slight generalization of the function used by SAM (Karplus et al., 2005).
Optimal values of the two parameters λ and κ for each run are found using a censored Maximum Likelihood ﬁtting procedure.
HMM HMM alignments are computed by ﬁnding the Viterbi path that maximizes the sum of forward backward odds scores (Durbin et al., 1998).
database search programs.
Nucleic Acids Res., 25, 3389 3402.
Durbin,R.
et al.
(1998) Biological Sequence Analysis: Probabilistic Models of Proteins  and Nucleic Acids.
Cambridge University Press, Cambridge, UK.
Eddy,S.R.
(1998) Proﬁle hidden Markov models.
Bioinformatics, 14, 755 763.
Gough,J.
et al.
(2001) Assignment of homology to genome sequences using a library of hidden Markov models that represent all proteins of known structure.
J. Mol.
Biol., 313, 903 919.
Hughey,R.
and Krogh,A.
(1996) Hidden Markov models for sequence analysis:  extension and analysis of the basic method.
Comput.
Appl.
Biosci., 12, 95 107.
Karplus,K.
et al.
(2005) Calibrating E-values for hidden Markov models using reverse-  sequence null models.
Bioinformatics, 21, 4107 4115.
Madera,M.
and Gough,J.
(2002) A comparison of proﬁle hidden Markov model  procedures for remote homology detection.
Nucleic Acids Res., 30, 4321 4328.
Sadreyev,R.I.
and Grishin,N.V.
comparison between multiple [doi:10.1093/nar/gkn065, Epub ahead of print, February 19, 2008].
(2008) Accurate sequence  of alignments.
Nucleic Acids Res.
statistical model  Schuster-Bockler,B.
and Bateman,A.
(2005) Visualizing proﬁle-proﬁle alignment:  pairwise HMM logos.
Bioinformatics, 21, 2912 2913.
Soding,J.
(2005) Protein homology detection by HMM-HMM comparison.
Bioinformatics, 21, 951 960.
Soding,J.
(2006) Available at http://toolkit.tuebingen.mpg.de/hhpred/help_ov [Last  accessed date, October 8, 2008]  2631
