Abstract Motivation: Model selection and parameter inference are complex problems of long-standing interest in systems biology.
Selecting between competing models arises commonly as underlying biochemical mechanisms are often not fully known, hence alternative models must be considered.
Parameter inference yields important information on the extent to which the data and the model constrain parameter values.
Results: We report Dizzy-Beats, a graphical Java Bayesian evidence analysis tool implementing nested sampling-an algorithm yielding an estimate of the log of the Bayesian evidence Z and the moments of model parameters, thus addressing two outstanding challenges in systems modelling.
A likelihood function based on the L1-norm is adopted as it is generically applicable to replicated time series data.
Availability and implementation: http://sourceforge.net/p/bayesevidence/home/Home/ Contact: s.aitken@ed.ac.uk 1 Introduction Bayesian methods provide a sound basis for ranking alternative systems biology models and for characterizing the extent to which parameters are constrained by models and data (Kirk et al., 2013).
Markov Chain Monte Carlo methods have been applied to model selection (Schmidl et al., 2012) and to parameter inference in systems biology (Hug et al., 2013; Kanodia et al., 2014), but often require considerable algorithmic and conceptual development.
Nested sampling promises to ease these complex computational tasks: Recent biological applications include (Aitken and Akman, 2013; Kirk et al., 2013; Pullen and Morris, 2014).
General purpose code for nested sampling is available in R (Skilling, 2006; Aitken and Akman, 2013), and biological applications of the MultiNest tool (Feroz et al., 2013) have been reported (Kirk et al., 2013; Pullen and Morris, 2014).
A C-based commandline application implementing nested sampling and providing a Systems Biology Markup Language (SBML) interface has recently been released (Johnson et al., 2014), but no graphical tool is currently available.
Thus we sought to add nested sampling to the widely used Dizzy chemical kinetics simulation tool (Ramsey et al., 2005) (over 200 citations as of November 2014).
In addition, we have added an optimization function and SBML 3.1 compatibility.
However, as Dizzys command language has operators that cannot be captured in SBML 3.1, and SBML 3.1 has features not supported by Dizzy, this feature is restricted to the intersection of the modelling languages.
2 Methods Nested sampling calculates two of the central results of Bayesian inference: the posterior distribution PhjD;Hi of the parameters h, and the evidence PDjHi, that is, the support for the data D under hypothesis Hi (Skilling, 2006), through a sampling strategy.
VC The Author 2015.
Published by Oxford University Press.
1863 This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited.
For commercial re-use, please contact journals.permissions@oup.com Bioinformatics, 31(11), 2015, 18631865 doi: 10.1093/bioinformatics/btv062 Advance Access Publication Date: 30 January 2015 Applications Note A selection between two alternative models H0 and H1 can be made by calculating the ratio of their posterior probabilities (1), a calculation that can be decomposed into the Bayesian evidence (Z0 and Z1) and the prior probability of the respective hypotheses.
PH1jD PH0jD PDjH1PH1 PDjH0PH0 Z1PH1 Z0PH0 (1) Z  Lhph dh (2) The evidence (2) is a scalar quantity that can be viewed as an integral of the likelihood (L) over the elements of mass (dX phdh) associated with the prior density ph.
The prior mass can be accumulated from its elements (dX) in any order.
The enclosed prior of likelihood > k can be defined (3), and this allows the evidence to be written as a one-dimensional integral of the (inverse) likelihood L(X) over the unit range (taking the enclosed prior mass X to be the primary variable) (4) (Skilling, 2006).
Xk  Lh>k ph dh (3) Z 1 0 LX dX (4) LXk k Given a sequence of decreasing values 0 < Xm <... X2 < X1 < 1 where the likelihood Li LXi can be evaluated, the evidence can be approximated numerically as a weighted sum.
Inferences about the posterior can be obtained from the sequence of m discarded points generated by sampling, P. Each point is assigned the weight pi Lhiwi=Z, from which the first and second moments of each parameter in h can be estimatedfor more details see Skilling (2006) and Aitken and Akman (2013).
The size of the population of active points (points hi within the evolving constraint Lh > k) used to sample the parameter space is the only parameter of the algorithm that the user must specify.
For complex likelihood functions with multiple modes, this number may be as high as 10 000, and for a single mode as low as 200.
Dizzy-Beats updates the user interface of the original Dizzy program (Ramsey et al., 2005) retaining the text of the model in the left editing panel (see Fig.1) and placing the original simulator choices in the simulation tab on the right.
A histogram plot for visualizing the results of stochastic simulations is added to the simulation viewing formats.
Two new tabs add optimization and inference capabilities, and both require a data file to be specified (a simple comma separated format is used, with column headers matching the names of species in the model).
Using the simulation tab, the user can select parameters, modify their values and see the simulation results plotted over the data.
This allows a manual tuning and exploration of the models fit to the data.
Computational optimization using simulated annealing can be run to explore a larger parameter space.
Similarly, the inference tab requires users to select parameters to be included in inference by nested sampling and to input their prior range.
A uniform prior is assumed as is typical in nested sampling.
A graph of log likelihood or of the samples of the selected parameters can be viewed as nested sampling progresses to monitor progress.
The stopping heuristics of Aitken and Akman (2013) are implemented but the user can in addition specify the maximum number of iterations, and must specify the number of active points.
The outputs are a file summarizing the results, and a second listing the posterior samples for further analysis.
A likelihood function based on the L1-norm is used for optimization and inferencethis is defined by Equations (5) and (6) (Sivia and Skilling, 2006).
t hjxt ltji jxt ltjpxdNx (5) pxj lt; tf g Ym t1 1 2t exp j~xt ltj t  (6) Equation (5) defines the normalizing constant t as the expected value of the moduli of the differences between the replicate observations at time t and the values predicted by the kinetic model (lt).
The product of the probabilities of the median observation at time t (~xt) defines the likelihood function for a time series x of m samples [Equation (6)].
Maximization of this likelihood minimizes the sum of the moduli of the residuals (rather than their squares) on the basis that the testable information is restricted to the expected value of the modulus of the difference between theory and experiment.
Should we know both the mean and variance, maximum entropy considerations would lead instead to the Gaussian distribution (Sivia and Skilling, 2006).
Time points where the replicates are most dissimilar contribute least to the likelihood as t is largeras is desirable.
3 Discussion Dizzy-Beats is a graphical application for simulating and optimizing systems models based on an established simulator (Ramsey et al., 2005) and its simple textual model syntax, to which we have added SBML 3.1 import/export functionality.
Uniquely, Dizzy-Beats provides model comparison and parameter inference functions through the nested sampling algorithm in a graphical application.
Comparable functions are implemented in BioBayes (Vyshemirsky and Girolami, 2008); however, users must edit the XML representation of the model should they wish to make modifications.
SYSBIONS (Johnson et al., 2014) implements nested sampling but all interaction is via the command-line.
The use of a likelihood based on the L1-norm derived from biological replicate data makes fewer assumptions than a Gaussian error model (Johnson et al., 2014; Vyshemirsky and Girolami, 2008), and is less computationally complex than a transitional likelihood function derived from reaction propensities (Aitken and Akman, 2013; Heron et al., 2007).
Fig.1.
Dizzy-Beats: an application for parameter inference and model selection 1864 S.Aitken et al.&ndash; the s s s , s s &ndash; s &epsi;t ( ) s s &epsi;t &ndash; s , ; Aitken and Akman, 2013 Funding This work was funded by BBSRC grant [BB/I023461/1] (Bayesian evidence analysis tools for systems biology; S.A. and O.E.A.).
Conflict of Interest: none declared.
