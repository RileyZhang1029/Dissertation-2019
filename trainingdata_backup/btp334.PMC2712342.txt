            G:\fpp\tex\journals\oup\BioInfo\Bioinfo-25(15)issue\btp334.dvi [18:14 3/7/2009 Bioinformatics-btp334.tex] Page: 1862 18621868 BIOINFORMATICS ORIGINAL PAPER Vol.
25 no.
15 2009, pages 18621868doi:10.1093/bioinformatics/btp334 Sequence analysis CORAL: aligning conserved core regions across domain families Jessica H. Fong and Aron Marchler-Bauer National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, 8600 Rockville Pike, Bethesda, MD 20894, USA Received on December 10, 2008; revised on May 5, 2009; accepted on May 21, 2009 Advance Access publication May 26, 2009 Associate Editor: Burkhard Rost ABSTRACT Motivation: Homologous protein families share highly conserved sequence and structure regions that are frequent targets for comparative analysis of related proteins and families.
Many protein families, such as the curated domain families in the Conserved Domain Database (CDD), exhibit similar structural cores.
To improve accuracy in aligning such protein families, we propose a profile profile method CORAL that aligns individual core regions as gap-free units.
Results: CORAL computes optimal local alignment of two profiles with heuristics to preserve continuity within core regions.
We benchmarked its performance on curated domains in CDD, which have pre-defined core regions, against COMPASS, HHalign and PSI-BLAST, using structure superpositions and comprehensive curator-optimized alignments as standards of truth.
CORAL improves alignment accuracy on core regions over general profile methods, returning a balanced score of 0.57 for over 80% of all domain families in CDD, compared with the highest balanced score of 0.45 from other methods.
Further, CORAL provides E-values to aid in detecting homologous protein families and, by respecting block boundaries, produces alignments with improved readability that facilitate manual refinement.
Availability: CORAL will be included in future versions of the NCBI Cn3D/CDTree software, which can be downloaded atContact: fongj@ncbi.nlm.nih.gov.
Supplementary information: Supplementary data are available at Bioinformatics online.
1 INTRODUCTION Homologous protein families contain core regions that reflect conservation in molecular evolution.
Many protein family alignments in Pfam (Finn et al., 2006), SMART (Letunic et al., 2006) and SUPERFAMILY (Wilson et al., 2007) exhibit conserved regions including blocks, or ungapped regions, within an alignment.
The Conserved Domain Database (CDD) (Marchler-Bauer et al., 2009) models protein domains explicitly as series of blocks.
For NCBIcurated domains, the blocks represent structural core motifs based on structure superpositions as well as conserved sequence regions and motifs.
Comparative analysis of proteins and protein families through sequence alignment is invaluable for grouping homologs, To whom correspondence should be addressed.
subdividing diverse families into sub-families, tracing evolutionary histories and identifying conserved functional sites.
In recent years, alignment methods that compare two profiles, the statistical models that represent protein families, have been shown to improve alignment quality and homolog recognition over sequencesequence methods such as BLAST (Altschul et al., 1997) and sequenceprofile methods such as PSI-BLAST (Altschul et al., 1997; Schaffer et al., 2001).
Numerous profile alignment methods have been assessed in Edgar and Sjolander (2004), Heger and Holm (2001), Ohlson and Elofsson (2005), Ohlson et al.(2004), Panchenko (2003), Rychlewski et al.(2000), Soding (2005), Yona and Levitt (2002) and others.
While many alignment methods focus on detecting remote homologs in order to expand coverage of functional inference, obtaining high-quality alignments remains difficult even for closely-related families.
According to structure superpositions, corresponding core regions in many homologous domains differ by fewer insertions and deletions than inferred by general alignment programs, reflecting the stability of the structural core of the protein family.
To better capture this property, we propose a method CORAL (CORe ALigner) to align core regions from two protein families without indels within blocks, which we will refer to as the core constraint.
CORAL is implemented through a common dynamic programming engine for optimal pair-wise alignment (Needleman and Wunsch, 1970; Smith and Waterman, 1981).
Several other algorithms to align sequence or sequence profiles to core regions have been effective for detecting similarities or assigning domains.
These algorithms include a profileprofile method using Gibbs sampling (Panchenko, 2003), and SALTO (Kann et al., 2005) and GLOBAL (Kann et al., 2007) which employ additional block-based constraints.
SALTO aligns a consecutive subset of complete blocks and GLOBAL aligns a sub-set (including full or empty set) of contiguous columns within every block.
All of these methods disallow indels in alignments of blocks and exclude sequence regions outside blocks.
Additionally, LAMA (Pietrokovski, 1996) and CYRCA (Kunin et al., 2001) were developed to align individual blocks that represent sequence motifs (Henikoff et al., 2000).
Block shift and extension operations have also proved useful to improve multiple sequence alignments (MSAs) through REFINER (Chakrabarti et al., 2006).
Here, we present the CORAL algorithm and benchmark its performance on curated domains in CDD against other widely used profile methods COMPASS (Sadreyev and Grishin, 2003), HHalign (Soding, 2005) and PSI-BLAST.
Reference alignments are inferred from structure superpositions from the VAST database 2009 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[18:14 3/7/2009 Bioinformatics-btp334.tex] Page: 1863 18621868 CORAL (Gibrat et al., 1996; Madej et al., 1995) and the SABmark benchmark set (Van Walle et al., 2005), and from a comprehensive set of expert-determined mappings, and homology is defined by CDD relationships.
In particular, CORAL outperforms all other methods in the quality of alignments.
We also discuss the role of profile alignment in modeling protein families.
2 METHODS 2.1 Core regions dataset MSAs representing protein family core regions were taken from the curated domains in CDD.
Sequence regions outside the cores are not aligned in CDD and are not considered in this study.
Here, we use the terms domain and protein family interchangeably.
NCBI-curated domains have been organized into hierarchical domain families.
A superfamily, which indicates common evolutionary descent, contains one or more domain families.
We define related domains with respect to CDD to be those in the same family and unrelated domains to be those in different superfamilies, in order to minimize false positives (FPs).
A set of 100 domains, chosen randomly from different superfamilies, was reserved for parameter optimization (dataset opt100).
Similarity between domains was estimated as the fraction identity of their consensus sequences with pair-wise sequence alignments computed by MUSCLE 3.6 (Edgar, 2004).
The consensus sequences express only columns in the MSA with <50% gap content, including the most conserved columns, and hence report higher similarity values than using full length protein sequences.
2.2 Reference alignments To test alignment accuracy, we construct three benchmark datasets.
The first reference set is based on superpositions of the 3D structures that annotate curated domains in CDD v2.14.
We gather structural neighbors from the VAST database that satisfy the default significance cutoff of P-value < 0.0001, such that folds are described by a continuous sequence region that overlaps the sequence fragment in the domain model by 90%.
To ensure that the structure alignments involve core regions, aligned core positions are required to comprise 80% of all structurally aligned positions and 50% of the respective profiles.
This procedure yields structure alignments for 2385 domain pairs within 91 CDD families.
A second set of structure alignments is taken from the superfamilies set in SABmark, that is, alignments of SCOP domains with a common evolutionary origin.
CDD domains are mapped onto the SCOP domains using RPSBLAST (Marchler-Bauer et al., 2002).
Due to time of testing, a later version of CDD (v 2.16) was used for this benchmark set.
SCOP folds are filtered for live sequences in Entrez and at least 50% overlap with the extent of the domain hit, resulting in structure alignments for 1627 domain pairs in 128 SCOP superfamilies.
The two structural reference sets differ in coverage across and within domain families; classification by CDD versus SCOP; and curator-optimized versus RPSBLAST-computed structure-domain alignments.
Athird benchmark set provides comprehensive coverage over homologous domains in CDD.
In NCBI-curated hierarchies, the MSAs of a parent domain and its sub-family contain overlapping fragments from at least one protein sequence.
The shared sequence identifies aligned columns between the two MSAs and reflects the curators assertion of how the sub-family should be mapped to its parent.
Transitivity over each hierarchy extends the guide alignment to all pair-wise comparisons in multi-domain families.
Guide alignments include 57 786 domain pairs over 212 CDD families.
2.3 Alignment algorithm We describe the profile alignment algorithm with core constraint in terms of required modifications to the canonical algorithm for local alignment (Smith and Waterman, 1981).
The problem is to align profiles A = a1 an and B = b1 bm with n and m columns, respectively, where each profile has been subdivided into blocks.
Let table H contain the maximum similarity score of two profile segments ending in ai and bj in entry Hi,j Scoring functions S(ai, bj) to compute the similarity between profile columns ai and bj are described in the next paragraph.
To prevent gaps within blocks, the affine gap penalty is replaced with a large negative value if the last aligned column before the gap is not a block end.
To ensure that the endpoints of the optimal alignment fall on the N-and C-terminal of some blocks, Hi,j may be re-initialized to S(ai, bj) (replacing initialization to 0) if ai or bj is the first column in its respective block and traceback through Hi,j is required to terminate at that position.
Traceback may begin from the maximum Hi,j such that at least one of ai and bj is the end of its respective block.
These changes preserve the O(nm) running time.
The optimal scores from H are normalized into Z-scores as follows.Alarge set of random alignments was simulated using all curated domains, each aligned with 100 domains from different superfamilies.
Alignment scores were binned by the sum of lengths of the profiles.
Regression curves were fitted for the means and SDs over the bins.
The length-dependent values from the regressions were used to compute Z-score.
2.4 Scoring functions Much of the previous work on profileprofile alignment algorithms sought advances through new scoring functions for comparing profile columns.
Probabilistic methods are believed to be the most effective (Mittelman et al., 2003; von Ohsen et al., 2003) and are applied in state-of-the-art aligners such as prof_sim (Yona and Levitt, 2002), COMPASS and HHsearch.
CORAL uses a symmetrical log-odds function similar to Picasso (Heger and Holm, 2001) and COMPASS (Sadreyev and Grishin, 2003): SLO ( a,b )= k Qak log ( Rbk )+ k Qbk log ( Rak ) To compute similarity between aligned columns a and b, Qa and Qb represent vectors of weighted observed frequencies of amino acids k in the respective columns.
Likewise, R is the vector of the frequency ratios of weighted frequency for each amino acid over the background frequency of the amino acid.
Q and R are defined as for PSI-BLAST (Altschul et al., 1997; Schaffer et al., 2001).
Surveys of scoring functions (Edgar and Sjolander, 2004; Mittelman et al., 2003; Panchenko, 2003) have suggested that probabilistic methods offer incremental improvements over simpler functions such as sum of pairs (Gotoh, 1993), dot product and Pearson correlation coefficient.
Consequently, we also test the symmetrical dot product function: SDP ( a,b )=Qa Rb +Qb Ra In Section 3, the two methods will be denoted as CORAL LO and CORAL DP, respectively.
The public release of CORAL will use the better performing log-odds function.
2.5 Parameter optimization A local alignment requires that the expected column score be negative and some column score(s) be positive.
To satisfy these conditions, a constant shift value is added to each column score.
To initialize the search space for potential shift values, we computed the distributions of column scores for correctly aligned columns in all related domains in CDD and for all pairs of columns in a sampling of unrelated domains.
A second parameter, the gap penalty, is necessary to distinguish significant alignments.
Shift values between the means of each distribution and small gap weights were tested systematically over combinations of both parameters.
Performance was assessed for alignment accuracy and homolog sensitivity following the testing procedures and metrics described in Section 3.
Over the opt100 dataset, performance was fairly robust over a range of parameter values.
We assigned shift values of 0.15 and 6.6 for the two scoring functions, respectively, and gap weights of 0.1 and 0.5, respectively.
1863 [18:14 3/7/2009 Bioinformatics-btp334.tex] Page: 1864 18621868 J.H.Fong et al.2.6 Statistical significance To approximate the statistical significance of each alignment, we turn to the extreme value distribution (EVD) which has been shown empirically to fit optimal ungapped alignments of random sequences (Karlin and Altschul, 1990).
It is frequently used with gapped sequences and profile alignments.
Supposing that the alignment scores follow an EVD, the E-value for every alignment can be computed from the alignment score z and parameters and as E =e(z).
To determine and , normalized alignment scores from the random alignments described above were fitted to the cumulative density function,F(x) = exp(exp((x))).
Parameters were computed separately for each scoring function SLO and SDP.
The goodness of fit is illustrated for CORAL LO in Supplementary Figure S1.
3 RESULTS 3.1 Alignment accuracy The quality of CORAL alignments between CDD-curated domains was evaluated against the reference alignments described in Section 2 and compared with alignments from COMPASS 3.0, HHalign 1.5.1.1 and PSI-BLAST.
COMPASS is a high-performance implementation of the standard sum-of-scores optimal local alignment and its comparison with CORAL implies a lower bound in improvement that can be attributed to the core constraint.
COMPASS was run with default parameters and with reduced gap penalties.
To promote longer alignments, the gap open penalty was reduced arbitrarily default from 10 to 3 and the gap extension penalty default from 1 to 0.1.
HHalign was run in local and global modes using one domain alignment as query and the other as template.
To compute probabilities and E-values for HHalign, each HMM was calibrated against the cal.hhm database from the download site.
For every pair of domains, a PSI-BLAST alignment was computed between one domain and each sequence from the MSA of the other domain, and vice versa, using the NCBI Toolkit.
The sequence profile alignment with smallest E-value was used as the PSI-BLAST alignment.
CORAL and COMPASS held a speed advantage over the other methods, requiring than a 10th of a second for most inputs.
HHalign required 510 s, largely because of the calibration step.
The following metrics are used to evaluate alignment accuracy.
To measure extent of reconstructing a reference alignment, we compute Sdev, the ratio of the number of correctly aligned positions to the number of aligned columns in the reference alignment.
Sdev is the same as the developers score of (Sauder et al., 2000).
To measure correctness, we compute Smod, the ratio of the number of correctly aligned positions to the number of aligned columns in the evaluated alignment where at least one of each two aligned columns is present in the reference alignment.
This is analogous to the modelers score (Sauder et al., 2000), modified to include only the profile columns that can be determined to be correct or not.
The two previous measures are summarized through a balanced score, Sbalanced = (Sdev +Smod)/2.
To more directly illustrate the trade-off between alignment accuracy and alignment length, we estimate the latter as Scov, the number of aligned positions divided by the length of the shorter profile.
Results from multiple structure alignments for the same domain pair are averaged over the domain pair.
First, we analyze overall performance over CDD families and SCOP superfamilies, both referred to as families for brevity.
An average Sbalanced for every family is taken over its domain pairs (Fig.1).
CORAL produced high-quality alignments for more families than the other methods: 44% of domain families average Fig.1.
Distribution of balanced scores from three benchmark sets: (A) VAST structure superpositions; (B) SABmark structure alignments; and (C) curator-inferred guide alignments.
SABmark alignments are grouped by SCOP superfamily and the others by CDD family.
The balanced score is an average of accuracy over computed alignment and completeness in reconstructing the reference alignment.
Sbalanced 0.8 compared with 41% by the best non-CORAL method according to the VAST benchmark, 37% versus 28% according to the SABmark benchmark and 57% versus 45% by guide alignments.
In nearly all of these families, the alignments with Sbalanced 0.8 were both accurate and complete.
Under the three highest performing methods (CORAL LO, CORAL DP and HHalign global), over 96% of domain families with Sbalanced 0.8 had both Sdev 0.8 and Smod 0.8 with respect to all benchmark sets.
Comparison of Sbalanced over the domain pairs present in more than one benchmark set reveals high consistency among the reference alignments.
For pair-wise comparison of the reference sets, we identified domain pairs present in both benchmark sets.
Sbalanced scores for the common domain pairs, averaged over domain families, were 0.0260.032 lower according to the different 1864 [18:14 3/7/2009 Bioinformatics-btp334.tex] Page: 1865 18621868 CORAL alignment methods in VAST alignments than the corresponding guide alignments and 0.0320.047 lower in SABmark alignments than the corresponding guide alignments.
Approximately 2% of domain pairs had balanced score at least 0.01 higher by VAST structure alignments, 30% of domain pairs had balanced score 0.01 higher for guide alignments and the remaining two-thirds of domain pairs had negligible differences between those two
