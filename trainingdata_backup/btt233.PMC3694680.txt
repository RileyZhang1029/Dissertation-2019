          OP-CBIO130229 108..116 Vol.
29 ISMB/ECCB 2013, pages i108i116 BIOINFORMATICS doi:10.1093/bioinformatics/btt233 Genome-wide identification and predictive modeling of tissue-specific alternative polyadenylation Dina Hafez1,2, Ting Ni3,4, Sayan Mukherjee1,5,6, Jun Zhu3 and Uwe Ohler1,2,5,* 1Department of Computer Science, Duke University, Durham, NC, 27708, USA, 2Berlin Institute for Medical Systems Biology, Max Delbruck Center, 13125 Berlin, Germany, 3Genetics and Development Biology Center, National Heart, Lung and Blood Institute, National Institutes of Health, Bethesda, MD 20892, USA, 4State Key Laboratory of Genetics Engineering & MOE Key Laboratory of Contemporary Anthropology, School of Life Sciences, Fudan University, Shanghai, 200433, China, 5Institute for Genome Sciences & Policy, Duke University Medical Center, Durham, NC 27708, USA and 6Department of Statistical Science, Duke University, Durham, NC 27708, USA ABSTRACT Motivation: Pre-mRNA cleavage and polyadenylation are essential steps for 30-end maturation and subsequent stability and degradation of mRNAs.
This process is highly controlled by cis-regulatory elements surrounding the cleavage/polyadenylation sites (polyA sites), which are frequently constrained by sequence content and position.
More than 50% of human transcripts have multiple functional polyA sites, and the specific use of alternative polyA sites (APA) results in isoforms with variable 30-untranslated regions, thus potentially affecting gene regulation.
Elucidating the regulatory mechanisms underlying differential polyA preferences in multiple cell types has been hindered both by the lack of suitable data on the precise location of cleavage sites, as well as of appropriate tests for determining APAs with significant differences across multiple libraries.
Results: We applied a tailored paired-end RNA-seq protocol to specifically probe the position of polyA sites in three human adult tissue types.
We specified a linear-effects regression model to identify tissue-specific biases indicating regulated APA; the significance of differences between tissue types was assessed by an appropriately designed permutation test.
This combination allowed to identify highly specific subsets of APA events in the individual tissue types.
Predictive models successfully classified constitutive polyA sites from a biologically relevant background (auROC99.6%), as well as tissue-specific regulated sets from each other.
We found that the main cis-regulatory elements described for polyadenylation are a strong, and highly informative, hallmark for constitutive sites only.
Tissue-specific regulated sites were found to contain other regulatory motifs, with the canonical polyadenylation signal being nearly absent at brain-specific polyA sites.
Together, our results contribute to the understanding of the diversity of post-transcriptional gene regulation.
Availability: Raw data are deposited on SRA, accession numbers: brain SRX208132, kidney SRX208087 and liver SRX208134.
Processed datasets as well as model code are published on our website: Contact: uwe.ohler@duke.edu 1 INTRODUCTION Almost all eukaryotic mRNAs undergo a post-transcriptional processing step called polyadenylation, in which they acquire a polyA tail at their 30-end.
After transcription, the 30-most segment of the newly made RNA is cleaved off at specific sites (polyA sites) by a set of RNA regulatory proteins, which is followed by the synthesis of the polyA tail by the addition of adenine (A) residues in a non-templated fashion (Andreassi and Riccio, 2009).
Around 90 protein factors regulate this process, with CPSF (cleavage and polyadenylation specificity factor), CstF (cleavage simulator factor), CFI (cleavage factor I), CFII (cleavage factor II), PAP (polyA polymerase) and PABII (polyA binding protein) playing a crucial role (Beaudoing et al., 2000; Ji and Tian, 2009; Shi et al., 2009; Tian et al., 2005).
PolyA sites are essential for 30-end maturation, stability and degradation of mRNAs.
Furthermore, polyadenylation defines the extent of the 30-untranslated region (30-UTR) of mRNAs, which spans from the stop codon up to the polyA tail and contains many post-transcriptional regulatory sequence elements such as microRNA (miRNA) target sites.
In addition, alternative polyadenylation (APA) events arise from the presence of more than one particular functional cleavage/polyadenylation (polyA) site.
The specific use of different polyadenylation sites can play a direct role in gene regulation.
For instance, eliminating large parts of a 30-UTR by using the more proximal polyA site enables a transcript to escape from miRNA regulation of its longer isoform.
In proliferating cells, proximal polyA sites are therefore favored over distal ones, resulting in the production of mRNAs with shorter 30-UTR and fewer miRNA-binding motifs (Ji and Tian, 2009; Sandberg et al., 2008).
APA can influence mRNA nuclear export, cytoplasmic localization and non-miRNA mediated changes in mRNA stability and translational efficiency (Majoros and Ohler, 2007; Mayr and Bartel, 2009; Moore, 2005).
As such, it is important to identify not just alternative but specifically regulated alternative events, such as tissue-specific APA.
Based on earlier analysis of expressed sequence tags (ESTs), over 50% of the human and more than 30% of mouse genes were observed to have multiple polyadenylation sites, which results in mRNA isoforms different in their 30-UTR and/or coding sequences (Tian et al., 2005).
Initial studies on ESTs and tiling microarrays also indicated a bias in the regulation of polyA sites in certain human tissues (David et al., 2006; Tian et al., 2005; Zhang et al., 2005a).
The introduction of high-throughput sequencing technology has vastly expanded the opportunities to explore APA.
Recent deep sequencing of mRNA populations from multiple tissue types has shown that 86% of human genes exhibit variants due to APA sites (Wang et al., 2008).
In addition, several protocols relevant for studying polyadenylation have been developed.
*To whom correspondence should be addressed.
The Author 2013.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited.
For commercial re-use, please contact journals.permissions@oup.com These protocols are designed to capture the 30-end of mRNAs using specific primers, then sequence these fragments using second-and third-generation sequencing technologies (Jan et al., 2010; Mangone et al., 2010; Ozsolak et al., 2010; Shepard et al., 2011).
However, with one exception (Derti et al., 2012), these approaches have been applied on small samples or nonmammalian genomes, leaving human normal tissues unexplored.
A thorough analysis of the polyadenylation process in adult tissue types, showing differential gene expression, would help us understand tissue-specific APA regulation.
Although genomewide APA profiling enables us to discover genes with multiple polyA isoforms at a genome-wide scale, it introduces major challenges.
Without adequate methodology to specify the significance of APA biases in different tissues, we may confuse the mere presence of multiple APA with their specific up-or downregulation across conditions.
A clean definition of truly specific sets is necessary to investigate which features allow for successful discrimination via computational models, and to suggest candidate regulatory features for future studies.
In this article, we address several of these challenges by using data from a new RNA-seq protocol applied to sequence the 30-UTR end of mRNAs from different adult normal tissue types.
Using a linear model, we distinguish between constitutive, alternative and alternatively regulated polyadenylation sites.
Our linear regression model takes into account different library depth, expression of each gene in each tissue, as well as interactions between tissues and genes.
As is still the case with many deep sequencing datasets, we do not have multiple replicates at our disposition that can be used to identify significantly differing APAs across tissues.
Instead, significance of differences between samples from different tissue types is assessed by an appropriately designed permutation test.
We then use the flanking sequence region around polyA sites to build predictive models both for the discrimination of constitutive polyA sites from genomic background, as well as to distinguish between regulated APA sets from different tissues.
2 RESULTS 2.1 A paired-end sequencing strategy for identifying polyadenylation sites To precisely map polyA sites at genome-wide scale, we made use of several new libraries generated by a tailored sequencing approach, PA-seq.
This protocol yields paired-end tags, with one tag located directly at the cleavage site, and its pair mapping to a more upstream location, typically in the 30-UTR of the same transcript, Figure 1 (see Section 5).
We used PA-seq to monitor the differential usage of polyadenylation sites in three different human adult tissue types: brain, liver and kidney.
Each tissue was sequenced at varying depth.
We obtained 2.8 million raw paired reads from liver, 8 million from kidney and 3.5 million from brain.
Of those paired reads, 85% mapped to the human genome (hg19).
Non-redundant read pairs, i.e.those that showed differences in at least one of the paired end tags, were grouped for each unique 30 position, denoting a polyA site.
These sites were filtered to exclude 30 locations that mapped to genomic regions with high A content, to exclude possible contaminations by internal priming.
PA-seq reads were then clustered into clusters (PAS clusters) analogous to an algorithm previously developed for the analysis of capped 50 mRNA tags (Ni et al., 2010).
We used the total sum of the non-redundant read pairs of all of the 30 tags in each PAS cluster as a measure of the PAS usage, and considered PAS clusters covering narrow genomic regions and with five or more reads for all further analyses (see Section 5).
Table 1 summarizes the data for all libraries.
To differentiate between PAS clusters that are constitutively used versus those with more than one polyA site, we grouped all overlapping PASs of the same transcript from the three tissue types together.
Each PAS cluster was referred to by the mode of its median (see Section 5).
If the gene has one PAS cluster, we refer to it as a constitutive gene; if it has more than one PAS cluster, we refer to it as an alternatively polyadenylated gene.
Overall, we identified PAS clusters for 11 454 genes: around 7278 are constitutive and 4176 are alternative polyadenylated.
From genes that are expressed in the three tissue types, 2171 are constitutive genes and 1965 are alternative polyadenylated genes.
Alternative-polyadenylated genes had 5357 different PAS clusters; this is the set included in our analysis.
2.2 Characterization of tissue-specific regulated polyadenylation sites Previous research on APA has shown that most of human genes have multiple polyadenylation sites, with many of them being tissue-specific.
Testing the statistical significance of differential preferences for APA usage for a gene between tissues has been previously investigated by applying Fishers exact tests, chisquare tests or linear trend test (Beaudoing and Gautheret, 2001; Fu et al., 2011; Zhang et al., 2005a).
Applied on a gene with multiple PAS, measured across multiple conditions, Fishers test will detect a significant difference of the pattern from the null assumption, but further tests are needed to pinpoint exactly which PAS, in which tissue, deviates from constitutive expression.
A popular approach for identifying specific events across multiple tissues/sites has therefore been introduced based on Fig.1.
Summary of PA-Seq Protocol: Total mRNA is randomly fragmented and reversed transcribed with a modified oligo(dT) primer, which synthesizes with the polyA tail.
cDNA fragments are then captured and sequenced using multiplexed paired-end sequencing on Illumina i109 Modelling of tissue-specific alternative polyadenylation Shannon entropy (Schug et al., 2005).
Entropy values close to zero represent events specific to a single tissue; values increase as the relative usage spreads more across tissue types, or when the relative contribution of the tissue to the overall usage decreases.
However, entropy does not directly reflect significance, as samples with vastly different levels of evidence (e.g.read coverage) may lead to similar entropy values.
To avoid these shortcomings, we specified a linear effects regression model for the read counts of each PAS cluster in each tissue type, motivated by previous applications to detect significant changes in gene expression (Marioni et al., 2008) and alternative splicing patterns (Blekhman et al., 2010).
We controlled for fixed effects including different tissue depth, expression of each gene in each tissue, as well as any interaction between tissues and genes.
The resulting residual for a given PAS cluster in a given tissue reflects evidence that this PAS cluster is specific, and highly used, in the tissue.
We then needed to quantify whether for a given PAS cluster, an observed difference in read counts in a specific tissue is significant, i.e.more pronounced than what would be expected owing to random variation.
Given that the libraries were sequenced without experimental replicates, we applied permutation tests on the read counts of PASs for each gene in our libraries, to determine a tissue-specificity threshold (see Section 5).
With three libraries at our disposal, we separated tissue-specific PAS clusters into two groups: clusters that are highly used in one individual tissue (individual), and clusters that are highly used in two tissue types simultaneously (overlapping).
Figure 2a shows the test statistics for assessing the overlapping tissue-specificity applied to both original and permuted data.
By applying our linear model on alternative-polyadenylated genes, our strict selection led to 234 tissue-specific individual PAS clusters, and 214 tissue-specific clusters overlapping in two tissue types [at P50.01; false-discovery rate (FDR)50.25] (Fig.2b).
To study the biased usage of APA in different tissues, we calculated a variability index (VI) between each pair of tissues.
A low VI between two tissues indicates strong concordance in their usage of PAS clusters (see Section 5).
Confirming expectations, liver and kidney showed the highest correlation, while brain and kidney were the lowest.
To illustrate the difference of our model compared with previous approaches, we calculated the Shannon entropy for the subset of PAS clusters that showed significant tissue specificity for both the individual and overlap PAS, Figure 3a.
While the Shannon entropy is less than one for about 480 PAS clusters, our model identified only half of these as significantly tissue specific, with few additional PASs that had higher entropy.
This is mainly because Shannon entropy does not take the abundance of evidence into account.
For example, in Figure 3b, while the residual for the most proximal PAS site of the gene HDLBP (on negative strand) in brain indicates its outlier character, it is based on 17 tags (510% of the total) and thus not large enough to be significantly brain specific.
Additional data would be needed to confirm the specific trend.
In turn, our model characterized specific PAS clusters that would have been characterized as nonspecific due to higher entropy values.
As an example, Figure 3c shows two PAS clusters for the gene BDH1 (on negative strand).
The distal cluster is used in the three tissue types, while the proximal is used in kidney and brain only.
Using the linear model, the distal cluster was detected as significant in liver, given that the other cluster, the proximal one, shows higher usage in the other two tissues (more than 2-folds).
2.3 Modeling constitutive polyadenylation sites Because the PAPs responsible for synthesizing the polyA tail lack substrate specificity, it necessitates the presence of specific signals in the sequences around polyA sites that control mRNA polyadenylation (reviewed by Tian and Graber, 2012).
One of the known main cis-regulatory elements is a conserved hexamer with consensus AWUAAA, located 1035nt upstream of the polyA Table 1.
Summary of PA-seq generated data, filtering steps and clustering in each tissue library PA-seq reads and clustering Liver Kidney Brain Raw read pairs with identifiable linker sequences 2 851 978 8044 879 3 533 285 Read pairs mapped 2 449 567 7198 135 2 711 473 Non-redundant read pairs no priming 649 410 1353 072 1 320 265 Non-redundant read pairs 2 distinct 50 tags 545 708 1190 344 1 001 479 Different polyA sites 57 396 99 482 132 616 PAS clusters 8537 12 477 15 727 PAS clusters with NPa 7439 10 291 13 205 aNPNarrow Peak.
(a) (b) Fig.2.
(a) Test statistic for the residual of the original (red) and permuted data (blue) for calculating overlap-significant PAS sites.
(b) Number of tissue-specific PAS clusters found in each tissue: total individual sites: 234 (90 68 76), total overlap sites: 214 (31 100 83) i110 D.Hafez et al.site, referred to as polyadenylation signal (Beaudoing et al., 2000).
The sequence composition at the cleavage site itself is not well characterized, but a dinucleotide preference CA was found in vitro (Chen et al., 1995).
The sequence around polyA sites are usually G/U-rich with a remarkable downstream element (DSE), located within 30 nt downstream of the cleavage site.
Upstream of polyA sites are upstream elements (USE) that are usually also U-rich, while some G-rich sequences have been reported as well.
These elements are largely located in the region (100,100) nt around polyA sites (Tian and Graber, 2012).
Most early attempts for the computational prediction of polyA sites considered only samples containing the canonical PAS signal.
Position weight matrices (PWM) for DSE and USE along with the PAS signal were used as input features for hidden Markov model (HMM) or support vector machines (SVM) (Hajarnavis et al., 2004; Legendre and Gautheret, 2003; Liu et al., 2003; Salamov and Solovyev, 1997; Tabaska and Zhang, 1999).
After the characterization of 15 putative regulatory elements surrounding PAS signals (Hu et al., 2005), position-specific scoring matrices for the identified motifs and structural patterns of mRNA, have been later used as input features (Ahmed et al., 2009; Akhtar et al., 2010; Chang et al., 2011; Cheng et al., 2006; Shao et al., 2009).
Most recently, the application of artificial neural network and random forests techniques have been proposed (Kalkatawi et al., 2012).
These models were largely trained on low-abundance pooled EST data from varying human tissues; none of them examined tissues independently.
While the use of curated quality controlled data from collections such as PolyA_DB (Zhang et al., 2005b) made it possible to design models with high accuracy, studies typically restricted their dataset to only include transcripts with PAS signals and results were sometimes hard to interpret owing to negative data not matched to the problem faced by the RNA processing machinery (such as using random genomic locations).
Modeling constitutive and/or APA sites specifically has so far rarely been investigated.
The exact motifs responsible for APA are frequently still unknown, especially when it comes to tissueregulated APA.
Calculating PWM scores as features of classifiers, as in the case of constitutive sites with known motifs, will likely not reflect all of the regulatory elements.
It is thus more applicable to use a sparse sequence-based classifier that uses a broad definition of the feature space.
String kernels transform the input sequences into a higher-dimensional feature space, effectively looking for similarities among substrings, and have been proven to be successful in the prediction of alternative splicing and transcription start sites (Sonnenburg et al., 2006, 2007).
Here, we build an SVM, using all of the information available in the sequences flanking the polyA sites, by applying two string kernels, the spectrum kernel (Leslie et al., 2002) and the weighted degree kernel with shifts (WD) (shogun toolbox; version 2.0.0) (Ratsch et al., 2005).
While the spectrum kernel highlights the global similarities between sequences as it counts the number of occurrences of similar motifs, the WD kernel counts the number of matching substrings of similar lengths at the same position but allowed to be shifted within a specified window size around that position.
To investigate whether local sequence features around polyA sites are sufficient to explain polyadenylation, we first examined whether PAS clusters for constitutive genes could be classified from non-polyA sites.
We focused on (100,100) nt around polyA sites, given that the known constitutive elements are located in this region, and that it has additionally been shown to exhibit a biased nucleotide composition (Legendre and Gautheret, 2003; Tian et al., 2005).
As the polyadenylation machinery scans transcribed sequences for cleavage locations, it is not appropriate to use random genomic locations as negative set.
Within transcripts, the highly distinct higher order nucleotide composition in coding sequences renders them inappropriate.
Fig.3.
(a) Histogram of Shannon entropy Q-values for all PAS clusters (range from 0 to 9).
Red bars represent entropy values for individual-significant PAS detected by our model, blue bars represent overlap-significant PAS.
Individual sites cluster at 02 entropy, and overlap sites cluster at the upper end of the range.
(b) Example showing that Shannon entropy does not take the abundance of the evidence into account for calling sites significant.
The usage (count) of each PAS cluster is marked in each tissue, followed by the entropy values then the test statistics resulted from our linear model.
Tissue specificity is determined by low entropy values but high test statistics above a certain threshold.
The proximal site in brain (17 tags; 510% of total) is classified as specific (entropy 0.46).
However, this relatively low tag number compared with the overall expression of the gene and the total library depth is not enough to call this site brain-specific.
Entropy values for this proximal site in liver and kidney represent pseudo-counts (not shown in figure).
(c) Example of a specific PAS cluster detected by our linear model and not by Shannon entropy (BDH1 gene on negative strand).
The distal site (65 tags) is the only PAS site for this gene used in liver.
Given the relatively low expression level of the gene and the liver-low library depth compared with brain and kidney, this site is classified as significant (test statistic of our model is marked by red circle).
Shannon entropy values do not reflect this relative usage i111 Modelling of tissue-specific alternative polyadenylation Instead, we built a biologically motivated and challenging negative dataset: for each PAS, we randomly selected 10 positions in the 30-UTR sequence between the transcript stop codon and the PAS, but not including the last 100 nucleotides.
We retrieved the flanking (100,100) regions around these positions to create our negative dataset.
In total, we extracted 2171 positive examples, and 21 710 negative examples.
Because we needed to set multiple hyper-parameters for the SVM and kernels, like order, shift and the classification penalty, we randomly split our dataset into 20% for model selection and 80% for (independent) training and testing (see Section 5).
We applied 5-fold cross validation.
The classifier performance using the two string kernels is shown in Figure 4a and b.
Calculation of the area under the receiver operating characteristic curve (auROC) showed that the WD kernel substantially outperformed the baseline spectrum kernel (auROC 99.6, 93.5%).
We applied WD on varying window sizes around PAS clusters and found that the high performance largely resulted from features in the flanking region of (40,40).
Our model parameters indicate that most of these motifs are less than 8-mers long, and shifted within 12nt, which coincides with the findings of (Zhang et al., 2005a).
This suggests that motifs around constitutive polyA sites are highly conserved in both sequence and location, and that the WD kernel is powerful enough to capture this phenomenon with near perfect accuracy.
To illustrate the PAS sequence landscape, we created sequence logos for the flanking regions, which visually showed that the conserved motifs were found in the region (30,30) nt, WebLogo (Crooks et al., 2004), Figure 4c.
The polyadenylation signal and DSE were clearly observed, and the cleavage site itself exhibited a strong BA dinucleotide bias (BC, G or T), in agreement with the previously reported CA dinucleotide.
2.4 Prediction of tissue-specific polyadenylation sites The presence of conserved motifs for constitutive polyA sites suggests the presence of other motifs that instruct the cell to start the polyadenylation process around APA sites in a condition-specific manner.
To investigate this, we first merged all individual-tissueregulated and the two-tissueoverlap PAS clusters and classified them against the positive constitutive dataset (Fig.5a).
The moderate but highly encouraging performance of the classifier on the individual-regulated and the overlap-regulated datasets (auROC 74.5 and 66.5%, respectively) support this hypothesis.
We then classified each of the individual tissuespecific PAS clusters against constitutive PASs (Fig.5b).
Brainindividual PAS clusters were highly distinguishable from constitutive PASs (auROC 81.5%), while kidney-individual and liver-individual regulated PASs were classified at lower but reasonable levels (auROC 72, 63.5%, respectively).
An inspection of the sequence logos of each group explained this performance (Fig.6).
We found an A-rich sequence just downstream of brainindividual regulated PAS clusters that is not present in the constitutive subset and other tissue-specific sets.
Moreover, while the canonical PAS signal is still found in liver-individual clusters, making them harder to be classified from constitutive clusters, it is completely absent in brain-individual regulated clusters.
Finally, we trained models to compare each of the individualregulated clusters in one tissue against all regulated clusters in the other two tissue types (both individual and overlap, Fig.5c).
In agreement with the motifs found at brain-specific individual PAS clusters, classification of brain-specific individual regulated PASs showed the best performance (auROC 71%).
3 DISCUSSION APA is a regulatory process with major impact on the downstream post-transcriptional fate of affected transcripts, yet it has been fairly sparsely investigated.
Recently, several studies have analyzed data resulting from new high-throughput sequencing protocols, and some studies reported on differential p
