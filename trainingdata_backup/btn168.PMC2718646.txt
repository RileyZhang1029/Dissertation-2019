            [20:32 18/6/03 Bioinformatics-btn168.tex] Page: i214 i214i222 BIOINFORMATICS Vol.
24 ISMB 2008, pages i214i222doi:10.1093/bioinformatics/btn168 A computational framework to empower probabilistic protein design Menachem Fromer and Chen Yanover School of Computer Science and Engineering, The Hebrew University of Jerusalem, Israel ABSTRACT Motivation: The task of engineering a protein to perform a target biological function is known as protein design.
A commonly used paradigm casts this functional design problem as a structural one, assuming a fixed backbone.
In probabilistic protein design, positional amino acid probabilities are used to create a random library of sequences to be simultaneously screened for biological activity.
Clearly, certain choices of probability distributions will be more successful in yielding functional sequences.
However, since the number of sequences is exponential in protein length, computational optimization of the distribution is difficult.
Results: In this paper, we develop a computational framework for probabilistic protein design following the structural paradigm.
We formulate the distribution of sequences for a structure using the Boltzmann distribution over their free energies.
The corresponding probabilistic graphical model is constructed, and we apply belief propagation (BP) to calculate marginal amino acid probabilities.
We test this method on a large structural dataset and demonstrate the superiority of BP over previous methods.
Nevertheless, since the results obtained by BP are far from optimal, we thoroughly assess the paradigm using high-quality experimental data.
We demonstrate that, for small scale sub-problems, BP attains identical results to those produced by exact inference on the paradigmatic model.
However, quantitative analysis shows that the distributions predicted significantly differ from the experimental data.
These findings, along with the excellent performance we observed using BP on the smaller problems, suggest potential shortcomings of the paradigm.
We conclude with a discussion of how it may be improved in the future.
Contact: fromer@cs.huji.ac.il 1 INTRODUCTION The engineering objective of creating a protein to perform a target biological function is known as protein design.
Since the pursuit of a protein with a specific function without additional constraints is perceived as overly difficult, the function-design problem is usually restricted to the search for an amino acid sequence that assumes a target 3D structure (Kuhlman et al., 2003; Park et al., 2004), assuming that this structure will entail a specific function.
The potential applications of such design are diverse and numerous (for a recent review, see Rosenberg and Goldblum, 2006).
Specific objectives include the modest ambition of slight modifications of existing proteins to affect such characteristics as stability or binding affinity (Shifman and Mayo, 2002).
A loftier goal is to design To whom correspondence should be addressed.
Present address: Computational Biology Program, Fred Hutchinson Cancer Research Center, Seattle, WA.
protein sequences that will assume novel structures (Kuhlman et al., 2003) or acquire new functionalities.
Such functionalities may be therapeutic (e.g.Bewley et al., 2002, where an HIV inhibitor protein was designed, or Lazar et al., 2003) or industrial (e.g.Arnold, 2001, which discusses the design of biocatalysts).
Furthermore, the success (or failure) of such protein design experiments will aid us in the validation of our understanding of the physics of protein stability and structure.
Most recent work on structural protein design adopts a paradigmatic representation of a protein as a fixed backbone structure.
Also, the amino acid side chain conformations are not permitted to move continuously in space; rather, the allowed conformations consist of a library of discrete, energetically favorable empirical observations [termed rotamers (Dunbrack and Karplus, 1993)].
The two former assumptions artificially limit the spatial degrees of freedom of the protein structure but are adopted for computational tractability.
Additionally, pairwise atomic energy terms are used to confer pseudo-physical energetic values to pairs of atoms (Gordon et al., 1999).
These energies are employed in scoring individual sequences, either through per-sequence consideration of the minimal-energy rotamer conformation (as in Shifman and Mayo, 2002) or of the rotamer-based free energy partition function (Kamisetty et al., 2007; Lilien et al., 2005).
It should also be noted that there exists a line of work that attempts to overcome the use of a fixed backbone by iterating between cycles of fixed backbone design and backbone improvements, e.g.Kuhlman et al.(2003).
Ultimately, the results of computational methods for this task must be experimentally verified in the wet lab.
This typically leads to cycles of computational prediction of top-scoring sequences, synthesis of these sequences and biological characterization, and fine-tuning of the computational methods and inputs based on these empirical results (Kuhlman et al., 2003).
However, this strategy only permits the biophysical screening of relatively few sequences (conceivably, hundreds at the most).
Computational design of a small set of candidate sequences has been termed directed protein design (Park et al., 2005).
1.1 Probabilistic protein design On the other hand, recent revolutionary advances in molecular biology have provided scientists with combinatorial sequencescreening techniques, such as phage display (Pal et al., 2006), which can produce 1091010 randomized protein sequences that are then simultaneously tested for relevant biological function.
This randomized synthesis and screening process is schematically illustrated in Fig.1.
This technology has lead to an alternative protein design protocol, designated probabilistic protein design (Park et al., 2005), which incorporates powerful computational tools 2008 The Author(s) This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
file:fromer@cs.huji.ac.il [20:32 18/6/03 Bioinformatics-btn168.tex] Page: i215 i214i222 Probabilistic protein design Fig.1.
The principle of combinatorial sequence screening is depicted for a protein of length 4, where amino acid types are represented by green, yellow, blue and red.
The wild-type (WT) protein is mutated at its leftmost and rightmost positions, according to position-specific probabilities, yielding random proteins to be screened through a selection assay; dashed boxes indicate mutations from WT.
In this scenario, four of the seven random protein sequences were positively selected.
into large-scale biological screening of candidate protein sequences.
Overall, it involves two steps: (i) Computational prediction of amino acid probabilities at each position for the given design problem (considering all other possible amino acid sequences at other positions).
(ii) Use of these predicted probabilities to bias the synthesis of random gene sequence libraries, which can be experimentally selected for relevant biological function (Hecht et al., 2004; Kono and Saven, 2001; Park et al., 2005).
Despite the ability of the aforementioned experimental methods to screen billions of sequences, the computational aspect remains of utmost importance, since many relevant design problems involve tens of positions where all 20 amino acids could potentially be placed, exceeding the biological screening capability by many orders of magnitude.
The goal of this two-step technique is that the computationally predicted positional probabilities will significantly enrich the randomized sequences with those that are highly likely to possess the target biological characteristics and thus pass the screening stage, resulting in much higher success rates.
Nevertheless, we emphasize that the predicted probabilities are only intended to bias the sequence space towards optimality, but do not guarantee the exclusive synthesis of lowenergy sequences; this derives from the use of site-specific amino acid probabilities, independently employed for the various design positions.
Computational methods for calculation of positional amino acid probabilities based on structural information have been developed in the context of both directed protein design (Calhoun et al., 2003; Delarue and Koehl, 1997) (where they were intended to build highly probable sequences) and probabilistic protein design (Biswas et al., 2005; Kono and Saven, 2001; Park et al., 2005; Voigt et al., 2001; Yang and Saven, 2005).
These methods include the use of mean field (Delarue and Koehl, 1997; Voigt et al., 2001), Monte Carlo sampling techniques (Yang and Saven, 2005), and Lagrangian optimization based on simplifying approximations (Biswas et al., 2005; Calhoun et al., 2003; Kono and Saven, 2001; Park et al., 2005).
Overall, these approaches have been met with some success (e.g.Park et al., 2006), depending on the criterion utilized to assess performance.
In this paper, we describe a novel formulation for modeling the probabilistic design problem, following the structural design paradigm and the corresponding assumptions described above.
Furthermore, we apply an innovative technique for efficient and accurate calculation of the marginal amino acid probabilities.
We show that our novel method obtains quicker and more accurate results than those derived from previously applied approaches, as compared with exact results on the paradigmatic model.
On the other hand, quantitative analysis of the results obtained by this model, as compared to evolutionary and experimental results, indicates inherent deficiencies in the modeling of the probabilistic protein space by this widely used paradigm.
2 PROBABILISTIC PROTEIN DESIGN: THEORY AND EFFICIENT MODELING The input to the protein design problem consists of a spatial structure, N positions to be designed, and the amino acids (and their respective rotamers) permitted at each position.
We denote by r= (r1,...,rN ) an assignment of rotamers for all positions.
For a given energy function, the energy of assignment r, E (r), is the sum of interaction energies between a rotamer ri at position i and the fixed template (Ei (ri)), and pairwise interaction energies between rotamers ri and rj for neighboring positions i,j (Eij(ri,rj)).
We define T (k) as the amino acid type of rotamer k and let T (r1,...,rN )= (T (r1),...,T (rN )).
Let S= (S1,...,SN ) denote an assignment of amino acids for all positions.
2.1 Sequence probability space Consider the Helmholtz free energy of a specific amino acid sequence S at system temperature T , as defined in Yedidia et al.(2005): F(S,T )=T lnZ(S,T ) (1) where Z(S,T )= r:T (r)=S e E(r) T (2) is the per-sequence partition function for sequence S (Lilien et al., 2005) at system temperature T. Since free energy is the operative value in measuring the thermodynamic compatibility of various sequences with the structure, and conceptually following Meyerguz et al.(2004) in assuming the applicability of Boltzmanns law over the sequence space, we define the probability of a given sequence S at system temperature T as: Pr(S)e F(S,T )T Z(S,T ) (3) It is easy to see that the normalization factor for Pr(S) is Z(T )= r e E(r) T (4) thus yielding: Pr(S)= 1 Z(T ) Z(S,T ) (5) i215 [20:32 18/6/03 Bioinformatics-btn168.tex] Page: i216 i214i222 M.Fromer and C.Yanover Boltzmanns law has been shown to describe physical systems in thermal equilibrium at a given temperature level (Huang, 1987; Yedidia et al., 2005).
Since we are dealing with an energetic system where the states and energies are sequence assignments and their free energies, respectively, Equations 35 are applicable.
In essence, this perspective regards the system of all sequences as competing among themselves to be chosen during the stage of experimental (or possibly evolutionary, e.g.Meyerguz et al., 2004) selection.
2.2 Rotamer probability space We wish to follow Equation 5 but would like to work directly with the rotamers of all sequences simultaneously.
Therefore, we consider a probability space over all rotamer assignments for all sequences, where the probability of rotamer assignment r, at system temperature T , is defined as: Pr(r)= 1 Z(T ) e E(r) T (6) where Z(T ), the rotamer space partition function, is as defined in Equation 4.
We note that Equation 6 follows Boltzmanns law over the rotamer space and, more significantly, substitution into the intuitive definition for sequence probability: Pr(S)= r:T (r)=S Pr(r) (7) directly yields Equation 5.
Now, by definition, the marginal amino acid probabilities at position i are given by: Pr(Si)= S\Si Pr(S) (8) However, due to Equation 7, this result could equivalently be generated if Pr(Si) were directly defined as: Pr(Si)= ri:T (ri)=Si Pr(ri) (9) where Pr(ri)= r\ri Pr(r) is the marginal probability of rotamer ri at position i.
Note that, in fact, Equation 9 was used as the definition for amino acid probabilities in previous work (Biswas et al., 2005; Kono and Saven, 2001; Park et al., 2005; Voigt et al., 2001; Yang and Saven, 2005).
In contrast to the theory developed above, however, no explicit definition of the probability space over the sequences or justification for such amino acid probabilities was given.
At this point, we find it pertinent to emphasize that although our model accounts for the per-sequence free energy partition function (Lilien et al., 2005) in defining the probability for a particular sequence (Equation 5), these values are never actually calculated for any individual sequences.
Rather, these per-sequence free energies form the theoretical basis of the site-specific amino acid probabilities (Equation 8), but we do not actually resort to the exponential summation of sequence probabilities (see below).
2.3 Protein design using probabilistic graphical models With a clearly delineated model for positional amino acid probabilities in hand, we now present our novel approach.
A probabilistic graphical model (Lauritzen, 1996) is built to represent this probabilistic protein design problem, where each designed position is a variable in the model, and its values correspond to the allowed rotamers (for all permitted amino acids) at that position.
The exponentiated rotamer-backbone energies are the local potentials in the model: i(ri)=e Ei (ri ) T and the rotamer-rotamer energies define the pairwise potentials: ij(ri,rj)=e Eij (ri ,rj ) T Since the size of the rotamer space is exponential in protein length, the calculation of exact probabilities (Equation 8) using this graphical model is computationally infeasible for large proteins.
Therefore, an approximate inference method is required.
Herein, we apply sumproduct loopy belief propagation (Pearl, 1988), to which we simply refer as BP.
Thus, belief messages of the form: mij(rj)= ri e Ei (ri )Eij (ri ,rj )T kN(i)\j mki(ri)  are passed from position i to position j, where the contents of mij indicate the relative likelihood of each rotameric state at position j.
Note that N(i) denotes the set of variables neighboring variable i.
After convergence of BP, the resulting marginal rotamer probabilities are defined as (after normalization): Pr(ri)=e Ei (ri ) T kN(i) mki(ri) These rotamer beliefs at each position (which account for all possible sequences at all other designed positions) are then marginalized per amino acid to obtain the per-position amino acid probabilities for the design problem, as described in Equation 9.
We note that the method described here puts to use, and thus assesses, the actual values of the sumproduct marginals derived through loopy BP on a graphical model built to describe a protein structure (and all of its possible sequences), and is thus conceptually similar to the method utilized by Moore and Maranas (2003), to predict residueresidue clashes in protein hybrids.
On the other hand, most previous related methods seek the minimal-energy assignments (using max-product BP) (Yanover and Weiss, 2003; Yanover et al., 2006) or utilize the sumproduct beliefs (Kamisetty et al., 2007) or pruning methods (Lilien et al., 2005) to approximate the free energy for a single protein sequence.
3 METHODS 3.1 Test cases and benchmark probabilities PDB dataset and evolutionary data Protein structures were culled from the PDB database (Berman et al., 2000) in the following manner: experimental X-ray structures containing a single protein chain of length 3070 amino acids, with a minimal resolution of 2 were considered, where a cut-off level of 30% sequence identity was applied to remove homologues.
For these cases, the ground truth probabilities were taken to be those derived for the PDB structures from evolutionary data by the HSSP (Homologyderived Secondary Structure of Proteins) database (Dodge et al., 1998).
We further required that the HSSP entry for the protein structure contain a minimum of 10 alignments; the final set of 29 structures is listed in Table 1.
For each of these structures, all positions were designed using the pairwise atomic energy function of the Rosetta design package (Kuhlman and Baker, 2000) with default parameters and the backbone-dependent rotamer library of Dunbrack and Karplus (1993).
The energy function includes terms for the 12-6 Lennard-Jones potential, implicit interaction i216 [20:32 18/6/03 Bioinformatics-btn168.tex] Page: i217 i214i222 Probabilistic protein design Table 1.
Dataset of 29 proteins from the PDB database, for which full sequence probabilistic design was computationally performed.
Representative structures for each structural class are taken from (Berman et al., 2000).
PDB Classification Length Alignsa Classb 1AIE P53 Tetramerization 31 63 all alpha 1WY3 Structural Protein 35 104 all alpha 1KFN Membrane Protein 53 35 all alpha 2CMP Terminase 56 88 all alpha 1DF4 Viral Protein 57 2868 all alpha 1NKD Transcription Regulation 59 34 all alpha 1L2P Hydrolase 61 165 all alpha 1KU3 Transcription 61 1496 all alpha 1R69 Gene Regulating Protein 63 371 all alpha 2OCH Chaperone 66 1500 all alpha 2G7O DNA Binding Protein 68 19 all alpha 1UTG Steroid Binding 70 15 all alpha 1A8O Viral Protein 70 1500 all alpha 1AIL RNA-binding Protein 70 1500 all alpha all alpha 2GQV Oxidoreductase 59 18 all beta 1MHN RNA Binding Protein 59 74 all beta 1TG0 Contractile Protein 66 122 all beta all beta 1WKX Allergen 43 345 (a+b) 1EJG Plant Protein 46 42 (a+b) 2ERW Blood Clotting, Hydrolase Inhibitor 53 314 (a+b) 1YP5 Contractile Protein 58 115 (a+b) 4PTI Proteinase Inhibitor (Trypsin) 58 394 (a+b) 1ZLM Signaling Protein 58 1209 (a+b) 2FJZ Metal Binding Protein 59 91 (a+b) 2PST Unknown Function 61 178 (a+b) 1UCS Antifreeze Protein 64 52 (a+b) 1YPC Proteinase Inhibitor (Chymotrypsin) 64 109 (a+b) 1AHO Neurotoxin 64 207 (a+b) 2FHT Chemokine 68 180 (a+b) (a+b) aNumber of HSSP alignments from which the evolutionary probabilities were derived.
bStructural class, as defined by the SCOP or CATH databases (as available).
with the solvent, electrostatics, a hydrogen-bonding potential, backbone dependent internal free energies of rotamers, and amino acid reference energies (wref ).
Human growth hormone As an in-depth case study, we further considered the structure of the human growth hormone (hGH) complexed with the extracellular domain of its receptor (hGHR), PDB code 3HHR.
For this case, 35 positions of hGH (Fig.4), which lie on the interface with hGHR were designed under a variety of scenarios (see Experiments).
We attempted to recover the experimentally derived positional probabilities detailed in Pal et al.As above, the Rosetta energy function was employed with default parameters, except where otherwise noted.
For this case, we arbitrarily added pseudo-counts of 0.5 to the raw experimental data from Pal et al.in order to compensate for sample bias (unobserved amino acids).
Since Rosetta does not fully support the design of the amino acid cysteine, all
