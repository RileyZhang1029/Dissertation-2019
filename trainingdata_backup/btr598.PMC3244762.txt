            K:\bioinformatics\Bioinfo-28(1)issue\btr598.dvi [16:29 8/12/2011 Bioinformatics-btr598.tex] Page: 17 1724 BIOINFORMATICS ORIGINAL PAPER Vol.
28 no.
1 2012, pages 1724doi:10.1093/bioinformatics/btr598 Sequence analysis Advance Access publication November 3, 2011 deepBlockAlign: a tool for aligning RNA-seq profiles of read block patterns David Langenberger1,2,, Sachin Pundhir3,4,, Claus T. Ekstrm5, Peter F. Stadler1,2,3,6,7,8,9, Steve Hoffmann1,2 and Jan Gorodkin3,4, 1Bioinformatics Group, Department of Computer Science, Interdisciplinary Center for Bioinformatics, 2Transcriptome Bioinformatics group, LIFE-Leipzig Research Center for Civilization Diseases, Universitt Leipzig, Philipp-Rosenthal-Strasse 27, D-04107 Leipzig, Germany, 3Center for non-coding RNA in Technology and Health, Department of Basic Animal and Veterinary Sciences, University of Copenhagen, 1870 Frederiksberg C, Denmark, 4Center for Applied Bioinformatics, Department of Basic Animal and Veterinary Sciences, University of Copenhagen, 1870 Frederiksberg C, Denmark, 5Center for Applied Bioinformatics, Department of Basic Sciences and Environment, University of Copenhagen, 1871 Frederiksberg C, Denmark, 6Max Planck Institute for Mathematics in the Sciences, Inselstrae 22, 7RNomics Group, Fraunhofer Institut for Cell Therapy and Immunology, Perlickstrae 1, D-04103 Leipzig, Germany, 8Institute for Theoretical Chemistry, University of Vienna, Whringerstrae 17, A-1090 Vienna, Austria and 9The Santa Fe Institute, 1399 Hyde Park Rd., Santa Fe, NM, USA Associate Editor: Ivo Hofacker ABSTRACT Motivation: High-throughput sequencing methods allow whole transcriptomes to be sequenced fast and cost-effectively.
Short RNA sequencing provides not only quantitative expression data but also an opportunity to identify novel coding and non-coding RNAs.
Many long transcripts undergo post-transcriptional processing that generates short RNA sequence fragments.
Mapped back to a reference genome, they form distinctive patterns that convey information on both the structure of the parent transcript and the modalities of its processing.
The miR-miR* pattern from microRNA precursors is the best-known, but by no means singular, example.
Results: deepBlockAlign introduces a two-step approach to align RNA-seq read patterns with the aim of quickly identifying RNAs that share similar processing footprints.
Overlapping mapped reads are first merged to blocks and then closely spaced blocks are combined to block groups, each representing a locus of expression.
In order to compare block groups, the constituent blocks are first compared using a modified sequence alignment algorithm to determine similarity scores for pairs of blocks.
In the second stage, block patterns are compared by means of a modified Sankoff algorithm that takes both block similarities and similarities of pattern of distances within the block groups into account.
Hierarchical clustering of block groups clearly separates most miRNA and tRNA, and also identifies about a dozen tRNAs clustering together with miRNA.
Most of these putative Dicer-processed tRNAs, including eight cases reported to generate products with miRNA-like features in literature, exhibit read blocks distinguished by precise start position of reads.
Availability: The program deepBlockAlign is available as source code from http://rth.dk/resources/dba/.
Contact: gorodkin@rth.dk; studla@bioinf.uni-leipzig.de To whom correspondence should be addressed.
The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.
Supplementary information: Supplementary data are available at Bioinformatics online.
Received on July 16, 2011; revised on October 21, 2011; accepted on October 25, 2011 1 INTRODUCTION Recent development in high-throughput sequencing (HTS) technologies have made the demand for efficient algorithms for data processing more urgent than ever.
Ironically, while the sequencing costs decrease, the analysis costs increase and consume the bigger part of sequencing projects.
Contributing to the demand is the novel possibilities which emerge with these data.
Questions that need to be addressed range from expression analysis to the reconstruction of transcript structures and the recognition of particular classes of coding and non-coding transcripts.
In most settings, a reference genome is available and analysis protocols start with mapping the sequencing reads to that template genome (Hoffmann et al., 2009; Langmead et al., 2009; Trapnell et al., 2009).
Here, we focus in particular on the type of RNA sequencing data that is commonly produced in studies focusing on microRNAs.Aseries of publications reported that microRNA-sized small RNAs are commonly produced not only from microRNA precursors, but also from most other classes of structured RNAs (Kawaji et al., 2008; Taft et al., 2009).
These small RNAs are often, but not always, produced by Dicer (Brameier et al., 2011; Burroughs et al., 2011; Cole et al., 2009; Haussecker et al., 2010; Lee et al., 2009).
Several alternative, Dicer-independent pathways that lead to similar small RNAs with microRNA-like functions have been characterized, see Miyoshi et al.(2010) for a recent review.
The apparent diversity of processing pathways bears the question to what extent the read patterns in RNA-seq datasets contain information on the processing of particular RNAs.
Well-understood examples include the characteristic mutual positioning with a 3-overhang of miR and miR* products that is characteristic The Author(s) 2011.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
[16:29 8/12/2011 Bioinformatics-btr598.tex] Page: 18 1724 D.Langenberger et al.for Dicer cleavage, see e.g.Gan et al.(2008), the anomalous 5-overhang observed for some microRNAs resulting from a distinct, Dicer-dependent two-step mechanism (Ando et al., 2011), and the Dicer-independent processing of mir-451 (Cifuentes et al., 2010).
Therefore, we ask whether it is possible in general to develop finger prints for distinct pathways.
Several recent studies recognized that structured ncRNAs such as tRNAs and snoRNAs give rise to characteristic patterns of read coverage that in many cases are dominated by distinctive clusters of reads with similar start and/or stop position.
These clusters are referred to as blocks.
In the case of tRNAs, the patterns are influenced in particular by chemical modifications (Findei et al., 2011), while in other cases secondary structures play a major role (Langenberger et al., 2010).As a consequence, these patterns convey information about the parent RNAs.
Machine learning algorithms have been trained on the combination of relative expression and distances between read blocks to distinguish major ncRNAs classes such as pre-microRNAs, box C/D and box H/ACA snoRNAs, and tRNAs (Langenberger et al., 2010).
Similarly, Jung et al.(2010) showed that ncRNA classes can also be distinguished by comparing accumulations of reads, i.e.by number of reads and the size of the clusters of overlapping reads.
The ALPS scores (Erhard and Zimmer, 2010), which are based on the relative position and the read lengths only, are also capable of discriminating between major types of ncRNAs.
Finally, short read patterns in combination with predicted secondary structures and sequence conservation have been used to identify genomic loci with high potential to encode for ncRNAs (Lu et al., 2011).
The latter work suggests that even further data, such as high-throughput RNA structure probing experiments (Underwood et al., 2010), could be used together with short read block patterns to complement computational methods for ncRNA gene finding [reviewed by Gorodkin and Hofacker (2011); Gorodkin et al.(2010)].
Beyond the primary goal of distinguishing different ncRNAs, it is of particular interest to identify common patterns on different transcripts.
Establishing methods for pairwise comparison and subsequent clustering is an important step toward this goal.
This allows us to find common patterns for the same class of RNAs, to the detection of putative novel classes of RNAs, and to commonalities among different ncRNAs that share (parts of) processing pathways.
The ability to compare read patterns, both at the level of individual read blocks and at the level of block groups independent of sequence and secondary structure data is a necessary prerequisite to disentangle the different influences.
Here, we develop the necessary algorithms and provide the deepBlockAlign software package that implements these tools for practical use.
2 MATERIALS AND METHODS The starting point for deepBlockAlign is a collection of reads mapped to a (reference) genome.
Clusters of overlapping reads are decomposed into blocks of reads with similar start and stop positions using blockbuster (Langenberger et al., 2009).
Both the length and the coverage profile can vary substantially between blocks.
In the following, we introduce an entropy-like measure for the coherence of read blocks.
Overlapping and closely spaced blocks of reads form a block group or locus.
Our aim is to compare these block groups based on the relative expression of blocks, the distance between blocks and the shapes of the blocks themselves.
deepBlockAlign proceeds in two stages.
First, an alignment algorithm is employed to compare the coverage profiles of individual blocks, thus Table 1.
The HTS dataset used in this study along with possible ID from GEO, the number of reads and number of block groups Dataset GEO ID No.
of reads No.
of block groupsa All Expression filter Human_ebb 7 351 304 1136 455 Human_hescc 7 836 912 1386 585 Human_34d GSM450598 7 299 034 1103 377 Human_98e GSM450608 8 371 772 1109 425 Human_14f GSM450605 8 538 940 1614 686 Monkey_9g GSM450615 10 698 419 1738 478 The expression filter requires a block group to have at least two blocks with a minimum of 50 reads.
Furthermore, block groups >200 nt or <50 nt are excluded.
aBlock groups with >1 blocks, >50 nt and <200 nt in length.
bHuman embryoid cells (Morin et al., 2008).
cHuman embryonic stem cells (Morin et al., 2008).
dHuman brain (34 days) (Somel et al., 2010).
eHuman brain (98 years) (Somel et al., 2010).
fHuman brain (14 years) (Somel et al., 2010).
gMonkey brain (9 years) (Somel et al., 2010).
computing a similarity score between the blocks.
In the second stage, we compare the arrangements of blocks within block groups with each other.
Using this procedure, we conduct a clustering to group similar RNAs and to identify if different RNAs share common patterns.
This also open up the possibility of discovering entirely new processing patterns.
The output will point to cases which need further manual inspection.
2.1 Data and their preprocessing In order to construct a set of benchmark data for deepBlockAlign, we downloaded previously published Illumina sequencing datasets shown in Table 1.
The human (hg18, Mar.
2006) and rhesus macaque (rheMac2, January 2006) genome assemblies, obtained from the UCSC genome browser (Hinrichs et al., 2006), served as respective
