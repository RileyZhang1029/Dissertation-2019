            Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [12:30 12/3/2012 Bioinformatics-bts078.tex] Page: 914 914920 BIOINFORMATICS ORIGINAL PAPER Vol.
28 no.
7 2012, pages 914920doi:10.1093/bioinformatics/bts078 Structural bioinformatics Advance Access publication February 10, 2012 WaVPeak: picking NMR peaks through wavelet-based smoothing and volume-based filtering Zhi Liu1, Ahmed Abbas2, Bing-Yi Jing3, and Xin Gao2, 1The Wang Yanan Institute for Studies in Economics, Xiamen University, Xiamen 361000, China, 2King Abdullah University of Science and Technology (KAUST), Mathematical and Computer Sciences and Engineering Division, Thuwal 23955-6900, Saudi Arabia and 3Department of Mathematics, Hong Kong University of Science and Technology, Kowloon, Hong Kong Associate Editor: Anna Tramontano ABSTRACT Motivation: Nuclear magnetic resonance (NMR) has been widely used as a powerful tool to determine the 3D structures of proteins in vivo.
However, the post-spectra processing stage of NMR structure determination usually involves a tremendous amount of time and expert knowledge, which includes peak picking, chemical shift assignment and structure calculation steps.
Detecting accurate peaks from the NMR spectra is a prerequisite for all following steps, and thus remains a key problem in automatic NMR structure determination.
Results: We introduce WaVPeak, a fully automatic peak detection method.
WaVPeak first smoothes the given NMR spectrum by wavelets.
The peaks are then identified as the local maxima.
The false positive peaks are filtered out efficiently by considering the volume of the peaks.
WaVPeak has two major advantages over the state-of-the-art peak-picking methods.
First, through wavelet-based smoothing, WaVPeak does not eliminate any data point in the spectra.
Therefore, WaVPeak is able to detect weak peaks that are embedded in the noise level.
NMR spectroscopists need the most help isolating these weak peaks.
Second, WaVPeak estimates the volume of the peaks to filter the false positives.
This is more reliable than intensity-based filters that are widely used in existing methods.
We evaluate the performance of WaVPeak on the benchmark set proposed by PICKY (Alipanahi et al., 2009), one of the most accurate methods in the literature.
The dataset comprises 32 2D and 3D spectra from eight different proteins.
Experimental results demonstrate that WaVPeak achieves an average of 96%, 91%, 88%, 76% and 85% recall on 15N-HSQC, HNCO, HNCA, HNCACB and CBCA(CO)NH, respectively.
When the same number of peaks are considered, WaVPeak significantly outperforms PICKY.
Availability: WaVPeak is an open source program.
The source code and two test spectra of WaVPeak are available atThe online server is under construction.
Contact: statliuzhi@xmu.edu.cn; ahmed.abbas@kaust.edu.sa; majing@ust.hk; xin.gao@kaust.edu.sa Received on November 4, 2011; revised on January 16, 2012; accepted on February 8, 2012 To whom correspondence should be addressed.
1 INTRODUCTION In the last two decades, nuclear magnetic resonance (NMR) has played a significant role in protein structure elucidation (Wthrich, 1986).
NMR is a powerful technique to determine the 3D structures of proteins at the atomic level.
Different from X-ray crystallography, the dominant structure determination technique, NMR allows the study of proteins in vivo.
It can therefore be used to study small-and medium-sized proteins that cannot be crystalized.
The 3D structures determined by NMR, on the other hand, may reveal intravital characteristics and dynamics of the proteins.
After the spectra are collected, NMR structure determination usually involves several time-consuming steps, i.e.peak picking, chemical shift assignment, nuclear Overhauser effect spectroscopy (NOESY) assignment and structure calculation (Wthrich, 1986).
These steps can take experienced NMR spectroscopists weeks or even months.
Among the four steps, peak picking is a prerequisite for all following steps, and thus required much attention from spectroscopists.
The goal of peak picking is to identify cross-signals, which contain the chemical shift information of the spin systems, from the noisy NMR spectra.
Computational approaches have been widely applied to accelerate the post-spectra processing stage of NMR structure determination (Alipanahi et al., 2009, 2011; Altieri and Byrd, 2004; Gronwald and Kalbitzer, 2003; Gntert, 2009; Herrmann et al., 2002; Jang et al., 2010, 2011; Williamson and Craven, 2009).
However, peak picking is the most sensitive and, thus far, it has been difficult to design automatic methods that can deal with this sensitivity.
There are two reasons for this difficulty.
First, the outputs of peak picking serve as the inputs for both the assignment and structure calculation steps.
Any practical peak-picking method must therefore be very accurate.
Second, there are various sources of errors in NMR spectra, including random noise, sample impurities, artifacts and water bands, which makes peak picking a very challenging problem.
The first automatic peak-picking method was proposed in 1990 (Kleywegt et al., 1990).
Symmetry was both assumed and used to identify peaks in 2D 1H NMR spectra.
Since then, a variety of methods have been explored to solve the peak-picking problem, which include peak-property-based methods (Garret et al., 1991; Johnson and Blevins, 1994), machine learning methods (Antz et al., 1995; Carrara et al., 1993; Corne et al., 1992; Rouh et al., 1994), and spectra-decomposition-based methods (Alipanahi et al., 2009; Koradi et al., 1998; Korzhneva et al., 2001; Orekhov et al., 2001).
The Author(s) 2012.
Published by Oxford University Press.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
name@bio.com Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [12:30 12/3/2012 Bioinformatics-bts078.tex] Page: 915 914920 WaVPeak Among the existing automatic methods, AUTOPSY (Koradi et al., 1998) and PICKY (Alipanahi et al., 2009) are the most accurate.
Both of these methods attempt to estimate the noise level of the given spectrum.
The noise is assumed to be white Gaussian noise and is estimated within small regions of the spectrum.
All the data points that have lower intensities than the estimated noise level are eliminated, which eliminates most parts of the spectrum.
The remaining spectrum looks like a set of disconnected components.
Instead of dealing with all the components altogether, both AUTOPSY and PICKY extract separate components.
AUTOPSY extracts components by a simple flood fill algorithm, whereas PICKY further subdivides weakly connected components into smaller ones.
After the components are formed, both methods conduct peak picking within each component.
AUTOPSY first identifies strong, obvious peaks from components.
Each of these components is then decomposed as the outer product of 1D lineshapes.
The lineshapes are then clustered and used to detect overlapping peaks from the remaining components.
Different from AUTOPSY, which uses symmetry properties of peaks, PICKY directly applies SVD on each of components.
Since the components formed by PICKY are much smaller and simpler than the ones formed by AUTOPSY, rank-one SVD seems to be powerful enough to identify peaks from the components.
However, both AUTOPSY and PICKY have a quite high false positive rate.
Therefore, a refinement step is performed in each method to reduce the number of false peaks.
In AUTOPSY, the integration, symmetrization and filtering modules are applied.
In PICKY, the peaks are first sorted according to the intensities.
A certain number of the strongest peaks (usually 1.2K, where K is the expected number of peaks) is kept.
The peaks from different NMR spectra, which share common atoms, are used to cross-eliminate false positive peaks.
Although AUTOPSY and PICKY have demonstrated impressive accuracy on different benchmark spectra, they both have two bottlenecks.
The first is that all the data points with low intensities are eliminated in both methods.
However, a number of true peaks actually have low intensities due to various reasons, including the sensitivity of the NMR spectrometer, the strength of the magnetic field, the characteristics of the target proteins and the local dynamics of the spin systems.
Unfortunately, spectroscopists need the most help to deal with these weak peaks.
An ideal peak-picking method should therefore be able to identify the weak peaks instead of disregarding them.
The second bottleneck is the way the two methods eliminate the false positive peaks.
Apparently, a brute force method that selects all the local maxima as peaks should have higher sensitivity than any other method.
The issue is that since the real spectra are very noisy, the brute force method will generate a huge number of peaks, making it almost impossible for users to identify the true ones.
On the other hand, all peak-picking methods try to smooth the spectra such that there is a good tradeoff between the sensitivity and the specificity.
For example, PICKY first eliminates all the weak data points and then smoothes the components by rank-one SVD.
The problem now is how to rank the peak candidates in an order such that the true peaks are at the top.
The existing methods use either intensitybased ranking or cross-
