Society of Systematic Biologists Phylogenetic Diversity within Seconds Author(s): Bui Quang Minh, Steffen Klaere, Arndt von Haeseler Reviewed work(s): Source: Systematic Biology, Vol.55, No.5 (Oct., 2006), pp.
769-773 Published by: Oxford University Press for the Society of Systematic Biologists Stable URL: http://www.jstor.org/stable/20142978. Accessed: 17/03/2012 14:07 Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at.
http://www.jstor.org/page/info/about/policies/terms.jsp JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide range of content in a trusted digital archive.
We use information technology and tools to increase productivity and facilitate new forms of scholarship.
For more information about JSTOR, please contact support@jstor.org. Society of Systematic Biologists and Oxford University Press are collaborating with JSTOR to digitize, preserve and extend access to Systematic Biology.
http://www.jstor.org  phylogenetic algorithm  diversity Phylogenetic  logenetic diversity Both algorithms logenies within  Syst. Biol.
55(5):769-773, 2006 Copyright (c) Society of Systematic Biologists ISSN: 1063-5157 print  1076-836X online DOI: 10.1080/10635150600981604  Phylogenetic  Diversity within  Seconds  Bui Quang Minh,  Steffen Klaere,  and Arndt  von Haeseler  Center  for Integrative Bioinformatics,  of Vienna, Dr.-Bohr-Gasse  Vienna, Max F. Perutz Laboratories, University  of Vienna, Medical University 9/6, A-1030 Vienna, Austria  E-mail: arndt.von.haeseler@univie.ac.at  of Vienna, Veterinary University  (A.v.H.) Abstract.
We tree.
For any subtree  consider subset  a  (phylogenetic)  tree with  n  labeled  leaves,  of k taxa, the  taxa  the phylogenetic subset.
We  in the  diversity introduce  is defined two  connecting of  a subset  size k with maximal  pute tively. The Goldman, rithms  greedy 2005), whereas  algorithm  compute within  seconds  phylogenetic  diversity  is an efficient  implementation  the pruning  algorithm  provides  a subtree with maximal  [Biodiversity algorithm.] conservation  Comparative  genomics  Greedy  the  taxa,  and the sum of  as  length  a the branch-lengths  for each branch  in  the  time-efficient in O(nlogfc)  of  the  so-called  an alternative  algorithms and 0[n +  (greedy (n    and pruning)  -  k) logO  (Steel,  description  greedy  strategy  of trees with  for  the same problem.
100,000  diversity  Phylogenetic  of  the minimal  to com  time,  k)] 2005  Pardi Both  respec  and  algo taxa or more.
tree  Pruning  (2005) and Pardi and Goldman  (2005)  is interested  if one tree that maximize  to provide  (1992) of a group  of the amount of diversity subset of taxa.
Faith  term phylogenetic diversity an effective taxa.
The opti embraced by a (1992) applied PD taxa, where reflect a certain value of taxonomic di  on different  priorities  shown  Recently,  the diversity  diversity.
The  coined by Faith of  Steel have that being greedy works in selecting k taxa from a phylogenetic the phylogenetic (PD) was measure mal PD describes chosen properly to place conservation the taxa to protect versity. Thus, defined tems, etc.) categories.
With lutionary divergence this purpose  (Pardi and Goldman,  on the genomic  some measurable  is assigned  on different  the advent  scales  to the corresponding  indicator of biodiversity (taxa, group of taxa, ecosys systematic evo level may also serve  of molecular  genetics,  2005). and Araujo,  is not relevant 2002,  the precise nature of the measure (cf. Humphries for a discussion should the overall value of a group of taxa either or social  Phylogenetic  diversity  regional diversity,  For  the following,  diversity  of phylogenetic et al., 1995 Williams on diversity measures). simply describe in terms of genetic diversity, diversity.
Moreover, can be mapped the branches  it is required onto a phylogenetic  tree of the tree receive non-negative  that  these measures  in a way  that  weights.
The problem  one wants  is then as follows: From a tree with n taxa, phy  to identify k taxa that retain  the maximal  into account  the fact  therefore  to restricted  logenetic diversity, that due resources age of the taxa can be sustained.
and Goldman (2005) have proven  taking  only a certain percent (2005) and Pardi Steel that a greedy approach to PD.
The greedy that adds the most set of taxa.
The pro until k taxa are found.
Both proofs indirectly the  respect the taxon chosen  theory of weighted  that an algorithm with  (Korte et al., 1991). From time com  the optimal repeatedly  set with selects to the already  yields strategy divergence cedure  is repeated or  apply directly matroids this theory plexity 0(n  and greedy algorithms  it follows log n) is possible.
In the following, we will  phylogenetic diversity algorithm ferent but easier  to implement  suggest  a time-efficient (gPDA). Moreover,  greedy a dif the pruning phy  algorithm,  algorithm  compute seconds.
(pPDA) will be  introduced.
the optimal k set for large phy  Following  Steel  that  remaining  genetic X-tree  whose three.
V denotes lection of edges or branches.
that assigns function of T a (non-negative)  Notation (2005), we is, a tree with interior nodes  call T an unrooted  phylo  leaf set X of taxa and are of degree least the set of all nodes of T and   the col  at   denotes to each edge e = branch  length X(v, w)   0.  the edge-weight (v, w),  (v, w e V)  A path V(a,b)  a =  vq,v\, ...,  = i.e., connected of all edges along  the collection  denotes of distinct nodes v , u +i are ad b by an edge.
The sum of the edge two nodes  the path between  in a tree  vm+\  such  that  jacent  weights a and b denotes  To describe T at a node dents is well defined away distance  their distance the algorithms,  d(a, b) in the tree.
it will be handy  to root  leaves are descen  r. Then  from r. Thus,  the remaining for each node  v eV  and denotes  the descendant(s)  from v. For  the sake of clarity, we abbreviate  d[v, Lmax(v)] as dmax(v). the set Lmax(v) farthest the  that connects  For a subset W of X we  phylogenetic W-tree, ing to T. Finally,  w assigns the sum of the X(e) values over the to the new edge e. The phylogenetic path diversity of W, denoted PD(W),  that corresponds  is then  consider T\ W, all taxa to each edge those edges  the induced in W accord e of T\ W in T along  PD(W) =  Y,^w(e),  e  the summation  where (see Steel, 2005). is over all edges  e in the tree T\ W  The Time-Efficient We briefly describe tree T  phylogenetic and  the size of k define  the  Greedy Algorithm: the implementation together with  of gPDA. The  its weight-function  gPDA  input of the algorithm.
We  769  770_SYSTEMATIC BIOLOGY_VOL. 55  diversity.
the collection W of k taxa with maxi In the following, we describe of degree for trees with  interior nodes  for the implementation  trees with  works  interior node degree  of at least  three.
gPDA  splits  to determine  want mal phylogenetic the algorithm three.
However, finite in two steps.
initial  of  The  the computation  can be achieved search  longest path by applying 2001). The algorithm termines to show in T. We  step starts with in T. This a depth-first  the time et al., leaf c and de It is easy of the longest path the tree at a and based on this root com vi the distance dmax(vi) and the  the leaf a furthest away that a is one of the endpoints root  in 0(n) (DFS) (cf. Cormen  starts at an arbitrary  for all interior nodes  from c in T.  set Lmax(v ). This  is again a DFS procedure  pute associated i.e., has complexity this procedure in the tree has distance  0(n). Figure 1A displays five taxa.
The  for a tree with  20.
Thus,  the set W  the result of  longest path to  is equal leaf c in V   To extend W, we note  exactly one node v (i = 1,..., m)  that for each  W, in V(a, b) acts as anees  max(V3)=W  maX(v3)=max 8,:  ^max(V1)= ^  ^max(v1)=max 8+6,2+3  (V2)= C  (v2)=max l,2   max(V3)= rf  rfmax(V3)=2  Lmax(vt)= c  rfmax(v1)=3+rfmax(V2)  09=2  c  max^W  max(V3)=2  max(v1)=0  max(v1)= 0  (V2)=M  rfmax(V2)=l  Figure  tance between taxa with of after selecting longest path on the nodes  1.
Example u,- and  distance  for the gPDA. its descending dmax(v )  dmax(vi) denotes taxa, and Lmax(vj) denotes the greedy  the  of  longest dis the set  strategy  to u,-. (A) Result lines). (bold (C) Adding  (B) Updating leaf c to W and updating  nodes  on  the  the  longest path step.
initial  tree.
in the the partial  its ancestor  tor  i.e., Vi is the node where one selects split.
Obviously, in V(a, b).To from ordered k  2 nodes v\, vi,..., are ordered S the nodes to  max  i.e., the following  respect v^-i  list S with  c) and V(a, b) the paths V(a, the leaf that is farthest away an  this end, we generate  to dmax that contains from  the path  at most  set V(a, b). In  order according  in descending holds:  dmaxiViJ    dmax(v 2)      dmax(vik_2). update  distance  generating  that V(v\,  to v such  S, we must  for each Before V(a, b) the set Lmax(i ) and dmax(v ) by choosing c with maximal have an edge node Vi this update contains more elements, S deleted sition case.
v  on a leaf c) does not the path V(a, b). For each in constant time.
If V(a, b) and S has already k  2 to  in common with can be done than k  2 nodes  if dmax(v)   dmax(vik_2). The node  only added vik_2 is subsequently  then a new node v from V(a,b)is  from S and v is inserted  at its appropriate  po in the worst  takes O(nlogfc)  in S. This  time  step  IB displays  the result of  this update  Figure (v\, v^), because five-taxon dmax(vi) = 5   2 = dmax(v3). This update procedure will be  tree.
Here, we  obtain S =  invoked  in the following  repeatedly  for the  step of gPDA. can enter  the  defined W and a sorted  list S we  Having  core of the algorithm, We add a leaf c from Lmax ^) the maximal  the greedy step.
to Wand  distances  delete uZl from leaves for the  and  the path V(v x, c) as described  ,b). No updates in S. Figure 1C illustrates  are necessary  tree with W =  a,b,c  for interior nodes  this second update  for  v^. v\ and  and S =  on  S. Then we update for all nodes path V(a already the example V2 are updated,  whereas  v$ remains  unchanged.
the elements w of the path V(v x, c) are  list S according  to their distance  dmax(vik_2). In the sample  v^, V2. This completes until W  is repeated  tree v2 is  the greedy contains  k  Subsequently,  into the ordered if dmax(w)   thus S =  inserted dmax(w) added step.
The greedy taxa.
step  and  To determine  eventually  puting initial to generate cause W will is never S in S are an interior node is implemented (e.g., Cormen is inserted steps.
Because terior nodes, generating time.
Therefore, of gPDA is 0(n log k). in S at most  contain k taxa, the cardinality  the complexity  of gPDA,  identifying time.
The  the longest path and step consumes 0(n) and update S larger than k  2.
At any time, the most  is more  promising  recall that com  subtle  for T\ W. An  taxa a and b in the time requirement to establish.
Be of the k  2 nodes of k) time, because S structure tree data interior node the k  2 greedy tree with n taxa has n  2 in log k)  S takes 0(n  insertion  time complexity  into S requires 0(log as a red-black search  et al., 2001, chap.
13). Each  once during  a bifurcating  and updating the overall worst-case  An Efficient  Pruning  Easier  to  implement  versity  algorithm  (pPDA),  Algorithm: is the pruning  a special  pPDA  phylogenetic of  application  di the  2006_MINH  ET AL. PHYLOGENETIC DIVERSITY_771  greedy the  algorithm full  start with  so-called worst-out Here, we the x e X, we in ascending algorithm.
compute  length X(v, x) of an exterior  a sorted  order.
This completes n  k iterations  tree of n taxa.
Based  (Korte et al., 1991). on to a leaf list S of the taxa, arranged initial step of the  leading  edge  the  from S. The degree (v, si) is decreased  (pruning steps), the first of the by one.
two, then the incident edges is if  length of the new edge lengths of the joined edges.
Moreover, is connected  edge  the branch  to a leaf,  In the following taxon S\ in the list is deleted node v that forms the branch If the new degree of v equals of v are joined and the sum of the the new of the leaf is updated.
appropriate position After n  k pruning stitute It is straightforward with maximal lows of PD can be carried out on a piece of paper.
We section with of its complexity.
the set W with maximal to prove  (Steel, 2005). This algorithm  Subsequently, in S.  the discussion  phylogenetic  immediately  diversity.
from  the  strong exchange  steps, S contains k taxa that con diversity.
phylogenetic  that pPDA provides Its optimality  trees fol  property that  is so simple  conclude  it the  the branch length the leaf is put at its  is always  At each pruning in S. We  step at most also note  one that further down  the sorted  taxon must be repo the new position of list, be increases.
to store initial in 0(n)  taxon  sitioned the cause Thus in the worst step, time sort cause S Cormen  the length of an incident branch always to complete  n  k pruning  steps, S needs    case 2(n of et al., 2001). Then we only have  k) taxa.
Therefore, those  taxa can be done  in the      to  the selection (e.g., Cormen the selected  in 0[(n  fc)log(n  as a red-black  taxa is implemented et al., 2001). Finally, repositioning   at most step needs  [log(n the n  k pruning steps amounts of   in an overall k)]. This results - (n- k) log(n  k)] time, be tree (e.g., in the k)] steps.
Thus, to  pruning the complexity k) log(n 0[(n ity of pPDA o O[n +  a taxon  complex  search  k)]. Run Time Analysis  A  G  o 0  S   O  20  40  60  Percentage of preserved  100  80 taxa  0  20  40  60  Percentage  of preserved  100  80 taxa  FIGURE 2.
Comparison  of computing  the average taxa  run time (B), respectively.
times of gPDA from 100 runs sizes  Subset  and pPDA. for n =100,000 ranging  from  Each point represents (A) and n = 1,000,000 k = 5%-n,...,95%-n.  simulations  to test the wall computer time of gPDA and pPDA. Simulations on a 2-GHz AMD Opteron  trees with more  We conducted clock computing were performed GByte RAM.
Both algorithms were than 100,000 huge tial difference we will 1,000,000 onds) random  in the performance compare  in Figure 2 are based  the results  trees generated  under  only taxa, respectively.
The computing  for each combination  1971) lengths are randomly  drawn  (0,1). The size k of W was varied  (Harding, The branch val the n taxa in the tree.
2 for  246 with so fast that only taxa was observed.
for n = 100,000  a substan Therefore,  times  and (in sec from 100  on average  times  the Yule-Harding model  of the pair  (n, k). from the inter from 5% to 95% of  For needed maximal more  the n = 105 taxa tree all runs of both algorithms a subtree with less than one second PD.
In our simulations, consumed  to compute  gPDA never  than 8 s to achieve  the subset of maximal  logenetic  diversity  in the 1,000,000-taxa  phy trees, whereas  for the 1,000,000-taxa  tree with  pPDA  to 17 s. It should be noted  that an  run  longest  the amounts tation of the na ve version derived n = 105 taxa (data not shown). is faster  than pPDA  pPDA outperforms  gPDA. from Steel, 2005) needs more  of the greedy  implemen  algorithm than 30 min  (as for  if k   70% of  In our simulations,  gPDA the taxa  otherwise,  Typical applications  less  took  But recently, Lewis of small thousands to 10,000 (Ronquist  gorithms MrBayes rithms trees for all generated serve as subroutines this example oik = 40% at which the superiority Thus, crucially depends  resulted  than 1.5 s to extract optimal PD  do not deal with millions and Lewis (2006) calculated trees of 150 taxa.
We applied trees generated and Huelsenbeck,  of taxa.
PD for our al from their data using 2003). Both algo sub gPDA and pPDA may In addition, point gPDA. the other  trees.
Hence in such applications.
in a different discriminative starts outperforming over  of one algorithm  pPDA  on the tree shape.
772_SYSTEMATIC BIOLOGY_VOL. 55  Discussion  two versions  phylogenetic  to compute  serve as convenient  the greedy an efficient  We have presented  a subtree of given  ap im size k with diversity.
Thus, gPDA and pPDA for to the trick or taxa.
of proach, gPDA and pPDA. They provide plementation maximal may different that S does not contain Therefore mance that the tree shape time and  sizes of k. The gain all  both algorithms than 0(nlogn). interior nodes a worst-case  in speed the  perfor indicated  to compute  exhibit Our  the wall-clock  simulations  computing  influences  subtrees  is due  tools  less  of the algorithms  differently.
A  the efficiency  comprehensive time is beyond  Steel  (2005) proposed  its estimated into  to accommodate sures of diversity, depicting integrated nal branches with (Pardi and Goldman, Pardi and Goldman to start with the extension  namely permits set starting with may be handy some already to be sequenced species both algorithms.
study of all factors affecting the scope of this study.
an extension  of  computing  the PD  score  the need in which  to incorporate each  different mea taxon receives a weight can be easily termi  This  increasing  the by of the corresponding  taxa  importance.
the algorithm the weight 2005). also suggested a user-defined  of W a non-optimal in comparative species  sequenced  next.
We  another approach, set W. This initial to a maximally  divergent seed W. This application genomics where  one has  and must decide which included  this option  in  PD  Although  the determination is computationally to explore  maximal tainly worthwhile sets W[, Wir. ber of such sets can theoretically In view of this combinatorial how tant. For sure  the algorithms,  phylogenetic  to measure  is irrelevant  with  the  of one subset W of X with be cer efficient, of different The  the possibility  it would  num increase dramatically.
PD.
same maximal  the question  of  explosion, diversity  impor the precise nature of this mea  becomes  as long as it can be mapped  on the tree  relating ent measures tive branch  the taxa under  consideration.
of diversity may lengths and  therefore  Combining  lead to more discrimina  differ  reduce  the hazard  of  confining  the measure the taxa may be helpful  to genetic dis (Pardi and Gold  sets.
multiple  optimal In this context,  2005). However,  tances between man, Presently, for conflicting rithms taxa.
It is well known  different  problems  then arise.
the algo the same set of  to violations  it is not at all clear how  trees derived that different  of the molecular  different phylogenetic  to adjust from regions of the genome di clock or due (Graur and Li, regions (Nei, the  1,4  the pair taxa as the sum of the pairwise then  3,4  displays diversity.
We also obtain W3,  from different to ancestral polymorphisms in Figure compute W[ = If we  3 illustrates  I, 3 , 1A = compute  the set W$. =  rates of molecular  trees with drastically due  provide versities to varying 2000). Sometimes may be different 1987). The artificial problem.
For k = 2, we for trees 7  and T2, respectively.
wise distances trees, the largest phylogenetic  trees derived  evolution  example  distance  between  in both  due  if  A El  T  EL  r  sr  Figure  observed  3.
For that lead  (A). In contrast, distances tree of lines visualize  fit  tively of pairwise squares, Bold sets.
^  in  taxa 1, 2, 3, and 4, two different  gene  trees are  the to two different the resulting between  sets  PD2 split graph  1,3  and generated  1,4), by  taxa  in % and T2  respec the sum least  3,4.
PD2  (B) and the the PD2 set the respective  the  two gene  the  subgraphs  trees  (C) have  formed  by  the tree is selected to the distance  sum  that provides  the best  (cf. Felsenstein,  if we  trees  optimal  its derived  and combine  them naively,  is the fact that W$ construct  point T2. Thus, regions tree and versity may not be the representative to address lying diversity.
One way assign different weights the weighted maximize for different rithms may be required PD.
trees.
However, more  is neither maximal  from different  subtree with maximal  least square  fit 2004). The crucial in  in T\ nor  then  genomic the resulting di of the true under this would  be  to then  to the different average  of the PDs  trees and  calculated  sophisticated to cope adequately with  algo genetic  2006_MINH  ET AL. PHYLOGENETIC DIVERSITY_773  Acknowledgements  like to thank Dan Faith Schmidt  and Tanja Gesell  Steel and anonymous  The authors would the subject and Heiko thank Mike also They comments.
A from http:   www.cibiv.at/software/pda/. Wiener Wissenschafts-, Forschungs,  computer  program written  for helpful  suggestions  referees  for fruitful discussions.
for constructive available from (WWTF)  is freely support  in C++ Financial  and Technologiefonds  the is  on  greatly  appreciated.
REFERENCES  Cormen,  T. H., C. E. Leiserson,  R. L. Rivest,  to algorithms, troduction Cambridge, Massachusetts. Faith, D. P. 1992.
Conservation  Biol.
Conserv. 61:1-10. 2 edition.
MIT Press  and C. Stein.
2001. and McGraw-Hill,  Ronquist,  logenetic 1574.
In  evaluation  and phylogenetic  diversity.
Williams,  Felsenstein,  J.2004.
Inferring  phylogenies. Sinauer  Associates,  Sunderland, Massachusetts. Graur, D., and W.-H.  Li. 2000.
Fundamentals  of molecular  evolution.
2nd edition.
Sinauer Associates,  Harding,  E. F. 1971.
The probabilities Adv.
Appl. bifurcation.
by random  Sunderland, Massachusetts. tree shapes  of rooted Prob.
3:44-77. Humphries,  C. J., P. H. Williams,  and R. I. Vane-Wright.
1995.
Measuring  biodiversity  value Korte, B., L. Lov sz,  for conservation.
and R. Schrader. Annu. Rev.
Ecol.
Syst. 26:93-111. and 1991.
Greedoids. Algorithms  combinatorics. Springer Verlag, Berlin. Lewis, L. A., and P. O. Lewis. 2006.
Unearthing  of desert  soil green  algae.
Syst. Biol.
54:936-947.  the molecular  diversity  evolutionary  genetics.
Columbia  University  Nei, M.  1987.
Molecular  Press, New York. Pardi, E, and N. Goldman. 2005.
Species  choice  for comparative  ge  nomics: Being  greedy works.
F., and J. P. Huelsenbeck. PLoS Genet. I:e71. 2003.
MrBayes  inference  under mixed models.
Bioinformatics  3: Bayesian  phy 19:1572  Steel, M. 2005.
Phylogenetic  Biol.
54:527-529.  diversity  and  the greedy  algorithm.
Syst. P. H., and M. B. Araujo. 2002.
Apples,  ties: Integrating multiple consistency.
Environ. Model.
Assess.
factors  into biodiversity 7:139-151.  oranges  and probabili with  conservation  First  submitted  7 March  2006  reviews  returned 21 April 2006  generated  final acceptance  Associate Editor: Mike  15 June 2006 Steel
